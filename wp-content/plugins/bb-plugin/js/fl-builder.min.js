var FLBuilderColorPicker;!function(e,i){function t(){var i,t,l="backgroundImage";f?h="filter":(i=e('<div id="iris-gradtest" />'),t="linear-gradient(top,#fff,#000)",e.each(g,function(e,n){if(i.css(l,n+t),i.css(l).match("gradient"))return h=e,!1}),h===!1&&(i.css("background","-webkit-gradient(linear,0% 0%,0% 100%,from(#fff),to(#000))"),i.css(this.bgImageString).match("gradient")&&(h="webkit")),i.remove())}function l(i,t){return i="top"===i?"top":"left",t=e.isArray(t)?t:Array.prototype.slice.call(arguments,1),"webkit"===h?s(i,t):g[h]+"linear-gradient("+i+", "+t.join(", ")+")"}function n(i,t){var l,n,s,r,a,d,u,c,f;i="top"===i?"top":"left",t=e.isArray(t)?t:Array.prototype.slice.call(arguments,1),l="top"===i?0:1,n=e(this),s=t.length-1,r="filter",a=1===l?"left":"top",d=1===l?"right":"bottom",u=1===l?"height":"width",c='<div class="iris-ie-gradient-shim" style="position:absolute;'+u+":100%;"+a+":%start%;"+d+":%end%;"+r+':%filter%;" data-color:"%color%"></div>',f="","static"===n.css("position")&&n.css({position:"relative"}),t=o(t),e.each(t,function(e,i){var n,o,r;return e!==s&&(n=t[e+1],void(i.stop!==n.stop&&(o=100-parseFloat(n.stop)+"%",i.octoHex=new FLBuilderColor(i.color).toIEOctoHex(),n.octoHex=new FLBuilderColor(n.color).toIEOctoHex(),r="progid:DXImageTransform.Microsoft.Gradient(GradientType="+l+", StartColorStr='"+i.octoHex+"', EndColorStr='"+n.octoHex+"')",f+=c.replace("%start%",i.stop).replace("%end%",o).replace("%filter%",r))))}),n.find(".iris-ie-gradient-shim").remove(),e(f).prependTo(n)}function s(i,t){var l=[];return i="top"===i?"0% 0%,0% 100%,":"0% 100%,100% 100%,",t=o(t),e.each(t,function(e,i){l.push("color-stop("+parseFloat(i.stop)/100+", "+i.color+")")}),"-webkit-gradient(linear,"+i+l.join(",")+")"}function o(i){var t=[],l=[],n=[],s=i.length-1;return e.each(i,function(e,i){var n=i,s=!1,o=i.match(/1?[0-9]{1,2}%$/);o&&(n=i.replace(/\s?1?[0-9]{1,2}%$/,""),s=o.shift()),t.push(n),l.push(s)}),l[0]===!1&&(l[0]="0%"),l[s]===!1&&(l[s]="100%"),l=r(l),e.each(l,function(e){n[e]={color:t[e],stop:l[e]}}),n}function r(i){var t,l,n,s,o=0,a=i.length-1,d=0,u=!1;if(i.length<=2||e.inArray(!1,i)<0)return i;for(;d<i.length-1;)u||i[d]!==!1?u&&i[d]!==!1&&(a=d,d=i.length):(o=d-1,u=!0),d++;for(l=a-o,s=parseInt(i[o].replace("%"),10),t=(parseFloat(i[a].replace("%"))-s)/l,d=o+1,n=1;d<a;)i[d]=s+n*t+"%",n++,d++;return r(i)}var a=[],d=navigator.userAgent.toLowerCase(),u="Microsoft Internet Explorer"===navigator.appName,c=u?parseFloat(d.match(/msie ([0-9]{1,}[\.0-9]{0,})/)[1]):0,f=u&&c<10,h=!1,g=["-moz-","-webkit-","-o-","-ms-"];flBuilderParseColorValue=function(e){var i=e.replace(/\s+/g,""),t=i.indexOf("rgba")!==-1?parseFloat(100*i.replace(/^.*,(.+)\)/,"$1")):100,l=t<100;return{value:i,alpha:t,rgba:l}},e.fn.flBuilderColorPickerGradient=function(){var i=arguments;return this.each(function(){f?n.apply(this,i):e(this).css("backgroundImage",l.apply(this,i))})},e.fn.flBuilderColorPickerRaninbowGradient=function(i,t){var l,n,s,o;for(i=i||"top",l=e.extend({},{s:100,l:50},t),n="hsl(%h%,"+l.s+"%,"+l.l+"%)",s=0,o=[];s<=360;)o.push(n.replace("%h%",s)),s+=30;return this.each(function(){e(this).flBuilderColorPickerGradient(i,o)})},FLBuilderColorPicker=function(i){this._html='<div class="fl-color-picker-ui"><div class="iris-picker"><div class="iris-picker-inner"><div class="iris-square"><a class="iris-square-value" href="javascript:void(0);"><span class="iris-square-handle ui-slider-handle"></span></a><div class="iris-square-inner iris-square-horiz"></div><div class="iris-square-inner iris-square-vert"></div></div><div class="iris-slider iris-strip"><div class="iris-slider-offset"></div></div></div></div></div>';var t={elements:null,color:"",mode:"hsl",controls:{horiz:"s",vert:"l",strip:"h"},target:!1,width:200,presets:[],labels:{colorPresets:"Color Presets",colorPicker:"Color Picker",placeholder:"Paste color here...",removePresetConfirm:"Are you sure?",noneColorSelected:"None color selected.",alreadySaved:"%s is already a saved preset.",noPresets:"Add a color preset first.",presetAdded:"%s added to presets!"}};this.options=e.extend({},t,i),(f===!1||f===!0&&c>7)&&this._init()},FLBuilderColorPicker.prototype={_html:"",_color:"",_currentElement:"",_inited:!1,_defaultHSLControls:{horiz:"s",vert:"l",strip:"h"},_defaultHSVControls:{horiz:"h",vert:"v",strip:"s"},_scale:{h:360,s:100,l:100,v:100},_init:function(){var i=this;e(i.options.elements);return e("html").hasClass("fl-color-picker-init")?void this._prepareColorFields():(this._color=new FLBuilderColor("#ff0000").setHSpace(i.options.mode),a=this.options.presets,h===!1&&t(),i.picker=e(this._html).appendTo("body"),u?9===c?i.picker.addClass("iris-ie-9"):c<=8&&i.picker.addClass("iris-ie-lt9"):d.indexOf("compatible")<0&&d.indexOf("khtml")<0&&d.match(/mozilla/)&&i.picker.addClass("iris-mozilla"),i.controls={square:i.picker.find(".iris-square"),squareDrag:i.picker.find(".iris-square-value"),horiz:i.picker.find(".iris-square-horiz"),vert:i.picker.find(".iris-square-vert"),strip:i.picker.find(".iris-strip"),stripSlider:i.picker.find(".iris-strip .iris-slider-offset")},"hsv"===i.options.mode&&i._has("l",i.options.controls)?i.options.controls=i._defaultHSVControls:"hsl"===i.options.mode&&i._has("v",i.options.controls)&&(i.options.controls=i._defaultHSLControls),i.hue=i._color.h(),this._setTemplates(),this._ui=e(".fl-color-picker-ui"),this._iris=e(".iris-picker"),this._wrapper=e("body"),this._ui.prepend(this._hexHtml).append(this._presetsHtml),i.element=this._ui.find(".fl-color-picker-input"),i._initControls(),i.active="external",i._change(),i._addInputListeners(i.element),this._buildUI(),this._prepareColorFields(),this._pickerControls(),this._presetsControls(),this._buildAlphaUI(),void e("html").addClass("fl-color-picker-init"))},_prepareColorFields:function(){var i=this;e(".fl-color-picker-value").each(function(){var t=e(this),l=t.val(),n=t.parent().find(".fl-color-picker-color"),s=flBuilderParseColorValue(l),o="";if(l){if(n.hasClass("fl-color-picker-alpha-enabled")&&s.rgba)o=t.val().toString();else if(!n.hasClass("fl-color-picker-alpha-enabled")&&s.rgba){var r=l.replace("rgba","rgb");r=r.substr(0,r.lastIndexOf(","))+")",i._color._alpha=1,o=r,t.val(r)}else o="#"+t.val().toString();n.css({backgroundColor:o})}})},_setTemplates:function(){this._alphaHtml='<div class="fl-alpha-wrap"><div class="fl-alpha-slider"></div><div class="fl-alpha-slider-offset"></div><div class="fl-alpha-text"></div></div>',this._presetsHtml='<div class="fl-color-picker-presets"><div class="fl-color-picker-presets-toggle"><div class="fl-color-picker-presets-open-label fl-color-picker-active">'+this.options.labels.colorPresets+' <span class="fl-color-picker-icon-arrow-up"></span></div><div class="fl-color-picker-presets-close-label">'+this.options.labels.colorPicker+' <span class="fl-color-picker-icon-arrow-down"></span></div></div><ul class="fl-color-picker-presets-list"></ul></div>',this._hexHtml='<input type="text" class="fl-color-picker-input" placeholder="'+this.options.labels.placeholder+'"><div class="fl-color-picker-preset-add"></div>',this._presetsTpl='<li class="fl-color-picker-preset"><span class="fl-color-picker-preset-color"></span> <span class="fl-color-picker-preset-label"></span> <span class="fl-color-picker-preset-remove fl-color-picker-icon-remove"></span></li>',this._noPresetsTpl='<li class="fl-color-picker-no-preset"><span class="fl-color-picker-preset-label">'+this.options.labels.noPresets+"</span></li>"},_has:function(i,t){var l=!1;return e.each(t,function(e,t){if(i===t)return l=!0,!1}),l},_buildUI:function(){var i=this;i._presetsList=this._ui.find(".fl-color-picker-presets-list"),i._presetsList.html(""),this.options.presets.length>0?e.each(this.options.presets,function(e,t){i._addPresetView(t)}):i._presetsList.append(this._noPresetsTpl)},_addPresetView:function(i){var t=this._presetsList.find(".fl-color-picker-no-preset");t.length>0&&t.remove();var l=e(this._presetsTpl),n=FLBuilderColor(i);l.attr("data-color",i).find(".fl-color-picker-preset-color").css({backgroundColor:n.toString()}).end().find(".fl-color-picker-preset-label").html(n.toString()),this._presetsList.append(l)},_addPresetFeedback:function(){this._ui.append('<div class="fl-color-picker-added"><div class="fl-color-picker-added-text"><div class="fl-color-picker-icon-check"></div> "'+this.options.labels.presetAdded.replace("%s",this._color.toString())+'"</div></div>'),this._ui.find(".fl-color-picker-added").hide().fadeIn(200).delay(2e3).fadeOut(200,function(){e(this).remove()})},_pickerControls:function(){var i=this;this._wrapper.on("click",".fl-color-picker-color",function(){var t=e(this);i._currentElement=t.parent().find(".fl-color-picker-value"),i._ui.position({my:"left top",at:"left bottom",of:t,collision:"flip",using:function(e,t){i._togglePicker(e)}})}).on("click",".fl-color-picker-clear",function(){var t=e(this);i._currentElement=t.parent().find(".fl-color-picker-value"),t.prev(".fl-color-picker-color").css({backgroundColor:"transparent"}).addClass("fl-color-picker-empty"),i._setColor(""),i.element.val(""),i._currentElement.val("").trigger("change")}),e(document).on("mousedown",function(i){0===e(i.target).closest(".fl-color-picker-ui").length&&e(".fl-color-picker-ui.fl-color-picker-active").removeClass("fl-color-picker-active")})},_presetsControls:function(){var i=this,t=i._ui.find(".fl-color-picker-preset-add"),l=i._ui.find(".fl-color-picker-presets"),n=l.find(".fl-color-picker-presets-open-label"),s=l.find(".fl-color-picker-presets-close-label"),o=l.find(".fl-color-picker-presets-list");t.off("click").on("click",function(){i._addPreset(i.element.val())}),o.css({height:i.element.innerHeight()+i._iris.innerHeight()+14+"px"}).hide(),l.off("click").on("click",".fl-color-picker-presets-toggle",function(){n.toggleClass("fl-color-picker-active"),s.toggleClass("fl-color-picker-active"),o.slideToggle(500)}).on("click",".fl-color-picker-preset",function(t){var l=new FLBuilderColor(e(this).data("color").toString());i._setColor(l),i._currentElement.parent().find(".fl-color-picker-color").css({backgroundColor:l.toString()}).removeClass("fl-color-picker-empty"),n.toggleClass("fl-color-picker-active"),s.toggleClass("fl-color-picker-active"),o.slideToggle(500)}).on("click",".fl-color-picker-preset-remove",function(t){t.stopPropagation(),i._removePreset(e(this).parent().data("color"))})},_removePreset:function(i){if(confirm(this.options.labels.removePresetConfirm)){var t=i.toString(),l=a.indexOf(t);l>-1&&(a.splice(l,1),this.options.presets=a,this._presetsList.find('.fl-color-picker-preset[data-color="'+t+'"]').slideUp(function(){e(this).remove()})),a.length<1&&this._presetsList.append(this._noPresetsTpl),e(this).trigger("presetRemoved",{presets:a})}},_addPreset:function(i){if(!this._CheckValidColor(i))return alert(this.options.labels.noneColorSelected),!1;var t=i.toString().replace(/^#/,"");""===t?alert(this.options.labels.noneColorSelected):a.indexOf(t)>-1?alert(this.options.labels.alreadySaved.replace("%s","#"+t)):(this._addPresetView(t),this._addPresetFeedback(),a.push(t),this.options.presets=a,e(this).trigger("presetAdded",{presets:a}))},_CheckValidColor:function(e){if(!e.match(/^#/)&&!e.match(/^rgb/)&&!e.match(/^hsl/))return!1;var i=document.getElementById("divValidColor");i||(i=document.createElement("div"),i.id="divValidColor"),i.style.borderColor="",i.style.borderColor=e;var t=i.style.borderColor;return 0!=t.length},_togglePicker:function(e){var i=this;this._ui.hasClass("fl-color-picker-active")?(this._ui.removeClass("fl-color-picker-active"),e&&setTimeout(function(){i._ui.css(e),i._ui.addClass("fl-color-picker-active"),i._setColor(i._currentElement.val())},200)):(e&&i._ui.css(e),setTimeout(function(){i._ui.addClass("fl-color-picker-active"),i._setColor(i._currentElement.val())},200))},_paint:function(){var e=this;e._paintDimension("right","strip"),e._paintDimension("top","vert"),e._paintDimension("left","horiz")},_paintDimension:function(e,i){var t,l=this,n=l._color,s=l.options.mode,o=l._getHSpaceColor(),r=l.controls[i],a=l.options.controls;if(i!==l.active&&("square"!==l.active||"strip"===i))switch(a[i]){case"h":if("hsv"===s){switch(o=n.clone(),i){case"horiz":o[a.vert](100);break;case"vert":o[a.horiz](100);break;case"strip":o.setHSpace("hsl")}t=o.toHsl()}else t="strip"===i?{s:o.s,l:o.l}:{s:100,l:o.l};r.flBuilderColorPickerRaninbowGradient(e,t);break;case"s":"hsv"===s?"vert"===i?t=[n.clone().a(0).s(0).toCSS("rgba"),n.clone().a(1).s(0).toCSS("rgba")]:"strip"===i?t=[n.clone().s(100).toCSS("hsl"),n.clone().s(0).toCSS("hsl")]:"horiz"===i&&(t=["#fff","hsl("+o.h+",100%,50%)"]):t="vert"===i&&"h"===l.options.controls.horiz?["hsla(0, 0%, "+o.l+"%, 0)","hsla(0, 0%, "+o.l+"%, 1)"]:["hsl("+o.h+",0%,50%)","hsl("+o.h+",100%,50%)"],r.flBuilderColorPickerGradient(e,t);break;case"l":t="strip"===i?["hsl("+o.h+",100%,100%)","hsl("+o.h+", "+o.s+"%,50%)","hsl("+o.h+",100%,0%)"]:["#fff","rgba(255,255,255,0) 50%","rgba(0,0,0,0) 50%","rgba(0,0,0,1)"],r.flBuilderColorPickerGradient(e,t);break;case"v":t="strip"===i?[n.clone().v(100).toCSS(),n.clone().v(0).toCSS()]:["rgba(0,0,0,0)","#000"],r.flBuilderColorPickerGradient(e,t)}},_getHSpaceColor:function(){return"hsv"===this.options.mode?this._color.toHsv():this._color.toHsl()},_dimensions:function(e){var i,t=this,l=t.options,n=t.controls,s=n.square,o=t.picker.find(".iris-strip"),r="77.5%",a="12%",d=20,u=l.border?l.width-d:l.width;if(e&&(s.css("width",""),o.css("width",""),t.picker.css({width:"",height:""})),r=u*(parseFloat(r)/100),a=u*(parseFloat(a)/100),i=l.border?r+d:r,s.width(r).height(r),o.height(r).width(a),t.picker.css({width:l.width,height:i}),!l.palettes)return t.picker.css("paddingBottom","")},_addInputListeners:function(e){var i=this,t=100,l=function(t){var l=new FLBuilderColor(e.val()),n=e.val().replace(/^#/,""),s=i._currentElement.hasClass("fl-color-picker-empty");if(e.removeClass("iris-error"),l.error)""!==n&&e.addClass("iris-error");else if(l.toString()!==i._color.toString()||""!==i._color.toString()&&s)if("keyup"===t.type){if(n.match(/^[0-9a-fA-F]{3}$/))return;i._setColor(n),i._currentElement.parent().find(".fl-color-picker-color").css({backgroundColor:FLBuilderColor(n).toString()}).removeClass("fl-color-picker-empty"),i._currentElement.val(n).trigger("change")}else if("paste"===t.type)return n=t.originalEvent.clipboardData.getData("text").replace(/^#/,""),hex=FLBuilderColor(n).toString(),i._setColor(n),e.val(hex),i._currentElement.parent().find(".fl-color-picker-color").css({backgroundColor:hex}).removeClass("fl-color-picker-empty"),i._currentElement.val(n).trigger("change"),!1};e.on("change",l).on("keyup",i._debounce(l,t))},_initControls:function(){var i=this,t=i.controls,l=t.square,n=i.options.controls,s=i._scale[n.strip];t.stripSlider.slider({orientation:"horizontal",max:s,slide:function(e,t){i.active="strip","h"===n.strip&&(t.value=s-t.value),i._color[n.strip](t.value),i._change.apply(i,arguments)}}),t.squareDrag.draggable({containment:t.square.find(".iris-square-inner"),zIndex:1e3,cursor:"move",drag:function(e,t){i._squareDrag(e,t)},start:function(){l.addClass("iris-dragging"),e(this).addClass("ui-state-focus")},stop:function(){l.removeClass("iris-dragging"),e(this).removeClass("ui-state-focus")}}).on("mousedown mouseup",function(t){var l="ui-state-focus";t.preventDefault(),"mousedown"===t.type?(i.picker.find("."+l).removeClass(l).blur(),e(this).addClass(l).focus()):e(this).removeClass(l)}).on("keydown",function(e){var l=t.square,n=t.squareDrag,s=n.position(),o=2;switch(e.altKey&&(o*=10),e.keyCode){case 37:s.left-=o;break;case 38:s.top-=o;break;case 39:s.left+=o;break;case 40:s.top+=o;break;default:return!0}s.left=Math.max(0,Math.min(s.left,l.width())),s.top=Math.max(0,Math.min(s.top,l.height())),n.css(s),i._squareDrag(e,{position:s}),e.preventDefault()}),l.mousedown(function(t){var l,n;1===t.which&&e(t.target).is("div")&&(l=i.controls.square.offset(),n={top:t.pageY-l.top,left:t.pageX-l.left},t.preventDefault(),i._squareDrag(t,{position:n}),t.target=i.controls.squareDrag.get(0),i.controls.squareDrag.css(n).trigger(t))})},_squareDrag:function(e,i){var t=this,l=t.options.controls,n=t._squareDimensions(),s=Math.round((n.h-i.position.top)/n.h*t._scale[l.vert]),o=t._scale[l.horiz]-Math.round((n.w-i.position.left)/n.w*t._scale[l.horiz]);t._color[l.horiz](o)[l.vert](s),t.active="square",t._change.apply(t,arguments)},_setColor:function(e){var i,t,l=this,n=l.options.color,s="#ff0000";""===e?(e=s,l["default"]=!0):l["default"]=!1,l.options.color=e,e=""+e,i=e.replace(/^#/,""),t=new FLBuilderColor(e).setHSpace(l.options.mode),t.error?l.options.color=n:(l._color=t,l.options.color=l._color.toString(),l.active="external",l._change())},_squareDimensions:function(e){var t,l,n=this.controls.square;return e!==i&&n.data("dimensions")?n.data("dimensions"):(l=this.controls.squareDrag,t={w:n.width(),h:n.height()},n.data("dimensions",t),t)},_isNonHueControl:function(e,i){return"square"===e&&"h"===this.options.controls.strip||"external"!==i&&("h"!==i||"strip"!==e)},_change:function(){var i=this,t=i.controls,l=i._getHSpaceColor(),n=["square","strip"],s=i.options.controls,o=s[i.active]||"external",r=i.hue;"strip"===i.active?n=[]:"external"!==i.active&&n.pop(),e.each(n,function(e,n){var o,r,a;if(n!==i.active)switch(n){case"strip":o="h"===s.strip?i._scale[s.strip]-l[s.strip]:l[s.strip],t.stripSlider.slider("value",o);break;case"square":r=i._squareDimensions(),a={left:l[s.horiz]/i._scale[s.horiz]*r.w,top:r.h-l[s.vert]/i._scale[s.vert]*r.h},i.controls.squareDrag.css(a)}}),l.h!==r&&i._isNonHueControl(i.active,o)&&i._color.h(r),i.hue=i._color.h(),i.options.color=i._color.toString(),i.element.is(":input")&&!i._color.error&&(i.element.removeClass("iris-error"),i.element.val()!==i._color.toString()&&(i.element.val(i._color.toString()),this._currentElement&&(!i["default"]||i["default"]&&"external"!==i.active?this._currentElement.val(i._color.toString().replace(/^#/,"")).parent().find(".fl-color-picker-color").css({backgroundColor:i._color.toString()}).removeClass("fl-color-picker-empty"):this._currentElement.val(""),i._wrapper.find(".fl-alpha-slider-offset").css("background-color",i._color.toString()),this._currentElement.trigger("change")))),i._paint(),i._inited=!0,i.active=!1},_debounce:function(e,i,t){var l,n;return function(){var s,o,r=this,a=arguments;return s=function(){l=null,t||(n=e.apply(r,a))},o=t&&!l,clearTimeout(l),l=setTimeout(s,i),o&&(n=e.apply(r,a)),n}},_buildAlphaUI:function(){var i=this;i._wrapper.on("click",".fl-color-picker-color",function(){var t=e(this);i._currentElement.val();t.hasClass("fl-color-picker-alpha-enabled")?(i._ui.find(".fl-alpha-wrap").length<=0&&e(i._alphaHtml).insertAfter(i._iris),i.picker.addClass("fl-color-alpha-enabled"),i._pickerAlphaControls()):(i.picker.removeClass("fl-color-alpha-enabled"),i._ui.find(".fl-alpha-wrap").remove())})},_pickerAlphaControls:function(){var e=this,i=e._currentElement,t=flBuilderParseColorValue(i.val()),l=parseFloat(t.alpha/100),n=e._wrapper,s=e._ui,o=s.find(".fl-alpha-wrap"),r=o.find(".fl-alpha-slider"),a=o.find(".fl-alpha-text"),d=o.find(".fl-alpha-slider-offset");alphaHandle=o.find(".ui-slider-handle"),a.text(l<1?l:""),r.slider({orientation:"vertical",slide:function(i,t){var l=parseFloat(t.value/100);e._color._alpha=l,a.text(l<1?l:""),e._change.apply(e,arguments)},create:function(){d.css({backgroundColor:t.value}),n.on("click",".fl-color-picker-clear",function(){e._color._alpha=1,a.text(""),r.slider("value",100).trigger("slide")})},value:t.alpha,step:1,min:0,max:100})}}}(jQuery),function(e,i){var t=function(e,i){return this instanceof t?this._init(e,i):new t(e,i)};t.fn=t.prototype={_color:0,_alpha:1,error:!1,_hsl:{h:0,s:0,l:0},_hsv:{h:0,s:0,v:0},_hSpace:"hsl",_init:function(e){var t="noop";switch(typeof e){case"object":return e.a!==i&&this.a(e.a),t=e.r!==i?"fromRgb":e.l!==i?"fromHsl":e.v!==i?"fromHsv":t,this[t](e);case"string":return this.fromCSS(e);case"number":return this.fromInt(parseInt(e,10))}return this},_error:function(){return this.error=!0,this},clone:function(){for(var e=new t(this.toInt()),i=["_alpha","_hSpace","_hsl","_hsv","error"],l=i.length-1;l>=0;l--)e[i[l]]=this[i[l]];return e},setHSpace:function(e){return this._hSpace="hsv"===e?e:"hsl",this},noop:function(){return this},fromCSS:function(e){var i,t=/^(rgb|hs(l|v))a?\(/;if(this.error=!1,e=e.replace(/^\s+/,"").replace(/\s+$/,"").replace(/;$/,""),e.match(t)&&e.match(/\)$/)){if(i=e.replace(/(\s|%)/g,"").replace(t,"").replace(/,?\);?$/,"").split(","),i.length<3)return this._error();if(4===i.length&&(this.a(parseFloat(i.pop())),this.error))return this;for(var l=i.length-1;l>=0;l--)if(i[l]=parseInt(i[l],10),isNaN(i[l]))return this._error();return e.match(/^rgb/)?this.fromRgb({r:i[0],g:i[1],b:i[2]}):e.match(/^hsv/)?this.fromHsv({h:i[0],s:i[1],v:i[2]}):this.fromHsl({h:i[0],s:i[1],l:i[2]})}return this.fromHex(e)},fromRgb:function(e,t){return"object"!=typeof e||e.r===i||e.g===i||e.b===i?this._error():(this.error=!1,this.fromInt(parseInt((e.r<<16)+(e.g<<8)+e.b,10),t))},fromHex:function(e){return e=e.replace(/^#/,"").replace(/^0x/,""),3===e.length&&(e=e[0]+e[0]+e[1]+e[1]+e[2]+e[2]),this.error=!/^[0-9A-F]{6}$/i.test(e),this.fromInt(parseInt(e,16))},fromHsl:function(e){var t,l,n,s,o,r,a,d;return"object"!=typeof e||e.h===i||e.s===i||e.l===i?this._error():(this._hsl=e,this._hSpace="hsl",r=e.h/360,a=e.s/100,d=e.l/100,0===a?t=l=n=d:(s=d<.5?d*(1+a):d+a-d*a,o=2*d-s,t=this.hue2rgb(o,s,r+1/3),l=this.hue2rgb(o,s,r),n=this.hue2rgb(o,s,r-1/3)),this.fromRgb({r:255*t,g:255*l,b:255*n},!0))},fromHsv:function(e){var t,l,n,s,o,r,a,d,u,c,f;if("object"!=typeof e||e.h===i||e.s===i||e.v===i)return this._error();switch(this._hsv=e,this._hSpace="hsv",t=e.h/360,l=e.s/100,n=e.v/100,a=Math.floor(6*t),d=6*t-a,u=n*(1-l),c=n*(1-d*l),f=n*(1-(1-d)*l),a%6){case 0:s=n,o=f,r=u;break;case 1:s=c,o=n,r=u;break;case 2:s=u,o=n,r=f;break;case 3:s=u,o=c,r=n;break;case 4:s=f,o=u,r=n;break;case 5:s=n,o=u,r=c}return this.fromRgb({r:255*s,g:255*o,b:255*r},!0)},fromInt:function(e,t){return this._color=parseInt(e,10),isNaN(this._color)&&(this._color=0),this._color>16777215?this._color=16777215:this._color<0&&(this._color=0),t===i&&(this._hsv.h=this._hsv.s=this._hsl.h=this._hsl.s=0),this},hue2rgb:function(e,i,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?e+6*(i-e)*t:t<.5?i:t<2/3?e+(i-e)*(2/3-t)*6:e},toString:function(){if(this._alpha<1)return this.toCSS("rgba",this._alpha).replace(/\s+/g,"");var e=parseInt(this._color,10).toString(16);if(this.error)return"";if(e.length<6)for(var i=6-e.length-1;i>=0;i--)e="0"+e;return"#"+e},toCSS:function(e,i){switch(e=e||"hex",i=parseFloat(i||this._alpha),e){case"rgb":case"rgba":var t=this.toRgb();return i<1?"rgba( "+t.r+", "+t.g+", "+t.b+", "+i+" )":"rgb( "+t.r+", "+t.g+", "+t.b+" )";case"hsl":case"hsla":var l=this.toHsl();return i<1?"hsla( "+l.h+", "+l.s+"%, "+l.l+"%, "+i+" )":"hsl( "+l.h+", "+l.s+"%, "+l.l+"% )";default:return this.toString()}},toRgb:function(){return{r:255&this._color>>16,g:255&this._color>>8,b:255&this._color}},toHsl:function(){var e,i,t=this.toRgb(),l=t.r/255,n=t.g/255,s=t.b/255,o=Math.max(l,n,s),r=Math.min(l,n,s),a=(o+r)/2;if(o===r)e=i=0;else{var d=o-r;switch(i=a>.5?d/(2-o-r):d/(o+r),o){case l:e=(n-s)/d+(n<s?6:0);break;case n:e=(s-l)/d+2;break;case s:e=(l-n)/d+4}e/=6}return e=Math.round(360*e),0===e&&this._hsl.h!==e&&(e=this._hsl.h),i=Math.round(100*i),0===i&&this._hsl.s&&(i=this._hsl.s),{h:e,s:i,l:Math.round(100*a)}},toHsv:function(){var e,i,t=this.toRgb(),l=t.r/255,n=t.g/255,s=t.b/255,o=Math.max(l,n,s),r=Math.min(l,n,s),a=o,d=o-r;if(i=0===o?0:d/o,o===r)e=i=0;else{switch(o){case l:e=(n-s)/d+(n<s?6:0);break;case n:e=(s-l)/d+2;break;case s:e=(l-n)/d+4}e/=6}return e=Math.round(360*e),0===e&&this._hsv.h!==e&&(e=this._hsv.h),i=Math.round(100*i),0===i&&this._hsv.s&&(i=this._hsv.s),{h:e,s:i,v:Math.round(100*a)}},toInt:function(){return this._color},toIEOctoHex:function(){var e=this.toString(),i=parseInt(255*this._alpha,10).toString(16);return 1===i.length&&(i="0"+i),"#"+i+e.replace(/^#/,"")},toLuminosity:function(){var e=this.toRgb();return.2126*Math.pow(e.r/255,2.2)+.7152*Math.pow(e.g/255,2.2)+.0722*Math.pow(e.b/255,2.2)},getDistanceLuminosityFrom:function(e){if(!(e instanceof t))throw"getDistanceLuminosityFrom requires a Color object";var i=this.toLuminosity(),l=e.toLuminosity();return i>l?(i+.05)/(l+.05):(l+.05)/(i+.05)},getMaxContrastColor:function(){var e=this.toLuminosity(),i=e>=.5?"000000":"ffffff";return new t(i)},getReadableContrastingColor:function(e,l){if(!(e instanceof t))return this;var n=l===i?5:l,s=e.getDistanceLuminosityFrom(this),o=e.getMaxContrastColor(),r=o.getDistanceLuminosityFrom(e);if(r<=n)return o;if(s>=n)return this;for(var a=0===o.toInt()?-1:1;s<n&&(this.l(a,!0),s=this.getDistanceLuminosityFrom(e),0!==this._color&&16777215!==this._color););return this},a:function(e){if(e===i)return this._alpha;var t=parseFloat(e);return isNaN(t)?this._error():(this._alpha=t,this)},darken:function(e){return e=e||5,this.l(-e,!0)},lighten:function(e){return e=e||5,this.l(e,!0)},saturate:function(e){return e=e||15,this.s(e,!0)},desaturate:function(e){return e=e||15,this.s(-e,!0)},toGrayscale:function(){return this.setHSpace("hsl").s(0)},getComplement:function(){return this.h(180,!0)},getSplitComplement:function(e){e=e||1;var i=180+30*e;return this.h(i,!0)},getAnalog:function(e){e=e||1;var i=30*e;return this.h(i,!0)},getTetrad:function(e){e=e||1;var i=60*e;return this.h(i,!0)},getTriad:function(e){e=e||1;var i=120*e;return this.h(i,!0)},_partial:function(e){var t=l[e];return function(l,n){var s=this._spaceFunc("to",t.space);return l===i?s[e]:(n===!0&&(l=s[e]+l),t.mod&&(l%=t.mod),t.range&&(l=l<t.range[0]?t.range[0]:l>t.range[1]?t.range[1]:l),s[e]=l,this._spaceFunc("from",t.space,s))}},_spaceFunc:function(e,i,t){var l=i||this._hSpace,n=e+l.charAt(0).toUpperCase()+l.substr(1);return this[n](t)}};var l={h:{mod:360},s:{range:[0,100]},l:{space:"hsl",range:[0,100]},v:{space:"hsv",range:[0,100]},r:{space:"rgb",range:[0,255]},g:{space:"rgb",range:[0,255]},b:{space:"rgb",range:[0,255]}};for(var n in l)l.hasOwnProperty(n)&&(t.fn[n]=t.fn._partial(n));"object"==typeof exports?module.exports=t:(e.FLBuilderColor=t,e.Color=t)}(this),function(e){FLLightbox=function(e){this._init(e)},FLLightbox.closeParent=function(i){var t=e(i).closest(".fl-lightbox-wrap").attr("data-instance-id");_.isUndefined(t)||FLLightbox._instances[t].close()},FLLightbox.getResizableControlClass=function(){var i=e(".fl-lightbox-resizable").eq(0),t="far fa-window-maximize";return i.length&&i.hasClass("fl-lightbox-width-full")&&(t="far fa-window-minimize"),t},FLLightbox.unbindAll=function(){var e;for(e in FLLightbox._instances)FLLightbox._instances[e]._unbind()},FLLightbox.bindAll=function(){var e;for(e in FLLightbox._instances)FLLightbox._instances[e]._bind()},FLLightbox.closeAll=function(){var e;for(e in FLLightbox._instances)FLLightbox._instances[e].close()},FLLightbox._instances={},FLLightbox.prototype={_id:null,_node:null,_visible:!1,_allowClosing:!0,_resizeTimer:null,_defaults:{className:"",destroyOnClose:!1,resizable:!1},open:function(e){var i=this._node.find(".fl-lightbox"),t=i.closest(".fl-builder-ui-pinned").length,l=this._getPositionSettings();!t&&l&&this._defaults.resizable&&i.css(l),this._bind(),this._node.show(),this._visible=!0,"undefined"!=typeof e?this.setContent(e):this._resize(),this.trigger("open"),FLBuilder.triggerHook("didShowLightbox",this)},close:function(){var e=this._node.data("parent");this._allowClosing&&(this.trigger("beforeCloseLightbox"),this._unbind(),this._node.hide(),this._visible=!1,this.trigger("close"),FLBuilder.triggerHook("didHideLightbox"),this._defaults.resizable&&_.isUndefined(e)&&FLBuilder.triggerHook("didHideAllLightboxes"),this._defaults.destroyOnClose&&this.destroy())},disableClose:function(){this._allowClosing=!1},enableClose:function(){this._allowClosing=!0},setContent:function(e){this._node.find(".fl-lightbox-content").html(e),this._resize()},empty:function(){this._node.find(".fl-lightbox-content").empty()},on:function(e,i){this._node.on(e,i)},off:function(e,i){this._node.off(e,i)},trigger:function(e,i){this._node.trigger(e,i)},destroy:function(){this._node.empty(),this._node.remove(),FLLightbox._instances[this._id]="undefined";try{delete FLLightbox._instances[this._id]}catch(e){}},_init:function(i){var t=0,l=null;for(l in FLLightbox._instances)t++;this._defaults=e.extend({},this._defaults,i),this._id=(new Date).getTime()+t,FLLightbox._instances[this._id]=this,this._render(),this._resizable()},_render:function(){this._node=e('<div class="fl-lightbox-wrap" data-instance-id="'+this._id+'"><div class="fl-lightbox-mask"></div><div class="fl-lightbox"><div class="fl-lightbox-content-wrap"><div class="fl-lightbox-content"></div></div></div></div>'),this._node.addClass(this._defaults.className),e("body").append(this._node)},_bind:function(){e(window).on("resize.fl-lightbox-"+this._id,this._delayedResize.bind(this))},_unbind:function(){e(window).off("resize.fl-lightbox-"+this._id)},_resizable:function(){var i=(e("body"),this._node.find(".fl-lightbox-mask")),t=this._node.find(".fl-lightbox"),l=e(".fl-lightbox-resizable").eq(0);this._defaults.resizable?(i.hide(),t.addClass("fl-lightbox-resizable"),t.delegate(".fl-lightbox-resize-toggle","click",this._resizeClicked.bind(this)),t.draggable({cursor:"move",handle:".fl-lightbox-header"}).resizable({handles:"all",minHeight:500,minWidth:380,start:this._resizeStart.bind(this),stop:this._resizeStop.bind(this)}),l.length&&l.hasClass("fl-lightbox-width-full")?(t.addClass("fl-lightbox-width-full"),t.draggable("disable")):this._restorePosition()):i.show(),this._resize()},_delayedResize:function(){clearTimeout(this._resizeTimer),this._resizeTimer=setTimeout(this._resize.bind(this),250)},_resize:function(){var i=this._node.find(".fl-lightbox"),t=parseInt(this._node.css("padding-top")),l=parseInt(this._node.css("padding-bottom")),n=parseInt(this._node.css("padding-left")),s=parseInt(this._node.css("padding-right")),o=i.height(),r=i.width(),a=e(window),d=a.height()-t-l,u=(a.width()-n-s,"0px");this._defaults.resizable?(r<600?i.addClass("fl-lightbox-width-slim"):i.removeClass("fl-lightbox-width-slim"),r<450?i.addClass("fl-lightbox-width-micro"):i.removeClass("fl-lightbox-width-micro"),this._resizeEditors()):(d>o&&(u=(d-o-46)/2+"px"),i.attr("style","").css("margin",u+" auto 0")),this.trigger("resized")},_resizeStart:function(){e("body").addClass("fl-builder-resizable-is-resizing"),e(".fl-builder-lightbox:visible").append('<div class="fl-builder-resizable-iframe-fix"></div>'),FLBuilder._destroyOverlayEvents(),FLBuilder._removeAllOverlays()},_resizeStop:function(i,t){var l=e(".fl-lightbox-resizable:visible");parseInt(l.css("top"))<0&&l.css("top","0"),this._savePosition(),e("body").removeClass("fl-builder-resizable-is-resizing"),e(".fl-builder-resizable-iframe-fix").remove(),FLBuilder._bindOverlayEvents()},_resizeClicked:function(){var i=e(".fl-lightbox-resizable"),t=(i.find(".fl-lightbox-resize-toggle"),this._node.find(".fl-lightbox"));t.hasClass("fl-lightbox-width-full")?this._resizeExitFull():this._resizeEnterFull(),this._resize()},_resizeEnterFull:function(){var i=e(".fl-lightbox-resizable"),t=i.find(".fl-lightbox-resize-toggle");this._node.find(".fl-lightbox");t.removeClass("fa-window-maximize").addClass("fa-window-minimize"),i.addClass("fl-lightbox-width-full"),i.draggable("disable"),i.resizable("disable")},_resizeExitFull:function(){var i=e(".fl-lightbox-resizable"),t=i.find(".fl-lightbox-resize-toggle");this._node.find(".fl-lightbox");t.removeClass("fa-window-minimize").addClass("fa-window-maximize"),i.removeClass("fl-lightbox-width-full"),i.draggable("enable"),i.resizable("enable")},_resizeEditors:function(){e(".fl-lightbox-resizable").each(function(){var i=e(this),t=i.find(".fl-builder-settings-fields").height(),l=i.find(".mce-edit-area > iframe, textarea.wp-editor-area, .ace_editor"),n=null;t<350&&(t=350),l.each(function(){n=e(this),n.hasClass("ace_editor")?(n.height(t-60),n.closest(".fl-field").data("editor").resize()):n.closest(".mce-container-body").find(".mce-toolbar-grp .mce-toolbar.mce-last").is(":visible")?n.height(t-175):n.height(t-150);
})})},_savePosition:function(){var e=this._node.find(".fl-lightbox"),i={width:e.width(),height:e.height(),top:parseInt(e.css("top"))<0?"0px":e.css("top"),left:e.css("left")};e.closest(".fl-builder-ui-pinned").length||(FLBuilderConfig.userSettings.lightbox=i,FLBuilder.ajax({action:"save_lightbox_position",data:i}))},_restorePosition:function(){var e=this._node.find(".fl-lightbox"),i=this._getPositionSettings();i?e.css(i):e.css({top:25,left:FLBuilderConfig.isRtl?"-25":25})},_getPositionSettings:function(){var e=FLBuilderConfig.userSettings.lightbox;if(!e)return!1;var i=window.innerHeight,t=parseInt(e.height),l=parseInt(e.top),n=parseInt(e.left),s=(parseInt(e.top),parseInt(e.width));return n+s+100>screen.width&&(e.left=screen.width-s-250),n<0&&(e.left=50),(t>i&&i>546||l+t>i)&&(t>i&&(e.height=i-50),e.top=0),e}}}(jQuery),function(e){FLIconSelector={_content:null,_lightbox:null,_rendered:!1,_filterText:"",open:function(e){FLIconSelector._rendered||FLIconSelector._render(),null===FLIconSelector._content?(FLIconSelector._lightbox.open('<div class="fl-builder-lightbox-loading"></div>'),FLBuilder.ajax({action:"render_icon_selector"},FLIconSelector._getContentComplete)):FLIconSelector._lightbox.open(),FLIconSelector._lightbox.on("icon-selected",function(i,t){FLIconSelector._lightbox.off("icon-selected"),FLIconSelector._lightbox.close(),e(t)})},_render:function(){FLIconSelector._lightbox=new FLLightbox({className:"fl-icon-selector"}),FLIconSelector._rendered=!0,FLBuilder.addHook("endEditingSession",function(){FLIconSelector._lightbox.close()})},_getContentComplete:function(i){var t=FLBuilder._jsonParse(i);FLIconSelector._content=t.html,FLIconSelector._lightbox.setContent(t.html),e(".fl-icons-filter-select").on("change",FLIconSelector._filter),e(".fl-icons-filter-text").on("keyup",FLIconSelector._filter),e(".fl-icons-list i").on("click",FLIconSelector._select),e(".fl-icon-selector-cancel").on("click",e.proxy(FLIconSelector._lightbox.close,FLIconSelector._lightbox))},_filter:function(){var i=e(".fl-icons-filter-select").val(),t=e(".fl-icons-filter-text").val();"all"==i?e(".fl-icons-section").show():(e(".fl-icons-section").hide(),e(".fl-"+i).show()),FLIconSelector._filterText=t,""!==t?e(".fl-icons-list i").each(FLIconSelector._filterIcon):e(".fl-icons-list i").show()},_filterIcon:function(){var i=e(this);-1==i.attr("class").indexOf(FLIconSelector._filterText)?i.hide():i.show()},_select:function(){var i=e(this).attr("class");FLIconSelector._lightbox.trigger("icon-selected",i)}}}(jQuery),function(e){FLStyleSheet=function(i){"object"==typeof i&&e.extend(this,i),this._createSheet()},FLStyleSheet.prototype={id:null,_sheet:null,_sheetElement:null,updateRule:function(e,i,t){for(var l=this._sheet.cssRules?this._sheet.cssRules:this._sheet.rules,n=null,s=0;s<l.length;s++)l[s].selectorText.toLowerCase().replace(/\s/g,"")==e.toLowerCase().replace(/\s/g,"")&&(n=l[s]);if(n)if("object"==typeof i)for(s in i)this.setProperty(n,s,i[s]);else this.setProperty(n,i,t);else this.addRule(e,i,t)},setProperty:function(e,i,t){var l="";e.style.setProperty?(t.indexOf("!important")>-1&&(l="important",t=t.replace("!important","").trim()),e.style.setProperty(i,t,l)):e.style[this._toCamelCase(i)]=t},addRule:function(e,i,t){var l="",n="";if("object"==typeof i)for(n in i)l+=n+":"+i[n]+";";else l=i+":"+t+";";this._sheet.insertRule?this._sheet.insertRule(e+" { "+l+" }",this._sheet.cssRules.length):this._sheet.addRule(e,l)},destroy:function(){this._sheetElement&&(this._sheetElement.remove(),this._sheetElement=null),this._sheet&&(this._sheet=null)},disable:function(){this._sheet.disabled=!0},enable:function(){this._sheet.disabled=!1},_createSheet:function(){var i=this.id?' id="'+this.id+'"':"",t=this.className?' class="'+this.className+'"':"";this._sheet||(this._sheetElement=e('<style type="text/css"'+i+t+"></style>"),e("body").append(this._sheetElement),this._sheet=this._sheetElement[0].sheet)},_toCamelCase:function(e){return e.toLowerCase().replace(/-(.)/g,function(e,i){return i.toUpperCase()})}}}(jQuery),function(e){FLBuilder={preview:null,_actionsLightbox:null,_ajaxQueue:[],_ajaxRequest:null,_colResizeData:null,_colResizing:!1,_contentClass:!1,_dragEnabled:!1,_dragging:!1,_dragInitialScrollTop:0,_exitUrl:null,_layout:null,_layoutQueue:[],_layoutSettingsCSSCache:null,_layoutSettingsCSSTimeout:null,_lightbox:null,_lightboxScrollbarTimeout:null,_loadedModuleAssets:[],_moduleHelpers:{},_multiplePhotoSelector:null,_newColParent:null,_newColPosition:0,_newColGroupParent:null,_newColGroupPosition:0,_newModuleParent:null,_newModulePosition:0,_newRowPosition:0,_selectedTemplateId:null,_selectedTemplateType:null,_singlePhotoSelector:null,_singleVideoSelector:null,_multipleAudiosSelector:null,_codeDisabled:!1,_init:function(){FLBuilder._initJQueryReadyFix(),FLBuilder._initGlobalErrorHandling(),FLBuilder._initPostLock(),FLBuilder._initClassNames(),FLBuilder._initMediaUploader(),FLBuilder._initOverflowFix(),FLBuilder._initScrollbars(),FLBuilder._initLightboxes(),FLBuilder._initDropTargets(),FLBuilder._initSortables(),FLBuilder._initStrings(),FLBuilder._initTipTips(),FLBuilder._initTinyMCE(),FLBuilder._bindEvents(),FLBuilder._bindOverlayEvents(),FLBuilder._setupEmptyLayout(),FLBuilder._highlightEmptyCols(),FLBuilder.addHook("didInitUI",FLBuilder._showTourOrTemplates.bind(FLBuilder)),FLBuilder.addHook("endEditingSession",FLBuilder._doStats.bind(this)),FLBuilder.triggerHook("init")},_initJQueryReadyFix:function(){FLBuilderConfig.debug||(jQuery.fn.oldReady=jQuery.fn.ready,jQuery.fn.ready=function(i){return jQuery.fn.oldReady(function(){try{"function"==typeof i&&i(e)}catch(t){FLBuilder.logError(t)}})})},_initGlobalErrorHandling:function(){FLBuilderConfig.debug||(window.onerror=function(e,i,t,l,n){return FLBuilder.logGlobalError(e,i,t,l,n),!0})},_initPostLock:function(){"undefined"!=typeof wp.heartbeat&&(wp.heartbeat.interval(30),wp.heartbeat.enqueue("fl_builder_post_lock",{post_id:FLBuilderConfig.postId}))},_initClassNames:function(){e("html").addClass("fl-builder-edit"),e("body").addClass("fl-builder"),FLBuilderConfig.simpleUi&&e("body").addClass("fl-builder-simple"),FLBuilder._contentClass=".fl-builder-content-"+FLBuilderConfig.postId,e(FLBuilder._contentClass).addClass("fl-builder-content-editing")},_initMediaUploader:function(){wp.media.model.settings.post.id=FLBuilderConfig.postId},_initOverflowFix:function(){e(FLBuilder._contentClass).parents().css("overflow","visible")},_initScrollbars:function(){var i=e(".fl-nanoscroller").nanoScroller({alwaysVisible:!0,preventPageScrolling:!0,paneClass:"fl-nanoscroller-pane",sliderClass:"fl-nanoscroller-slider",contentClass:"fl-nanoscroller-content"}),t=i.filter(".fl-builder-settings-fields"),l=t.find(".fl-nanoscroller-pane");if(l.length){var n=l.get(0).style.display,s=t.find(".fl-nanoscroller-content");"none"===n?s.removeClass("has-scrollbar"):s.addClass("has-scrollbar")}},_initSortables:function(){var i={appendTo:"body",cursor:"move",cursorAt:{left:85,top:20},distance:1,helper:FLBuilder._blockDragHelper,start:FLBuilder._blockDragStart,sort:FLBuilder._blockDragSort,change:FLBuilder._blockDragChange,stop:FLBuilder._blockDragStop,placeholder:"fl-builder-drop-zone",tolerance:"intersect"},t="",l="",n="";n="row"==FLBuilderConfig.userTemplateType?FLBuilder._contentClass+" .fl-row:not(.fl-builder-node-loading) .fl-col-group-drop-target, "+FLBuilder._contentClass+" .fl-row:not(.fl-builder-node-loading) .fl-col-drop-target, "+FLBuilder._contentClass+" .fl-row:not(.fl-builder-node-loading) .fl-col-content":"column"==FLBuilderConfig.userTemplateType?FLBuilder._contentClass+" .fl-col-group-drop-target, "+FLBuilder._contentClass+" .fl-col-drop-target, "+FLBuilder._contentClass+" .fl-col-content":FLBuilder._contentClass+" .fl-row-drop-target, "+FLBuilder._contentClass+" .fl-row:not(.fl-builder-node-loading) .fl-col-group-drop-target, "+FLBuilder._contentClass+" .fl-row:not(.fl-builder-node-loading) .fl-col-drop-target, "+FLBuilder._contentClass+" .fl-row:not(.fl-builder-node-loading) .fl-col:not(.fl-builder-node-loading):not(.fl-node-global) .fl-col-content",l="row"==FLBuilderConfig.userTemplateType?FLBuilder._contentClass+" .fl-row:not(.fl-builder-node-loading) .fl-col-group-drop-target, "+FLBuilder._contentClass+" .fl-row:not(.fl-builder-node-loading) .fl-col-drop-target":FLBuilder._contentClass+" .fl-row-drop-target, "+FLBuilder._contentClass+" .fl-row:not(.fl-builder-node-loading) .fl-col-group-drop-target, "+FLBuilder._contentClass+" .fl-row:not(.fl-builder-node-loading) .fl-col-drop-target",t=FLBuilderConfig.nestedColumns?n:"row"==FLBuilderConfig.userTemplateType?FLBuilder._contentClass+" .fl-row:not(.fl-builder-node-loading) .fl-col-group-drop-target, "+FLBuilder._contentClass+" .fl-row:not(.fl-builder-node-loading) .fl-col-drop-target":FLBuilder._contentClass+" .fl-row-drop-target, "+FLBuilder._contentClass+" .fl-row:not(.fl-builder-node-loading) .fl-col-group-drop-target, "+FLBuilder._contentClass+" .fl-row:not(.fl-builder-node-loading) .fl-col-drop-target",e(".fl-builder-rows").sortable(e.extend({},i,{connectWith:t,items:".fl-builder-block-row",stop:FLBuilder._rowDragStop})),e(".fl-builder-row-templates").sortable(e.extend({},i,{connectWith:FLBuilder._contentClass+" .fl-row-drop-target",items:".fl-builder-block-row-template",stop:FLBuilder._nodeTemplateDragStop})),e(".fl-builder-saved-rows").sortable(e.extend({},i,{cancel:".fl-builder-node-template-actions, .fl-builder-node-template-edit, .fl-builder-node-template-delete",connectWith:FLBuilder._contentClass+" .fl-row-drop-target",items:".fl-builder-block-saved-row",stop:FLBuilder._nodeTemplateDragStop})),e(".fl-builder-saved-columns").sortable(e.extend({},i,{cancel:".fl-builder-node-template-actions, .fl-builder-node-template-edit, .fl-builder-node-template-delete",connectWith:l,items:".fl-builder-block-saved-column",stop:FLBuilder._nodeTemplateDragStop})),e(".fl-builder-modules, .fl-builder-widgets").sortable(e.extend({},i,{connectWith:n,items:".fl-builder-block-module",stop:FLBuilder._moduleDragStop})),e(".fl-builder-module-templates").sortable(e.extend({},i,{connectWith:n,items:".fl-builder-block-module-template",stop:FLBuilder._nodeTemplateDragStop})),e(".fl-builder-saved-modules").sortable(e.extend({},i,{cancel:".fl-builder-node-template-actions, .fl-builder-node-template-edit, .fl-builder-node-template-delete",connectWith:n,items:".fl-builder-block-saved-module",stop:FLBuilder._nodeTemplateDragStop})),e(".fl-row-sortable-proxy").sortable(e.extend({},i,{connectWith:FLBuilder._contentClass+" .fl-row-drop-target",helper:FLBuilder._rowDragHelper,start:FLBuilder._rowDragStart,stop:FLBuilder._rowDragStop})),e(".fl-col-sortable-proxy").sortable(e.extend({},i,{connectWith:n,helper:FLBuilder._colDragHelper,start:FLBuilder._colDragStart,stop:FLBuilder._colDragStop})),e(FLBuilder._contentClass+" .fl-col-content").sortable(e.extend({},i,{connectWith:n,handle:".fl-module-overlay .fl-block-overlay-actions .fl-block-move",helper:FLBuilder._moduleDragHelper,items:".fl-module, .fl-col-group",start:FLBuilder._moduleDragStart,stop:FLBuilder._moduleDragStop})),e(FLBuilder._contentClass+" .fl-row-drop-target").sortable(i),e(FLBuilder._contentClass+" .fl-col-group-drop-target").sortable(i),e(FLBuilder._contentClass+" .fl-col-drop-target").sortable(i)},_refreshSortables:function(){e(".ui-sortable").sortable("refresh")},_initStrings:function(){e.validator.messages.required=FLBuilderStrings.validateRequiredMessage},_bindEvents:function(){$excludedLinks=e(".fl-builder-bar a, .fl-builder--content-library-panel a, .fl-page-nav .nav a"),e("a").not($excludedLinks).on("click",FLBuilder._preventDefault),e(".fl-page-nav .nav a").on("click",FLBuilder._headerLinkClicked),e("body").delegate(".fl-builder-content a","click",FLBuilder._preventDefault),e("body").delegate("button.fl-builder-button","mouseup",this._buttonMouseUp.bind(this)),e(document).on("heartbeat-tick",FLBuilder._initPostLock),e(window).on("beforeunload",FLBuilder._warnBeforeUnload),e("body").delegate(".fl-builder-has-submenu","click",FLBuilder._submenuParentClicked),e("body").delegate(".fl-builder-has-submenu a","click",FLBuilder._submenuChildClicked),e("body").delegate(".fl-builder-submenu","mouseenter",FLBuilder._submenuMouseenter),e("body").delegate(".fl-builder-submenu","mouseleave",FLBuilder._submenuMouseleave),e("body").delegate(".fl-builder-submenu .fl-builder-has-submenu","mouseenter",FLBuilder._submenuNestedParentMouseenter),e(".fl-builder-panel-actions .fl-builder-panel-close").on("click",FLBuilder._closePanel),e(".fl-builder-blocks-section-title").on("click",FLBuilder._blockSectionTitleClicked),e("body").delegate(".fl-builder-node-template-actions","mousedown",FLBuilder._stopPropagation),e("body").delegate(".fl-builder-node-template-edit","mousedown",FLBuilder._stopPropagation),e("body").delegate(".fl-builder-node-template-delete","mousedown",FLBuilder._stopPropagation),e("body").delegate(".fl-builder-node-template-edit","click",FLBuilder._editNodeTemplateClicked),e("body").delegate(".fl-builder-node-template-delete","click",FLBuilder._deleteNodeTemplateClicked),e("body").delegate(".fl-builder-block","mousedown",FLBuilder._blockDragInit),e("body").on("mouseup",FLBuilder._blockDragCancel),e("body").delegate(".fl-builder-actions .fl-builder-cancel-button","click",FLBuilder._cancelButtonClicked),e("body").delegate(".fl-builder-save-user-template-button","click",FLBuilder._saveUserTemplateClicked),e("body").delegate(".fl-builder-duplicate-layout-button","click",FLBuilder._duplicateLayoutClicked),e("body").delegate(".fl-builder-layout-settings-button","click",FLBuilder._layoutSettingsClicked),e("body").delegate(".fl-builder-layout-settings .fl-builder-settings-save","click",FLBuilder._saveLayoutSettingsClicked),e("body").delegate(".fl-builder-layout-settings .fl-builder-settings-cancel","click",FLBuilder._cancelLayoutSettingsClicked),e("body").delegate(".fl-builder-global-settings-button","click",FLBuilder._globalSettingsClicked),e("body").delegate(".fl-builder-global-settings .fl-builder-settings-save","click",FLBuilder._saveGlobalSettingsClicked),e("body").delegate(".fl-builder-global-settings .fl-builder-settings-cancel","click",FLBuilder._cancelLayoutSettingsClicked),e("body").delegate(".fl-user-template","click",FLBuilder._userTemplateClicked),e("body").delegate(".fl-user-template-edit","click",FLBuilder._editUserTemplateClicked),e("body").delegate(".fl-user-template-delete","click",FLBuilder._deleteUserTemplateClicked),e("body").delegate(".fl-builder-template-replace-button","click",FLBuilder._templateReplaceClicked),e("body").delegate(".fl-builder-template-append-button","click",FLBuilder._templateAppendClicked),e("body").delegate(".fl-builder-template-actions .fl-builder-cancel-button","click",FLBuilder._templateCancelClicked),e("body").delegate(".fl-builder-user-template-settings .fl-builder-settings-save","click",FLBuilder._saveUserTemplateSettings),e("body").delegate(".fl-builder-help-tour-button","click",FLBuilder._startHelpTour),e("body").delegate(".fl-builder-knowledge-base-button","click",FLBuilder._viewKnowledgeBaseClicked),e("body").delegate(".fl-builder-forums-button","click",FLBuilder._visitForumsClicked),e("body").delegate(".fl-builder-no-tour-button","click",FLBuilder._noTourButtonClicked),e("body").delegate(".fl-builder-yes-tour-button","click",FLBuilder._yesTourButtonClicked),e("body").delegate(".fl-builder-alert-close","click",FLBuilder._alertClose),e("body").delegate(".fl-block-overlay","contextmenu",FLBuilder._onContextmenu),e("body").delegate(".fl-row-overlay .fl-block-remove","click",FLBuilder._deleteRowClicked),e("body").delegate(".fl-row-overlay .fl-block-copy","click",FLBuilder._rowCopyClicked),e("body").delegate(".fl-row-overlay .fl-block-move","mousedown",FLBuilder._rowDragInit),e("body").delegate(".fl-row-overlay .fl-block-settings","click",FLBuilder._rowSettingsClicked),e("body").delegate(".fl-row-overlay","click",FLBuilder._rowSettingsClicked),e("body").delegate(".fl-builder-row-settings .fl-builder-settings-save","click",FLBuilder._saveSettings),e("body").delegate(".fl-block-col-submenu .fl-block-row-reset","click",FLBuilder._resetRowWidthClicked),e("body").delegate(".fl-col-overlay .fl-block-move","mousedown",FLBuilder._colDragInit),e("body").delegate(".fl-block-col-copy","click",FLBuilder._copyColClicked),e("body").delegate(".fl-col-overlay .fl-block-remove","click",FLBuilder._deleteColClicked),e("body").delegate(".fl-col-overlay .fl-block-settings","click",FLBuilder._colSettingsClicked),e("body").delegate(".fl-col-overlay","click",FLBuilder._colSettingsClicked),e("body").delegate(".fl-builder-col-settings .fl-builder-settings-save","click",FLBuilder._saveSettings),e("body").delegate(".fl-block-col-submenu .fl-block-col-move","mousedown",FLBuilder._colDragInit),e("body").delegate(".fl-block-col-submenu .fl-block-col-edit","click",FLBuilder._colSettingsClicked),e("body").delegate(".fl-block-col-submenu .fl-block-col-delete","click",FLBuilder._deleteColClicked),e("body").delegate(".fl-block-col-submenu .fl-block-col-reset","click",FLBuilder._resetColumnWidthsClicked),e("body").delegate(".fl-block-col-submenu li","mouseenter",FLBuilder._showColHighlightGuide),e("body").delegate(".fl-block-col-submenu li","mouseleave",FLBuilder._removeColHighlightGuides),e("body").delegate(".fl-block-col-submenu .fl-block-col-move-parent","mousedown",FLBuilder._colDragInit),e("body").delegate(".fl-block-col-submenu .fl-block-col-edit-parent","click",FLBuilder._colSettingsClicked),e("body").delegate(".fl-module-overlay .fl-block-remove","click",FLBuilder._deleteModuleClicked),e("body").delegate(".fl-module-overlay .fl-block-copy","click",FLBuilder._moduleCopyClicked),e("body").delegate(".fl-module-overlay .fl-block-move","mousedown",FLBuilder._blockDragInit),e("body").delegate(".fl-module-overlay .fl-block-settings","click",FLBuilder._moduleSettingsClicked),e("body").delegate(".fl-module-overlay","click",FLBuilder._moduleSettingsClicked),e("body").delegate(".fl-builder-module-settings .fl-builder-settings-save","click",FLBuilder._saveModuleClicked),e("body").delegate(".fl-module-overlay .fl-block-col-settings","click",FLBuilder._colSettingsClicked),e("body").delegate(".fl-builder-settings-save-as","click",FLBuilder._showNodeTemplateSettings),e("body").delegate(".fl-builder-node-template-settings .fl-builder-settings-save","click",FLBuilder._saveNodeTemplate),e("body").delegate(".fl-builder-settings-tabs a","click",FLBuilder._settingsTabClicked),e("body").delegate(".fl-builder-settings-tabs a","show",FLBuilder._calculateSettingsTabsOverflow),e("body").delegate(".fl-builder-settings-tabs a","hide",FLBuilder._calculateSettingsTabsOverflow),e("body").delegate(".fl-builder-settings-cancel","click",FLBuilder._settingsCancelClicked),e("body").delegate(".fl-builder-settings-tabs-overflow-menu > a","click",FLBuilder._settingsTabsToOverflowMenuItemClicked.bind(this)),e("body").delegate(".fl-builder-settings-tabs-more","click",FLBuilder._toggleTabsOverflowMenu.bind(this)),e("body").delegate(".fl-builder-settings-tabs-overflow-click-mask","click",FLBuilder._hideTabsOverflowMenu.bind(this)),e("body").delegate(".fl-help-tooltip-icon","mouseover",FLBuilder._showHelpTooltip),e("body").delegate(".fl-help-tooltip-icon","mouseout",FLBuilder._hideHelpTooltip),e("body").delegate(".fl-builder-field-add","click",FLBuilder._addFieldClicked),e("body").delegate(".fl-builder-field-copy","click",FLBuilder._copyFieldClicked),e("body").delegate(".fl-builder-field-delete","click",FLBuilder._deleteFieldClicked),e("body").delegate(".fl-photo-field .fl-photo-select","click",FLBuilder._selectSinglePhoto),e("body").delegate(".fl-photo-field .fl-photo-edit","click",FLBuilder._selectSinglePhoto),e("body").delegate(".fl-photo-field .fl-photo-replace","click",FLBuilder._selectSinglePhoto),e("body").delegate(".fl-photo-field .fl-photo-remove","click",FLBuilder._singlePhotoRemoved),e("body").delegate(".fl-multiple-photos-field .fl-multiple-photos-select","click",FLBuilder._selectMultiplePhotos),e("body").delegate(".fl-multiple-photos-field .fl-multiple-photos-edit","click",FLBuilder._selectMultiplePhotos),e("body").delegate(".fl-multiple-photos-field .fl-multiple-photos-add","click",FLBuilder._selectMultiplePhotos),e("body").delegate(".fl-video-field .fl-video-select","click",FLBuilder._selectSingleVideo),e("body").delegate(".fl-video-field .fl-video-replace","click",FLBuilder._selectSingleVideo),e("body").delegate(".fl-video-field .fl-video-remove","click",FLBuilder._singleVideoRemoved),e("body").delegate(".fl-multiple-audios-field .fl-multiple-audios-select","click",FLBuilder._selectMultipleAudios),e("body").delegate(".fl-multiple-audios-field .fl-multiple-audios-edit","click",FLBuilder._selectMultipleAudios),e("body").delegate(".fl-multiple-audios-field .fl-multiple-audios-add","click",FLBuilder._selectMultipleAudios),e("body").delegate(".fl-icon-field .fl-icon-select","click",FLBuilder._selectIcon),e("body").delegate(".fl-icon-field .fl-icon-replace","click",FLBuilder._selectIcon),e("body").delegate(".fl-icon-field .fl-icon-remove","click",FLBuilder._removeIcon),e("body").delegate(".fl-form-field .fl-form-field-edit","click",FLBuilder._formFieldClicked),e("body").delegate(".fl-form-field-settings .fl-builder-settings-save","click",FLBuilder._saveFormFieldClicked),e("body").delegate(".fl-layout-field-option","click",FLBuilder._layoutFieldClicked),e("body").delegate(".fl-link-field-select","click",FLBuilder._linkFieldSelectClicked),e("body").delegate(".fl-link-field-search-cancel","click",FLBuilder._linkFieldSelectCancelClicked),e("body").delegate(".fl-loop-data-source-select select[name=data_source]","change",FLBuilder._loopDataSourceChange),e("body").delegate(".fl-custom-query select[name=post_type]","change",FLBuilder._customQueryPostTypeChange),e("body").delegate(".fl-text-field-add-value","change",FLBuilder._textFieldAddValueSelectChange),e("body").delegate(".fl-field input[type=number]","focus",FLBuilder._onNumberFieldFocus),e("body").delegate(".fl-field input[type=number]","blur",FLBuilder._onNumberFieldBlur),FLBuilder.addHook("didCompleteAJAX",FLBuilder._refreshSettingsPreviewReference),FLBuilder.addHook("didRenderLayoutComplete",FLBuilder._refreshSettingsPreviewReference)},_unbindEvents:function(){e("a").off("click",FLBuilder._preventDefault),e(".fl-page-nav .nav a").off("click",FLBuilder._headerLinkClicked),e("body").undelegate(".fl-builder-content a","click",FLBuilder._preventDefault)},_rebindEvents:function(){e("a").on("click",FLBuilder._preventDefault),e(".fl-page-nav .nav a").on("click",FLBuilder._headerLinkClicked),e("body").delegate(".fl-builder-content a","click",FLBuilder._preventDefault)},_bindOverlayEvents:function(){var i=e(FLBuilder._contentClass);i.delegate(".fl-row","mouseenter",FLBuilder._rowMouseenter),i.delegate(".fl-row","mouseleave",FLBuilder._rowMouseleave),i.delegate(".fl-row-overlay","mouseleave",FLBuilder._rowMouseleave),i.delegate(".fl-col","mouseenter",FLBuilder._colMouseenter),i.delegate(".fl-col","mouseleave",FLBuilder._colMouseleave),i.delegate(".fl-module","mouseenter",FLBuilder._moduleMouseenter),i.delegate(".fl-module","mouseleave",FLBuilder._moduleMouseleave)},_destroyOverlayEvents:function(){var i=e(FLBuilder._contentClass);i.undelegate(".fl-row","mouseenter",FLBuilder._rowMouseenter),i.undelegate(".fl-row","mouseleave",FLBuilder._rowMouseleave),i.undelegate(".fl-row-overlay","mouseleave",FLBuilder._rowMouseleave),i.undelegate(".fl-col","mouseenter",FLBuilder._colMouseenter),i.undelegate(".fl-col","mouseleave",FLBuilder._colMouseleave),i.undelegate(".fl-module","mouseenter",FLBuilder._moduleMouseenter),i.undelegate(".fl-module","mouseleave",FLBuilder._moduleMouseleave)},_onContextmenu:function(i){e(this).hide()},_preventDefault:function(e){e.preventDefault()},_stopPropagation:function(e){e.stopPropagation()},_headerLinkClicked:function(i){var t=e(this),l=t.attr("href");this.hash||(i.preventDefault(),FLBuilderConfig.isUserTemplate||(FLBuilder._exitUrl=l.indexOf("?")>-1?l:l+"?fl_builder",FLBuilder.triggerHook("triggerDone")))},_warnBeforeUnload:function(){var i=e(".fl-builder-row-settings").length>0,t=e(".fl-builder-col-settings").length>0,l=e(".fl-builder-module-settings").length>0;if(i||t||l)return FLBuilderStrings.unloadWarning},_initTipTips:function(){e(".fl-tip:not(.fl-has-tip)").each(function(){var i=e(this);i.addClass("fl-has-tip"),void 0==i.attr("data-title")&&i.attr("data-title",i.attr("title"))}).tipTip({defaultPosition:"top",delay:1e3})},_hideTipTips:function(){e("#tiptip_holder").stop().hide()},_submenuParentClicked:function(i){var t=e("body"),l=e(this),n=l.find(".fl-builder-submenu");l.hasClass("fl-builder-submenu-open")?(t.removeClass("fl-builder-submenu-open"),l.removeClass("fl-builder-submenu-open"),l.removeClass("fl-builder-submenu-right")):(l.offset().left+n.width()>e(window).width()&&l.addClass("fl-builder-submenu-right"),t.addClass("fl-builder-submenu-open"),l.addClass("fl-builder-submenu-open")),n.closest(".fl-row-overlay").addClass("fl-row-menu-active"),FLBuilder._hideTipTips(),i.preventDefault(),i.stopPropagation()},_submenuChildClicked:function(i){var t=e("body"),l=e(this).parents(".fl-builder-has-submenu");l.parents(".fl-builder-has-submenu").length||(t.removeClass("fl-builder-submenu-open"),l.removeClass("fl-builder-submenu-open"))},_submenuMouseenter:function(i){var t=e(this),l=t.data("timeout");"undefined"!=typeof l&&clearTimeout(l)},_submenuMouseleave:function(i){var t=e("body"),l=e(this),n=setTimeout(function(){t.removeClass("fl-builder-submenu-open"),l.closest(".fl-builder-has-submenu").removeClass("fl-builder-submenu-open")},500);l.closest(".fl-row-overlay").removeClass("fl-row-menu-active"),l.data("timeout",n)},_submenuNestedParentMouseenter:function(i){var t=e(this),l=t.find(".fl-builder-submenu");t.width()+t.offset().left+l.width()>e(window).width()&&t.addClass("fl-builder-submenu-right")},_closeAllSubmenus:function(){e(".fl-builder-submenu-open").removeClass("fl-builder-submenu-open")},_upgradeClicked:function(){window.open(FLBuilderConfig.upgradeUrl)},_buttonMouseUp:function(i){e(i.currentTarget).blur()},_closePanel:function(){FLBuilder.triggerHook("hideContentPanel")},_showPanel:function(){FLBuilder.triggerHook("showContentPanel")},_togglePanel:function(){FLBuilder.triggerHook("toggleContentPanel")},_blockSectionTitleClicked:function(){var i=e(this),t=i.parent();t.hasClass("fl-active")?t.removeClass("fl-active"):(e(".fl-builder-blocks-section").removeClass("fl-active"),t.addClass("fl-active")),FLBuilder._initScrollbars()},_publishLayout:function(e){if(FLBuilder._triggerSettingsSave(!1,!0)){if(_.isUndefined(e))var e=!0;FLBuilder.ajax({action:"save_layout"},this._onPublishComplete.bind(this,e))}},_publishButtonClicked:function(e){FLBuilder._publishLayout(e)},_onPublishComplete:function(i){i&&(FLBuilderConfig.shouldRefreshOnPublish?FLBuilder._exit():FLBuilder._exitWithoutRefresh()),e("#wp-admin-bar-fl-builder-frontend-edit-link .fl-builder-admin-bar-status-dot").css("color","#6bc373"),FLBuilder.triggerHook("didPublishLayout")},_draftButtonClicked:function(){FLBuilder.showAjaxLoader(),FLBuilder.ajax({action:"save_draft"},FLBuilder._exit)},_discardButtonClicked:function(){var e=confirm(FLBuilderStrings.discardMessage);e?(FLBuilder.showAjaxLoader(),FLBuilder.ajax({action:"clear_draft_layout"},FLBuilder._exit)):FLBuilder.triggerHook("didCancelDiscard")},_cancelButtonClicked:function(){FLBuilder._exitUrl=null,FLBuilder._actionsLightbox.close()},_exit:function(){var e=window.location.href;try{var i="undefined"!=typeof window.opener.FLBuilder}catch(t){var i=!1}FLBuilderConfig.isUserTemplate&&"undefined"!=typeof window.opener&&window.opener?(i&&("undefined"==typeof FLBuilderGlobalNodeId?window.opener.FLBuilder._updateLayout():window.opener.FLBuilder._updateNode(FLBuilderGlobalNodeId)),window.close()):(FLBuilder._exitUrl?e=FLBuilder._exitUrl:(e=e.replace("?fl_builder&","?"),e=e.replace("?fl_builder",""),e=e.replace("&fl_builder","")),window.location.href=e)},_exitWithoutRefresh:function(){window.location.href;try{var e="undefined"!=typeof window.opener.FLBuilder}catch(i){var e=!1}FLBuilderConfig.isUserTemplate&&e&&window.opener?(e&&("undefined"==typeof FLBuilderGlobalNodeId?window.opener.FLBuilder._updateLayout():window.opener.FLBuilder._updateNode(FLBuilderGlobalNodeId)),window.close()):FLBuilder.triggerHook("endEditingSession")},_duplicateLayoutClicked:function(){FLBuilder.showAjaxLoader(),FLBuilder.ajax({action:"duplicate_post"},FLBuilder._duplicateLayoutComplete)},_duplicateLayoutComplete:function(e){var i=FLBuilderConfig.adminUrl;window.location.href=i+"post.php?post="+e+"&action=edit"},_layoutSettingsClicked:function(){FLBuilderSettingsForms.render({id:"layout",className:"fl-builder-layout-settings",settings:FLBuilderSettingsConfig.settings.layout},function(){FLBuilder._layoutSettingsInitCSS()})},_layoutSettingsInitCSS:function(){var i=e(".fl-builder-settings #fl-field-css textarea:not(.ace_text-input)");i.on("change",FLBuilder._layoutSettingsCSSChanged),FLBuilder._layoutSettingsCSSCache=i.val()},_layoutSettingsCSSChanged:function(){FLBuilder._layoutSettingsCSSTimeout&&clearTimeout(FLBuilder._layoutSettingsCSSTimeout),FLBuilder._layoutSettingsCSSTimeout=setTimeout(e.proxy(FLBuilder._layoutSettingsCSSDoChange,this),600)},_layoutSettingsCSSDoChange:function(){var i=e(".fl-builder-settings"),t=e(this),l=t.parents("#fl-field-css");l.find(".ace_error").length>0||(i.hasClass("fl-builder-layout-settings")?e("#fl-builder-layout-css").html(t.val()):e("#fl-builder-global-css").html(t.val()),FLBuilder._layoutSettingsCSSTimeout=null)},_saveLayoutSettingsClicked:function(){for(var i=e(this).closest(".fl-builder-settings"),t=i.serializeArray(),l={},n=0;n<t.length;n++)l[t[n].name]=t[n].value;FLBuilder.showAjaxLoader(),FLBuilder._lightbox.close(),FLBuilder._layoutSettingsCSSCache=null,FLBuilder.ajax({action:"save_layout_settings",settings:l},function(){FLBuilder.triggerHook("didSaveLayoutSettingsComplete",l),FLBuilder._updateLayout()})},_cancelLayoutSettingsClicked:function(){var i=e(".fl-builder-settings");i.hasClass("fl-builder-layout-settings")?e("#fl-builder-layout-css").html(FLBuilder._layoutSettingsCSSCache):e("#fl-builder-global-css").html(FLBuilder._layoutSettingsCSSCache),FLBuilder._layoutSettingsCSSCache=null},_globalSettingsClicked:function(){FLBuilderSettingsForms.render({id:"global",className:"fl-builder-global-settings",settings:FLBuilderSettingsConfig.settings.global},function(){FLBuilder._layoutSettingsInitCSS()})},_saveGlobalSettingsClicked:function(){var i=e(this).closest(".fl-builder-settings"),t=i.validate().form(),l=FLBuilder._getSettings(i);t&&(FLBuilder.showAjaxLoader(),FLBuilder._layoutSettingsCSSCache=null,FLBuilder.ajax({action:"save_global_settings",settings:l},FLBuilder._saveGlobalSettingsComplete),FLBuilder._lightbox.close())},_saveGlobalSettingsComplete:function(e){FLBuilderConfig.global=FLBuilder._jsonParse(e),FLBuilder.triggerHook("didSaveGlobalSettingsComplete",FLBuilderConfig.global),FLBuilder._updateLayout()},_initTemplateSelector:function(){var i=e(FLBuilder._contentClass).find(".fl-row"),t=i.length>0;t||FLBuilder.ContentPanel.show("modules")},_requestTemplateInsert:function(e,i){FLBuilder.layoutHasContent()?0==e?confirm(FLBuilderStrings.changeTemplateMessage)&&(FLBuilder._lightbox._node.hide(),FLBuilder._applyTemplate(0,!1,i)):(FLBuilder._selectedTemplateId=e,FLBuilder._selectedTemplateType=i,FLBuilder._showTemplateActions(),FLBuilder._lightbox._node.hide()):FLBuilder._applyTemplate(e,!1,i)},_showTemplateActions:function(){var e=[];e[10]={key:"template-replace",label:FLBuilderStrings.templateReplace},e[20]={key:"template-append",label:FLBuilderStrings.templateAppend},FLBuilder._showActionsLightbox({className:"fl-builder-template-actions",title:FLBuilderStrings.actionsLightboxTitle,buttons:e})},_templateReplaceClicked:function(){confirm(FLBuilderStrings.changeTemplateMessage)&&(FLBuilder._actionsLightbox.close(),FLBuilder._applyTemplate(FLBuilder._selectedTemplateId,!1,FLBuilder._selectedTemplateType));
},_templateAppendClicked:function(){FLBuilder._actionsLightbox.close(),FLBuilder._applyTemplate(FLBuilder._selectedTemplateId,!0,FLBuilder._selectedTemplateType)},_templateCancelClicked:function(){FLBuilder.triggerHook("showContentPanel")},_applyTemplate:function(e,i,t){i="undefined"!=typeof i&&i?"1":"0",t="undefined"==typeof t?"core":t,FLBuilder._lightbox.close(),FLBuilder.showAjaxLoader(),"core"==t?FLBuilder.ajax({action:"apply_template",template_id:e,append:i},FLBuilder._applyTemplateComplete):FLBuilder.ajax({action:"apply_user_template",template_id:e,append:i},FLBuilder._applyUserTemplateComplete),FLBuilder.triggerHook("didApplyTemplate")},_applyTemplateComplete:function(e){var i=FLBuilder._jsonParse(e);FLBuilder._renderLayout(i.layout),FLBuilder.triggerHook("didApplyTemplateComplete",i.config)},_applyUserTemplateComplete:function(i){var t=FLBuilder._jsonParse(i);null!==t.layout_css&&e("#fl-builder-layout-css").html(t.layout_css),FLBuilder._renderLayout(t.layout),FLBuilder.triggerHook("didApplyTemplateComplete",t.config)},_saveUserTemplateClicked:function(){FLBuilderSettingsForms.render({id:"user_template",className:"fl-builder-user-template-settings",rules:{name:{required:!0}}})},_saveUserTemplateSettings:function(){var i=e(this).closest(".fl-builder-settings"),t=i.validate().form(),l=FLBuilder._getSettings(i);t&&(FLBuilder.ajax({action:"save_user_template",settings:l},FLBuilder._saveUserTemplateSettingsComplete),FLBuilder._lightbox.close())},_saveUserTemplateSettingsComplete:function(e){if(e){var e=FLBuilder._jsonParse(e);FLBuilderConfig.contentItems.template.push(e),FLBuilder.triggerHook("contentItemsChanged")}},_userTemplateClicked:function(){var i=e(this).attr("data-id");e(FLBuilder._contentClass).children(".fl-row").length>0?"blank"==i?confirm(FLBuilderStrings.changeTemplateMessage)&&(FLBuilder._lightbox._node.hide(),FLBuilder._applyTemplate("blank",!1,"user")):(FLBuilder._selectedTemplateId=i,FLBuilder._selectedTemplateType="user",FLBuilder._showTemplateActions(),FLBuilder._lightbox._node.hide()):FLBuilder._applyTemplate(i,!1,"user")},_editUserTemplateClicked:function(i){i.preventDefault(),i.stopPropagation(),window.open(e(this).attr("href"))},_deleteUserTemplateClicked:function(i){var t=e(this).closest(".fl-user-template"),l=t.attr("data-id"),n=(e(".fl-user-template[data-id="+l+"]"),null),s=null,o=null;if(confirm(FLBuilderStrings.deleteTemplate)){FLBuilder.ajax({action:"delete_user_template",template_id:l});for(s in FLBuilderConfig.contentItems.template)o=FLBuilderConfig.contentItems.template[s],o.postId==l&&(n=s);_.isNull(n)||(FLBuilderConfig.contentItems.template.splice(n,1),FLBuilder.triggerHook("contentItemsChanged"))}i.stopPropagation()},_viewKnowledgeBaseClicked:function(){window.open(FLBuilderConfig.help.knowledge_base_url)},_visitForumsClicked:function(){window.open(FLBuilderConfig.help.forums_url)},_showTourOrTemplates:function(){FLBuilderConfig.simpleUi||FLBuilderConfig.isUserTemplate||(FLBuilderConfig.help.tour&&FLBuilderConfig.newUser?FLBuilder._showTourLightbox():FLBuilder._initTemplateSelector())},_doStats:function(){1==FLBuilderConfig.statsEnabled&&(args={"screen-width":screen.width,"screen-height":screen.height,"pixel-ratio":window.devicePixelRatio,"user-agent":window.navigator.userAgent,isrtl:FLBuilderConfig.isRtl},FLBuilder.ajax({action:"save_browser_stats",browser_data:args}))},_showTourLightbox:function(){var e=wp.template("fl-tour-lightbox");FLBuilder._actionsLightbox.open(e())},_noTourButtonClicked:function(){FLBuilder._actionsLightbox.close(),FLBuilder._initTemplateSelector()},_yesTourButtonClicked:function(){FLBuilder._actionsLightbox.close(),FLBuilderTour.start()},_startHelpTour:function(){FLBuilder._actionsLightbox.close(),FLBuilderTour.start()},_setupEmptyLayout:function(){var i=e(FLBuilder._contentClass);FLBuilderConfig.isUserTemplate&&"module"==FLBuilderConfig.userTemplateType||FLBuilderConfig.isUserTemplate&&"column"==FLBuilderConfig.userTemplateType||(i.removeClass("fl-builder-empty"),i.find(".fl-builder-empty-message").remove(),i.find(".fl-row, .fl-builder-block").length||(i.addClass("fl-builder-empty"),i.append('<span class="fl-builder-empty-message">'+FLBuilderStrings.emptyMessage+"</span>"),FLBuilder._initSortables()))},_updateNode:function(i,t){e(".fl-node-"+i).length&&(FLBuilder._showNodeLoading(i),FLBuilder.ajax({action:"render_node",node_id:i},function(e){FLBuilder._renderLayout(FLBuilder._jsonParse(e),t)}.bind(this)))},_updateLayout:function(){FLBuilder.showAjaxLoader(),FLBuilder.ajax({action:"render_layout"},FLBuilder._renderLayout)},_renderLayout:function(e,i){FLBuilder._layout?FLBuilder._layoutQueue.push({data:e,callback:i}):FLBuilder._layout=new FLBuilderAJAXLayout(e,i)},_renderLayoutComplete:function(){if(FLBuilder._layout&&(FLBuilder._layout._complete(),FLBuilder._layout=null),FLBuilder._layoutQueue.length){var e=FLBuilder._layoutQueue.shift();FLBuilder._layout=new FLBuilderAJAXLayout(e.data,e.callback)}},_resizeLayout:function(){e(window).trigger("resize"),"undefined"!=typeof YUI&&YUI().use("node-event-simulate",function(e){e.one(window).simulate("resize")})},layoutHasContent:function(){return e(FLBuilder._contentClass).children(".fl-row").length>0},_initMediaElements:function(){var i={};"undefined"!=typeof e.fn.mediaelementplayer&&("undefined"!=typeof _wpmejsSettings&&(i.pluginPath=_wpmejsSettings.pluginPath),e(".wp-audio-shortcode, .wp-video-shortcode").not(".mejs-container").mediaelementplayer(i))},_initDropTargets:function(){var i="row"==FLBuilderConfig.userTemplateType?"":":not(.fl-node-global)",t=e(FLBuilder._contentClass+" .fl-row"),l=null,n=e(FLBuilder._contentClass+" .fl-row"+i).find(".fl-col-group"),s=null,o=null,r="column"==FLBuilderConfig.userTemplateType?e(FLBuilder._contentClass+"> .fl-col").eq(0):null,a=0;for(e(".fl-col-drop-target").remove(),e(".fl-col-group-drop-target").remove(),e(".fl-row-drop-target").remove(),e(FLBuilder._contentClass).append('<div class="fl-drop-target fl-row-drop-target"></div>'),t.prepend('<div class="fl-drop-target fl-row-drop-target"></div>'),t.append('<div class="fl-drop-target fl-drop-target-last fl-row-drop-target fl-row-drop-target-last"></div>');a<t.length;a++)l=t.eq(a),0===l.find(".fl-col-group").length&&l.find(".fl-row-content").prepend('<div class="fl-drop-target fl-col-group-drop-target"></div>');for(r&&0===n.length&&(n=r.find(".fl-col-group"),r.append('<div class="fl-drop-target fl-col-drop-target"></div>'),r.append('<div class="fl-drop-target fl-drop-target-last fl-col-drop-target fl-col-drop-target-last"></div>')),a=0;a<n.length;a++)s=n.eq(a),o=s.find("> .fl-col"),s.hasClass("fl-col-group-nested")||(s.append('<div class="fl-drop-target fl-col-group-drop-target"></div>'),s.append('<div class="fl-drop-target fl-drop-target-last fl-col-group-drop-target fl-col-group-drop-target-last"></div>')),o.append('<div class="fl-drop-target fl-col-drop-target"></div>'),o.append('<div class="fl-drop-target fl-drop-target-last fl-col-drop-target fl-col-drop-target-last"></div>')},_blockDragHelper:function(e,i){var t=i.clone();return i.clone().insertAfter(i),t.addClass("fl-builder-block-drag-helper"),t},_blockDragInit:function(i){var t=e(i.currentTarget),l=null,n=e(window).scrollTop(),s=0;FLBuilder._dragEnabled=!0,FLBuilder._dragInitialScrollTop=n,t.closest("[data-node]").length>0?(l=t.closest("[data-node]"),l.addClass("fl-node-drag-init")):t.hasClass("fl-builder-block")&&e(".fl-row").each(function(){null===l&&e(this).offset().top-n>0&&(l=e(this))}),null!==l&&(s=l.offset().top-n),FLBuilder._highlightRowsAndColsForDrag(t),FLBuilder._adjustColHeightsForDrag(),FLBuilder._disableGlobalRows(),FLBuilder._disableGlobalCols(),FLBuilder._destroyOverlayEvents(),FLBuilder._removeAllOverlays(),FLBuilder._initSortables(),e("body").addClass("fl-builder-dragging"),e(".fl-builder-empty-message").hide(),e(".fl-sortable-disabled").removeClass("fl-sortable-disabled"),s>0&&scrollTo(0,l.offset().top-s),FLBuilder.triggerHook("didInitDrag")},_blockDragStart:function(i,t){FLBuilder._dragging=!0,e(".fl-node-drag-init").removeClass("fl-node-drag-init"),FLBuilder.triggerHook("didStartDrag")},_blockDragSort:function(i,t){var l=t.placeholder.parent(),n=FLBuilderStrings.insert;FLBuilder._blockPreventSort(t.item,l)||(l.hasClass("fl-col-content")?n=t.item.hasClass("fl-builder-block-row")?t.item.find(".fl-builder-block-title").text():t.item.hasClass("fl-col-sortable-proxy-item")?FLBuilderStrings.column:t.item.hasClass("fl-builder-block-module")?t.item.find(".fl-builder-block-title").text():t.item.hasClass("fl-builder-block-saved-module")||t.item.hasClass("fl-builder-block-module-template")?t.item.find(".fl-builder-block-title").text():t.item.attr("data-name"):l.hasClass("fl-col-drop-target")?n="":l.hasClass("fl-col-group-drop-target")?n="":l.hasClass("fl-row-drop-target")&&(n=t.item.hasClass("fl-builder-block-row")?t.item.find(".fl-builder-block-title").text():t.item.hasClass("fl-builder-block-saved-row")?t.item.find(".fl-builder-block-title").text():t.item.hasClass("fl-builder-block-saved-column")?t.item.find(".fl-builder-block-title").text():t.item.hasClass("fl-row-sortable-proxy-item")?FLBuilderStrings.row:FLBuilderStrings.newRow),t.placeholder.html(n),t.item.hasClass("fl-node-global")||t.item.hasClass("fl-builder-block-global")||e(".fl-node-dragging").hasClass("fl-node-global")?t.placeholder.addClass("fl-builder-drop-zone-global"):t.placeholder.removeClass("fl-builder-drop-zone-global"))},_blockDragChange:function(e,i){i.placeholder.css("opacity","0"),i.placeholder.animate({opacity:"1"},100)},_blockPreventSort:function(i,t){var l=!1,n=i.hasClass("fl-builder-block-row"),s=i.hasClass("fl-col-sortable-proxy-item"),o=t.hasClass("fl-col-content"),r=t.hasClass("fl-col-drop-target"),a=t.parents(".fl-col-group:not(.fl-col-group-nested)"),d=t.parents(".fl-col-group-nested");return(n||s)&&o&&d.length>0&&(l=!0),o&&!t.find(".fl-module, .fl-col").length&&(n&&"1-col"==i.data("cols")?l=!0:s&&(l=!0)),n&&o&&e.inArray(i.data("cols"),["5-cols","6-cols"])>-1&&(l=!0),s&&e(".fl-node-dragging").find(".fl-col-group-nested").length>0&&(o||r&&d.length>0)&&(l=!0),r&&a.length>0&&0===d.length&&a.find("> .fl-col:visible").length>11&&(l=!0),r&&d.length>0&&d.find(".fl-col:visible").length>3&&(l=!0),l&&t.addClass("fl-sortable-disabled"),l},_blockDragStop:function(i,t){var l=e(window).scrollTop(),n=t.item.parent(),s=null;n.hasClass("fl-drop-target")&&n.closest("[data-node]").length?(n=n.closest("[data-node]"),s=n.offset().top-l):s=n.offset().top-l,n.hasClass("fl-builder-blocks-section-content")&&FLBuilder._showPanel(),FLBuilder._dragEnabled=!1,FLBuilder._dragging=!1,FLBuilder._bindOverlayEvents(),FLBuilder._removeEmptyRowAndColHighlights(),FLBuilder._highlightEmptyCols(),FLBuilder._enableGlobalRows(),FLBuilder._enableGlobalCols(),FLBuilder._setupEmptyLayout(),e("body").removeClass("fl-builder-dragging"),scrollTo(0,n.offset().top-s),FLBuilder.triggerHook("didStopDrag")},_blockDragCancel:function(){FLBuilder._dragEnabled&&!FLBuilder._dragging&&(FLBuilder._dragEnabled=!1,FLBuilder._dragging=!1,FLBuilder._bindOverlayEvents(),FLBuilder._removeEmptyRowAndColHighlights(),FLBuilder._highlightEmptyCols(),FLBuilder._enableGlobalRows(),FLBuilder._setupEmptyLayout(),e("body").removeClass("fl-builder-dragging"),e(".fl-node-drag-init").removeClass("fl-node-drag-init"),e(".fl-node-dragging").removeClass("fl-node-dragging"),scrollTo(0,FLBuilder._dragInitialScrollTop))},_reorderNode:function(e,i){FLBuilder.ajax({action:"reorder_node",node_id:e,position:i})},_moveNode:function(e,i,t){FLBuilder.ajax({action:"move_node",new_parent:e,node_id:i,position:t})},_removeAllOverlays:function(){FLBuilder._removeRowOverlays(),FLBuilder._removeColOverlays(),FLBuilder._removeColHighlightGuides(),FLBuilder._removeModuleOverlays(),FLBuilder._hideTipTips(),FLBuilder._closeAllSubmenus()},_appendOverlay:function(e,i){var t=0,l=null,n=e.hasClass("fl-row"),s=n?e.find("> .fl-row-content-wrap"):e.find("> .fl-node-content"),o={top:parseInt(s.css("margin-top"),10),bottom:parseInt(s.css("margin-bottom"),10)};return e.append(i),e.addClass("fl-block-overlay-active"),FLBuilder._initTipTips(),l=e.find("> .fl-block-overlay"),o.top<0&&(t=parseInt(l.css("top"),10),t=isNaN(t)?0:t,l.css("top",o.top+t+"px")),o.bottom<0&&(t=parseInt(l.css("bottom"),10),t=isNaN(t)?0:t,l.css("bottom",o.bottom+t+"px")),l},_buildOverlayOverflowMenu:function(e){var i=e.find(".fl-block-overlay-header"),t=e.find(".fl-block-overlay-actions"),l=e.find(".fl-block-has-rules"),n=t.data("original"),s=0,o=null,r=0,a=null,d=0,u=[],c=[],f=[],h=wp.template("fl-overlay-overflow-menu");for(void 0!=n&&(t.after(n),t.remove(),t=n),t.data("original",t.clone()),s=Math.floor(t[0].getBoundingClientRect().width)-8,o=t.find(" > i, > span.fl-builder-has-submenu"),l.length&&s+l.outerWidth()>i.outerWidth()&&(r+=l.outerWidth());d<o.length;d++)a=o.eq(d),r+=Math.floor(a[0].getBoundingClientRect().width),r>s?(c.push(a),a.remove()):u.push(a);if(c.length>0){for(u.length>0&&c.unshift(u.pop().remove()),d=0;d<c.length;d++)c[d].is(".fl-builder-has-submenu")?f.push({type:"submenu",label:c[d].find(".fa, .fas, .far").data("title"),submenu:c[d].find(".fl-builder-submenu")[0].outerHTML}):f.push({type:"action",label:c[d].data("title"),className:c[d].removeClass(function(e,i){return i.replace(/fl-block-([^\s]+)/,"")}).attr("class")});t.append(h(f)),FLBuilder._initTipTips()}},_removeRowOverlays:function(){e(".fl-row").removeClass("fl-block-overlay-active"),e(".fl-row-overlay").remove(),e(".fl-module").removeClass("fl-module-adjust-height"),e("body").removeClass("fl-builder-row-resizing"),FLBuilder._closeAllSubmenus()},_disableGlobalRows:function(){"row"!=FLBuilderConfig.userTemplateType&&e(".fl-row.fl-node-global").addClass("fl-node-disabled")},_disableGlobalCols:function(){"column"!=FLBuilderConfig.userTemplateType&&e(".fl-row:not(.fl-node-global) .fl-col.fl-node-global").addClass("fl-node-disabled")},_enableGlobalRows:function(){"row"!=FLBuilderConfig.userTemplateType&&e(".fl-node-disabled").removeClass("fl-node-disabled")},_enableGlobalCols:function(){"column"!=FLBuilderConfig.userTemplateType&&e(".fl-node-disabled").removeClass("fl-node-disabled")},_rowMouseenter:function(){var i=e(this),t=i.offset().top,l=null,n=null,s=wp.template("fl-row-overlay"),o=FLBuilderResponsiveEditing._mode;i.closest(".fl-builder-node-loading").length||i.hasClass("fl-block-overlay-active")||(n=FLBuilder._appendOverlay(i,s({node:i.attr("data-node"),global:i.hasClass("fl-node-global"),hasRules:i.hasClass("fl-node-has-rules")})),i.find(".fl-node-content:visible").each(function(){var i=e(this).offset().top;l=null===l||l>i?i:l}),null!==l&&l<t&&n.css("top",l-t-30+"px"),("default"===o&&n.offset().top<43||"default"!==o&&0===i.index())&&n.addClass("fl-row-overlay-header-bottom"),i.find(".fl-module").each(function(){var i=e(this);i.outerHeight(!0)<20&&i.addClass("fl-module-adjust-height")}),FLBuilder._buildOverlayOverflowMenu(n))},_rowMouseleave:function(i){var t=e(i.toElement)||e(i.relatedTarget),l=t.hasClass("fl-row-overlay"),n=t.closest(".fl-row-overlay").length>0,s=t.is("#tiptip_holder"),o=t.closest("#tiptip_holder").length>0;l||n||s||o||FLBuilder._removeRowOverlays()},_rowDragHelper:function(){return e('<div class="fl-builder-block-drag-helper">'+FLBuilderStrings.row+"</div>")},_rowDragInit:function(i){var t=e(i.target),l=e(".fl-row-sortable-proxy-item"),n=t.closest(".fl-row");n.addClass("fl-node-dragging"),FLBuilder._blockDragInit(i),i.target=l[0],l.trigger(i)},_rowDragStart:function(i,t){var l=e(FLBuilder._contentClass+" .fl-row"),n=e(".fl-node-dragging");1===l.length&&e(FLBuilder._contentClass).addClass("fl-builder-empty"),n.hide(),FLBuilder._blockDragStart(i,t)},_rowDragStop:function(i,t){var l=t.item,n=l.parent(),s=null,o=null,r=0;if(FLBuilder._blockDragStop(i,t),n.hasClass("fl-builder-rows"))return void l.remove();if(n.hasClass("fl-row-sortable-proxy"))return void e(".fl-node-dragging").removeClass("fl-node-dragging").show();if(l.hasClass("fl-builder-block")){if(n.hasClass("fl-sortable-disabled"))return l.remove(),void FLBuilder._showPanel();n.hasClass("fl-col-content")?FLBuilder._addColGroup(l.closest(".fl-col").attr("data-node"),l.attr("data-cols"),n.find("> .fl-module, .fl-col-group, .fl-builder-block").index(l)):n.hasClass("fl-col-drop-target")?FLBuilder._addCols(n.closest(".fl-col"),n.hasClass("fl-col-drop-target-last")?"after":"before",l.attr("data-cols"),n.closest(".fl-col-group-nested").length>0):n.hasClass("fl-col-group-drop-target")?(o=l.closest(".fl-col-group"),r=l.closest(".fl-row").find(".fl-row-content > .fl-col-group").index(o),FLBuilder._addColGroup(l.closest(".fl-row").attr("data-node"),l.attr("data-cols"),n.hasClass("fl-drop-target-last")?r+1:r)):(s=l.closest(".fl-row"),r=s.length?e(FLBuilder._contentClass+" > .fl-row").index(s):0,FLBuilder._addRow(l.attr("data-cols"),n.hasClass("fl-drop-target-last")?r+1:r)),l.remove(),FLBuilder._showPanel(),e(".fl-builder-modules").siblings(".fl-builder-blocks-section-title").eq(0).trigger("click")}else s=e(".fl-node-dragging").removeClass("fl-node-dragging").show(),n.parent().hasClass("fl-builder-content")||(n.hasClass("fl-drop-target-last")?n.parent().after(s):n.parent().before(s),FLBuilder._reorderNode(s.attr("data-node"),s.index())),e(".fl-row-sortable-proxy").append(t.item)},_addRow:function(i,t,l){FLBuilder._showNodeLoadingPlaceholder(e(FLBuilder._contentClass),t),FLBuilder._newRowPosition=t,FLBuilder.ajax({action:"render_new_row",cols:i,position:t,module:l},FLBuilder._addRowComplete)},_addRowComplete:function(i){var t="object"==typeof i?i:FLBuilder._jsonParse(i),l=e(FLBuilder._contentClass),n=e(t.html).data("node");t.nodeParent=l,t.nodePosition=FLBuilder._newRowPosition,FLBuilder._renderLayout(t,function(){FLBuilder._removeNodeLoadingPlaceholder(e(".fl-node-"+n)),FLBuilder.triggerHook("didAddRow",n)})},_deleteRowClicked:function(i){var t=e(this).closest(".fl-row"),l=null;t.find(".fl-module").length?(l=confirm(FLBuilderStrings.deleteRowMessage),l&&FLBuilder._deleteRow(t)):FLBuilder._deleteRow(t),FLBuilder._removeAllOverlays(),i.stopPropagation()},_deleteRow:function(e){var i=e.attr("data-node");FLBuilder.ajax({action:"delete_node",node_id:i}),e.empty(),e.remove(),FLBuilder._setupEmptyLayout(),FLBuilder._removeRowOverlays(),FLBuilder.triggerHook("didDeleteRow",i)},_rowCopyClicked:function(i){var t=e(window),l=e(this).closest(".fl-row"),n=l.attr("data-node"),s=l.clone(),o=e(".fl-builder-settings[data-node]"),r=o.attr("data-node"),a=r===n?l:l.find('[data-node="'+r+'"]'),d=null;o.length&&a.length&&(d=FLBuilder._getSettings(o),FLBuilderSettingsConfig.nodes[r]=d),s.addClass("fl-node-"+n+"-clone fl-builder-node-clone"),s.find(".fl-block-overlay").remove(),l.after(s),FLBuilder._showNodeLoading(n+"-clone"),t.scrollTop()+t.height()<s.offset().top&&e("html, body").animate({scrollTop:s.offset().top+s.height()-t.height()},500),FLBuilder.ajax({action:"copy_row",node_id:n,settings:d,settings_id:r},function(i){var t=FLBuilder._jsonParse(i);t.nodeParent=e(FLBuilder._contentClass),t.nodePosition=e(FLBuilder._contentClass+" > .fl-row").index(s),t.duplicatedRow=n,t.onAddNewHTML=function(){s.remove()},FLBuilder._rowCopyComplete(t)}),i.stopPropagation()},_rowCopyComplete:function(e){FLBuilder._renderLayout(e,function(){FLBuilder.triggerHook("didDuplicateRow",{newNodeId:e.nodeId,oldNodeId:e.duplicatedRow})})},_rowSettingsClicked:function(i){var t=e(this),l=t.closest(".fl-row").attr("data-node"),n=t.closest(".fl-block-overlay-global").length>0,s=null;n&&"row"!=FLBuilderConfig.userTemplateType?FLBuilderConfig.userCanEditGlobalTemplates&&(s=window.open(e('.fl-row[data-node="'+l+'"]').attr("data-template-url")),s.FLBuilderGlobalNodeId=l):t.hasClass("fl-block-settings")&&FLBuilderSettingsForms.render({id:"row",nodeId:l,className:"fl-builder-row-settings",attrs:'data-node="'+l+'"',buttons:n||FLBuilderConfig.lite||FLBuilderConfig.simpleUi?[]:["save-as"],badges:n?[FLBuilderStrings.global]:[],settings:FLBuilderSettingsConfig.nodes[l],preview:{type:"row"}},function(){e("#fl-field-width select").on("change",FLBuilder._rowWidthChanged),e("#fl-field-content_width select").on("change",FLBuilder._rowWidthChanged)}),i.stopPropagation()},_rowWidthChanged:function(){var i=e("#fl-field-width select").val(),t=e("#fl-field-content_width select").val(),l=e("#fl-field-max_content_width");"fixed"==i||"full"==i&&"fixed"==t?l.show():l.hide()},_resetRowWidthClicked:function(i){var t=e(this),l=t.closest(".fl-row"),n=l.attr("data-node"),s=l.find(".fl-row-content"),o=FLBuilderConfig.global.row_width+"px",r=e(".fl-builder-row-settings");l.hasClass("fl-row-fixed-width")&&l.css("max-width",o),s.css("max-width",o),r.length&&r.find("[name=max_content_width]").val(""),FLBuilder.ajax({action:"resize_row_content",node:n,width:""}),FLBuilder._closeAllSubmenus(),FLBuilder.triggerHook("didResetRowWidth",n),i.stopPropagation()},_highlightEmptyCols:function(){var i="row"==FLBuilderConfig.userTemplateType||"column"==FLBuilderConfig.userTemplateType?"":":not(.fl-node-global)",t=(e(FLBuilder._contentClass+" .fl-row"+i),e(FLBuilder._contentClass+" .fl-col"+i));t.removeClass("fl-col-highlight").find(".fl-col-content").css("height",""),t.each(function(){var i=e(this);0===i.find(".fl-module, .fl-col").length&&i.addClass("fl-col-highlight")})},_highlightRowsAndColsForDrag:function(i){var t="row"==FLBuilderConfig.userTemplateType?"":":not(.fl-node-global)";"column"==FLBuilderConfig.userTemplateType&&(t=":not(:first)"),e(FLBuilder._contentClass+" .fl-row").addClass("fl-row-highlight"),i&&i.closest(".fl-row-overlay").length||e(FLBuilder._contentClass+" .fl-col"+t).addClass("fl-col-highlight")},_removeEmptyRowAndColHighlights:function(){e(".fl-row-highlight").removeClass("fl-row-highlight"),e(".fl-col-highlight").removeClass("fl-col-highlight")},_adjustColHeightsForDrag:function(){var i="row"==FLBuilderConfig.userTemplateType?"":".fl-row:not(.fl-node-global) ",t="column"==FLBuilderConfig.userTemplateType?"":".fl-col:not(.fl-node-global) ",l=e(FLBuilder._contentClass),n=l.find(i+".fl-col-group:not(.fl-col-group-nested) > "+t+"> .fl-col-content"),s=l.find(i+".fl-col-group-nested "+t+".fl-col-content"),o=0;for(e(".fl-node-drag-init").hide();o<s.length;o++)FLBuilder._adjustColHeightForDrag(s.eq(o));for(o=0;o<n.length;o++)FLBuilder._adjustColHeightForDrag(n.eq(o));e(".fl-node-drag-init").show()},_adjustColHeightForDrag:function(e){e.find(".fl-module:visible, .fl-col:visible").length&&e.height(e.height()+45)},_showColHighlightGuide:function(){var i=e(this),t=i.find("a"),l=i.closest(".fl-col"),n=l.parents(".fl-col"),s=e('<div class="fl-col-highlight-guide"></div>'),o=null,r=i.closest(".fl-block-overlay").offset().top;(t.hasClass("fl-block-col-move-parent")||t.hasClass("fl-block-col-edit-parent"))&&(l=n),l.hasClass("fl-col-highlight")||(l.find("> .fl-col-content").append(s),l.addClass("fl-col-has-highlight-guide"),o=s.offset().top,o>r&&s.css("top",r-o+4+"px"))},_removeColHighlightGuides:function(){e(".fl-col-has-highlight-guide").removeClass("fl-col-has-highlight-guide"),e(".fl-col-highlight-guide").remove()},_colMouseenter:function(){var i=e(this),t=i.closest(".fl-col-group"),l=t.hasClass("fl-col-group-has-child-loading"),n=i.hasClass("fl-node-global"),s=i.parents(".fl-node-global").length>0,o=i.closest(".fl-col-group").find("> .fl-col").length,r=t.find("> .fl-col").index(i),a=0===r,d=o===r+1,u=i.find(".fl-col").length>0,c=i.find(".fl-module").length>0,f=i.parents(".fl-col"),h=f.closest(".fl-col-group"),g=f.length>0,p="undefined"!=typeof i.data("template-url"),b="column"==FLBuilderConfig.userTemplateType&&!g;numParentCols=g?h.find("> .fl-col").length:0,parentIndex=h.find("> .fl-col").index(f),parentFirst=!!g&&0===parentIndex,parentLast=!!g&&numParentCols===parentIndex+1,row=i.closest(".fl-row"),rowIsFixedWidth=!!row.find(".fl-row-fixed-width").addBack(".fl-row-fixed-width").length,userCanResizeRows=FLBuilderConfig.rowResize.userCanResizeRows,hasRules=i.hasClass("fl-node-has-rules"),template=wp.template("fl-col-overlay"),overlay=null,FLBuilderConfig.simpleUi&&!n||n&&s&&c&&!p||n&&"column"==FLBuilderConfig.userTemplateType&&c||!n&&i.find(".fl-module").length>0||i.find(".fl-builder-node-loading-placeholder").length>0||!c&&u||s&&u&&!p||i.closest(".fl-builder-node-loading").length||(i.hasClass("fl-block-overlay-active")||(FLBuilder._removeColOverlays(),FLBuilder._removeModuleOverlays(),overlay=FLBuilder._appendOverlay(i,template({global:n,groupLoading:l,numCols:o,first:a,last:d,isRootCol:b,hasChildCols:u,hasParentCol:g,parentFirst:parentFirst,parentLast:parentLast,numParentCols:numParentCols,rowIsFixedWidth:rowIsFixedWidth,userCanResizeRows:userCanResizeRows,hasRules:hasRules})),FLBuilder._buildOverlayOverflowMenu(overlay),FLBuilder._initColDragResizing()),e("body").addClass("fl-block-overlay-muted"))},_colMouseleave:function(i){var t=e(this),l=e(i.toElement)||e(i.relatedTarget),n=t.find(".fl-module").length>0,s=(t.hasClass("fl-node-global"),"undefined"!=typeof t.data("template-url")),o=l.is("#tiptip_holder"),r=l.closest("#tiptip_holder").length>0;o||r||n&&!s||(FLBuilder._removeColOverlays(),FLBuilder._removeColHighlightGuides(),FLBuilder._closeAllSubmenus())},_removeColOverlays:function(){var i=e(".fl-col");i.removeClass("fl-block-overlay-active"),i.find(".fl-col-overlay").remove(),e("body").removeClass("fl-block-overlay-muted"),FLBuilder._closeAllSubmenus()},_colDragHelper:function(){return e('<div class="fl-builder-block-drag-helper">'+FLBuilderStrings.column+"</div>")},_colDragInit:function(i){var t=e(i.target),l=e(".fl-col-sortable-proxy-item"),n=t.closest(".fl-col");t.hasClass("fl-block-col-move-parent")&&(n=n.parents(".fl-col")),n.addClass("fl-node-dragging"),FLBuilder._blockDragInit(i),FLBuilder._removeColHighlightGuides(),i.target=l[0],l.trigger(i)},_colDragStart:function(i,t){var l=e(".fl-node-dragging");l.hide(),FLBuilder._resetColumnWidths(l.parent()),FLBuilder._blockDragStart(i,t)},_colDragStop:function(i,t){FLBuilder._blockDragStop(i,t);var l=e(".fl-node-dragging").removeClass("fl-node-dragging").show(),n=l.attr("data-node"),s=t.item.parent(),o=l.parent(),r=o.attr("data-node");newGroup=s.closest(".fl-col-group"),newGroupId=newGroup.attr("data-node"),newRow=s.closest(".fl-row"),position=0,s.closest('[data-node="'+n+'"]').length?FLBuilder._resetColumnWidths(o):s.hasClass("fl-sortable-disabled")?FLBuilder._resetColumnWidths(o):s.hasClass("fl-col-sortable-proxy")?FLBuilder._resetColumnWidths(o):s.hasClass("fl-col-content")?(l.remove(),0===o.find(".fl-col").length&&o.remove(),position=s.find("> .fl-module, .fl-col-group, .fl-col-sortable-proxy-item").index(t.item),FLBuilder._addColGroup(s.closest(".fl-col").attr("data-node"),n,position)):s.hasClass("fl-col-drop-target")?(s.hasClass("fl-col-drop-target-last")?s.parent().after(l):s.parent().before(l),FLBuilder._resetColumnWidths(newGroup),r==newGroupId?FLBuilder.ajax({action:"reorder_col",node_id:n,position:l.index()}):FLBuilder.ajax({action:"move_col",node_id:n,new_parent:newGroupId,position:l.index(),resize:[r,newGroupId]}),FLBuilder._resizeLayout()):s.hasClass("fl-col-group-drop-target")?(l.remove(),0===o.find(".fl-col").length&&o.remove(),position=newRow.find(".fl-row-content > .fl-col-group").index(newGroup),position=s.hasClass("fl-drop-target-last")?position+1:position,FLBuilder._addColGroup(newRow.attr("data-node"),n,position)):s.hasClass("fl-row-drop-target")&&(l.remove(),position=s.closest(".fl-builder-content").find(".fl-row").index(newRow),position=s.hasClass("fl-drop-target-last")?position+1:position,FLBuilder._addRow(n,position)),0===o.find(".fl-col").length&&o.remove(),e(".fl-col-sortable-proxy").append(t.item),FLBuilder._highlightEmptyCols(),FLBuilder._initDropTargets(),FLBuilder._initSortables(),FLBuilder._closeAllSubmenus()},_colSettingsClicked:function(i){var t=e(this),l=t.closest(".fl-col"),n=(l.find("> .fl-col-content"),t.parent().find("ul.fl-builder-submenu").length>0),s=t.closest(".fl-block-overlay-global").length>0,o=t.closest(".fl-block-overlay-global").hasClass("fl-col-overlay"),r="column"!=FLBuilderConfig.userTemplateType&&"undefined"!=typeof l.attr("data-template-url"),a=null;FLBuilder._colResizing||s&&!FLBuilderConfig.userCanEditGlobalTemplates||n&&!t.hasClass("fl-col-overlay")||(t.hasClass("fl-block-col-edit-parent")&&(l=l.parents(".fl-col")),a=l.attr("data-node"),s&&o&&r?FLBuilderConfig.userCanEditGlobalTemplates&&(win=window.open(e('.fl-col[data-node="'+a+'"]').attr("data-template-url")),win.FLBuilderGlobalNodeId=a):FLBuilderSettingsForms.render({id:"col",nodeId:a,className:"fl-builder-col-settings",attrs:'data-node="'+a+'"',buttons:s||FLBuilderConfig.lite||FLBuilderConfig.simpleUi?[]:["save-as"],badges:s?[FLBuilderStrings.global]:[],settings:FLBuilderSettingsConfig.nodes[a],preview:{type:"col"}},function(){0===l.siblings(".fl-col").length&&e("#fl-field-size, #fl-field-equal_height, #fl-field-content_alignment").hide()}),i.stopPropagation())},_copyColClicked:function(i){var t=e(this).closest(".fl-col"),l=t.attr("data-node"),n=t.clone(),s=t.parent(),o=e(".fl-builder-settings[data-node]"),r=o.attr("data-node"),a=r===l?t:t.find('[data-node="'+r+'"]'),d=null;o.length&&a.length&&(d=FLBuilder._getSettings(o),FLBuilderSettingsConfig.nodes[r]=d),n.addClass("fl-node-"+l+"-clone fl-builder-node-clone"),n.find(".fl-block-overlay").remove(),t.after(n),FLBuilder._showNodeLoading(l+"-clone"),FLBuilder._resetColumnWidths(s),FLBuilder.ajax({action:"copy_col",node_id:l,settings:d,settings_id:r},function(e){var i=FLBuilder._jsonParse(e);i.nodeParent=s,i.nodePosition=n.index(),i.duplicatedColumn=l,i.onAddNewHTML=function(){n.remove()},FLBuilder._copyColComplete(i)}),i.stopPropagation()},_copyColComplete:function(e){FLBuilder._renderLayout(e,function(){FLBuilder._resetColumnWidths(e.nodeParent),FLBuilder.triggerHook("didDuplicateColumn",{newNodeId:e.nodeId,oldNodeId:e.duplicatedColumn})})},_deleteColClicked:function(i){var t=e(this),l=t.closest(".fl-col"),n=l.closest(".fl-col-group"),s=l.parents(".fl-col"),o=s.length>0,r=s.find("> .fl-col-content > .fl-module, > .fl-col-content > .fl-col-group"),a=l.siblings(".fl-col"),d=!0;l.find(".fl-module").length>0&&(d=confirm(FLBuilderStrings.deleteColumnMessage)),o&&1===r.length&&(0===a.length?l=s:1!==a.length||a.find(".fl-module").length||(l=n)),d&&(FLBuilder._deleteCol(l),FLBuilder._removeAllOverlays(),FLBuilder._highlightEmptyCols(),FLBuilder._resizeLayout()),i.stopPropagation()},_deleteCol:function(e){var i=e.attr("data-node"),t=e.closest(".fl-row"),l=e.closest(".fl-col-group"),n=0;e.remove(),rowCols=t.find(".fl-row-content > .fl-col-group > .fl-col"),groupCols=l.find(" > .fl-col"),0===rowCols.length&&"row"!=FLBuilderConfig.userTemplateType&&"column"!=FLBuilderConfig.userTemplateType?FLBuilder._deleteRow(t):(0===groupCols.length?l.remove():(n=6===groupCols.length?16.65:7===groupCols.length?14.28:Math.round(100/groupCols.length*100)/100,groupCols.css("width",n+"%"),FLBuilder.triggerHook("didResetColumnWidths",{cols:groupCols})),FLBuilder.ajax({action:"delete_col",node_id:i,new_width:n}),FLBuilder._initDropTargets(),FLBuilder._initSortables(),FLBuilder.triggerHook("didDeleteColumn",i))},_addCols:function(e,i,t,l,n){var s=e.closest(".fl-col-group"),o=s.find(".fl-col").index(e);t="undefined"==typeof t?"1-col":t,l="undefined"!=typeof l&&l,"after"==i&&o++,FLBuilder._showNodeLoadingPlaceholder(s,o),FLBuilder._removeAllOverlays(),FLBuilder.ajax({action:"render_new_columns",node_id:e.attr("data-node"),insert:i,type:t,nested:l?1:0,module:n},FLBuilder._addColsComplete)},_addColsComplete:function(i){var t="object"==typeof i?i:FLBuilder._jsonParse(i);t.nodeParent=FLBuilder._newColParent,t.nodePosition=FLBuilder._newColPosition,FLBuilder._renderLayout(t,function(){FLBuilder._removeNodeLoadingPlaceholder(e(".fl-node-"+t.nodeId)),FLBuilder.triggerHook("didAddColumn",t.nodeId),FLBuilder.triggerHook("didResetColumnWidths",{cols:e(".fl-node-"+t.nodeId).find("> .fl-col")})})},_addColGroup:function(i,t,l,n){var s=e(".fl-node-"+i);FLBuilder._newColGroupPosition=l,s.hasClass("fl-col")?FLBuilder._newColGroupParent=s.find(" > .fl-col-content"):FLBuilder._newColGroupParent=s.find(".fl-row-content"),
FLBuilder._showNodeLoadingPlaceholder(FLBuilder._newColGroupParent,l),FLBuilder.ajax({action:"render_new_column_group",cols:t,node_id:i,position:l,module:n},FLBuilder._addColGroupComplete)},_addColGroupComplete:function(i){var t=FLBuilder._jsonParse(i),l=e(t.html),n=l.data("node");l.find(".fl-col").data("node");t.nodeParent=FLBuilder._newColGroupParent,t.nodePosition=FLBuilder._newColGroupPosition,FLBuilder._renderLayout(t,function(){t.nodeParent.hasClass("fl-col-content")&&t.nodeParent.parents(".fl-col").addClass("fl-col-has-cols"),FLBuilder._removeNodeLoadingPlaceholder(e(".fl-node-"+n)),FLBuilder.triggerHook("didAddColumnGroup",n)})},_initColDragResizing:function(){e(".fl-block-col-resize").not(".fl-block-row-resize").draggable({axis:"x",start:FLBuilder._colDragResizeStart,drag:FLBuilder._colDragResize,stop:FLBuilder._colDragResizeStop})},_colDragResizeStart:function(i,t){var l=e(t.helper),n="",s=l.hasClass("fl-block-col-resize-parent"),o=s?l.closest(".fl-col").parents(".fl-col"):null,r=s?o.parents(".fl-col-group"):l.closest(".fl-col-group"),a=r.find("> .fl-col"),d=s?o:l.closest(".fl-col"),u=d.attr("data-node"),c=e("[data-node="+u+"] #fl-field-size input"),f=null,h=null,g=null,p=100,b=0,v=null,m=null;for(l.hasClass("fl-block-col-resize-e")?(n="e",f=d.nextAll(".fl-col").first()):(n="w",f=d.prevAll(".fl-col").first()),h=f.attr("data-node"),g=e("[data-node="+h+"] #fl-field-size input");b<a.length;b++)a.eq(b).data("node")!=d.data("node")&&a.eq(b).data("node")!=f.data("node")&&(p-=parseFloat(a.eq(b)[0].style.width));c.length?(v=c,m="col"):g.length&&(v=g,m="sibling"),FLBuilder._colResizeData={handle:l,feedbackLeft:l.find(".fl-block-col-resize-feedback-left"),feedbackRight:l.find(".fl-block-col-resize-feedback-right"),direction:n,groupWidth:r.outerWidth(),col:d,colWidth:parseFloat(d[0].style.width)/100,sibling:f,offset:t.position.left,availWidth:p,setting:v,settingType:m},FLBuilder._colResizing=!0,e("body").addClass("fl-builder-col-resizing"),FLBuilder._closePanel(),FLBuilder._destroyOverlayEvents(),FLBuilder.triggerHook("col-resize-start")},_colDragResize:function(e,i){var t=FLBuilder._colResizeData,l=FLBuilderConfig.isRtl?"w":"e",n=t.handle.closest(".fl-block-overlay"),s=(t.offset-i.position.left)/t.groupWidth,o=l==t.direction?100*(t.colWidth-s):100*(t.colWidth+s),r=Math.round(100*o)/100,a=t.availWidth-o,d=Math.round(100*a)/100,u=8,c=Math.round(100*(t.availWidth-u))/100;r<u?(r=u,d=c):d<u&&(r=c,d=u),l==t.direction?(t.feedbackLeft.html(r.toFixed(1)+"%").show(),t.feedbackRight.html(d.toFixed(1)+"%").show()):(t.feedbackLeft.html(d.toFixed(1)+"%").show(),t.feedbackRight.html(r.toFixed(1)+"%").show()),t.col.css("width",r+"%"),t.sibling.css("width",d+"%"),t.setting&&("col"===t.settingType?t.setting.val(parseFloat(t.col[0].style.width)):"sibling"===t.settingType&&t.setting.val(parseFloat(t.sibling[0].style.width))),FLBuilder._buildOverlayOverflowMenu(n),FLBuilder.triggerHook("col-resize-drag")},_colDragResizeStop:function(i,t){var l=FLBuilder._colResizeData,n=FLBuilder._colResizeData.handle.closest(".fl-block-overlay"),s=l.col.data("node"),o=parseFloat(l.col[0].style.width),r=l.sibling.data("node"),a=parseFloat(l.sibling[0].style.width);FLBuilder._colResizeData.feedbackLeft.hide(),FLBuilder._colResizeData.feedbackRight.hide(),FLBuilder.ajax({action:"resize_cols",col_id:s,col_width:o,sibling_id:r,sibling_width:a}),FLBuilder._buildOverlayOverflowMenu(n),FLBuilder._colResizeData=null,e("body").removeClass("fl-builder-col-resizing"),FLBuilder._bindOverlayEvents(),setTimeout(function(){FLBuilder._colResizing=!1},50),FLBuilder.triggerHook("col-resize-stop"),FLBuilder.triggerHook("didResizeColumn",{colId:s,colWidth:o,siblingId:r,siblingWidth:a})},_resetColumnWidthsClicked:function(i){var t=e(this),l=!!t.closest(".fl-row-overlay").length,n=null,s=null,o=[],r=null,a=0,d=e(".fl-builder-col-settings"),u=null;s=l?t.closest(".fl-row").find(".fl-row-content > .fl-col-group"):t.parents(".fl-col-group").last(),s.each(function(){for(n=e(this),r=n.find(".fl-col-group"),o.push(n.data("node")),FLBuilder._resetColumnWidths(n),a=0;a<r.length;a++)FLBuilder._resetColumnWidths(r.eq(a)),o.push(r.eq(a).data("node"))}),d.length&&(u=e(".fl-node-"+d.attr("data-node")),d.find("#fl-field-size input").val(parseFloat(u[0].style.width))),FLBuilder.ajax({action:"reset_col_widths",group_id:o}),FLBuilder.triggerHook("col-reset-widths"),FLBuilder._closeAllSubmenus(),i.stopPropagation()},_resetColumnWidths:function(e){var i=e.find(" > .fl-col:visible"),t=0;t=6===i.length?16.65:7===i.length?14.28:Math.round(100/i.length*100)/100,i.css("width",t+"%"),FLBuilder.triggerHook("didResetColumnWidths",{cols:i})},_moduleMouseenter:function(){var i=e(this),t=i.attr("data-name"),l=i.hasClass("fl-node-global"),n=i.parents(".fl-node-global").length>0,s=i.parents(".fl-col-group").last(),o=s.hasClass("fl-col-group-has-child-loading"),r=i.closest(".fl-col-group").find("> .fl-col").length,a=i.closest(".fl-col"),d=0===a.index(),u=r===a.index()+1,c=a.parents(".fl-col"),f=c.length>0,h=f?c.closest(".fl-col-group").find("> .fl-col").length:0,g=!!f&&0===c.index(),p=!!f&&h===c.index()+1,b="column"==FLBuilderConfig.userTemplateType&&!f,v=i.closest(".fl-row"),m=v.hasClass("fl-node-global"),_=!!v.find(".fl-row-fixed-width").addBack(".fl-row-fixed-width").length,w=FLBuilderConfig.rowResize.userCanResizeRows,L=i.hasClass("fl-node-has-rules"),F=a.hasClass("fl-node-has-rules"),C=wp.template("fl-module-overlay"),y=null;FLBuilder._removeColOverlays(),FLBuilder._removeModuleOverlays(),l&&n&&"row"!=FLBuilderConfig.userTemplateType&&m||l&&n&&"column"!=FLBuilderConfig.userTemplateType&&!m||i.closest(".fl-builder-node-loading").length||i.find(".fl-inline-editor:visible").length||(i.hasClass("fl-block-overlay-active")||(y=FLBuilder._appendOverlay(i,C({global:l,moduleName:t,groupLoading:o,numCols:r,colFirst:d,colLast:u,isRootCol:b,hasParentCol:f,numParentCols:h,parentFirst:g,parentLast:p,rowIsFixedWidth:_,userCanResizeRows:w,hasRules:L,colHasRules:F})),FLBuilder._buildOverlayOverflowMenu(y),FLBuilder._initColDragResizing()),e("body").addClass("fl-block-overlay-muted"))},_moduleMouseleave:function(i){var t=(e(this),e(i.toElement)||e(i.relatedTarget)),l=t.is("#tiptip_holder"),n=t.closest("#tiptip_holder").length>0;l||n||(FLBuilder._removeModuleOverlays(),FLBuilder._removeColHighlightGuides())},_removeModuleOverlays:function(){var i=e(".fl-module");i.removeClass("fl-block-overlay-active"),i.find(".fl-module-overlay").remove(),e("body").removeClass("fl-block-overlay-muted"),FLBuilder._closeAllSubmenus()},_moduleDragHelper:function(i,t){return e('<div class="fl-builder-block-drag-helper">'+t.attr("data-name")+"</div>")},_moduleDragStart:function(i,t){e(t.item).data("original-position",t.item.index()),FLBuilder._blockDragStart(i,t)},_moduleDragStop:function(i,t){FLBuilder._blockDragStop(i,t);var l=t.item,n=l.parent(),s=null,o=0,r=0;if(n.hasClass("fl-builder-modules")||n.hasClass("fl-builder-widgets"))return void l.remove();if(l.hasClass("fl-builder-block")){if(n.hasClass("fl-sortable-disabled"))return l.remove(),void FLBuilder._showPanel();n.hasClass("fl-row-drop-target")?(n=l.closest(".fl-builder-content"),r=0,s=l.closest(".fl-row"),o=n.find(".fl-row").index(s)):n.hasClass("fl-col-group-drop-target")?(n=l.closest(".fl-row-content"),r=n.closest(".fl-row").attr("data-node"),s=l.closest(".fl-col-group"),o=n.find(" > .fl-col-group").index(s)):n.hasClass("fl-col-drop-target")?(n=l.closest(".fl-col-group"),r=n.attr("data-node"),s=l.closest(".fl-col"),o=n.find(" > .fl-col").index(s)):(o=n.find("> .fl-module, .fl-col-group, .fl-builder-block").index(l),r=l.closest(".fl-col").attr("data-node")),l.closest(".fl-drop-target-last").length&&(o+=1),FLBuilder._addModule(n,r,l.attr("data-type"),o,l.attr("data-widget"),l.attr("data-alias")),l.remove()}else{if(n.hasClass("fl-sortable-disabled"))return e(i.target).append(t.item),e(i.target).children().eq(t.item.data("original-position")).before(t.item),void FLBuilder._highlightEmptyCols();n.hasClass("fl-row-drop-target")?(s=l.closest(".fl-row"),o=l.closest(".fl-builder-content").children(".fl-row").index(s),o=l.closest(".fl-drop-target-last").length?o+1:o,FLBuilder._addRow("1-col",o,l.attr("data-node")),l.remove()):n.hasClass("fl-col-group-drop-target")?(s=l.closest(".fl-col-group"),o=l.closest(".fl-row-content ").find(" > .fl-col-group").index(s),o=l.closest(".fl-drop-target-last").length?o+1:o,FLBuilder._addColGroup(l.closest(".fl-row").attr("data-node"),"1-col",o,l.attr("data-node")),l.remove()):n.hasClass("fl-col-drop-target")?(s=l.closest(".fl-col"),o=l.closest(".fl-col-drop-target-last").length?"after":"before",FLBuilder._addCols(s,o,"1-col",l.closest(".fl-col-group-nested").length>0,l.attr("data-node")),l.remove()):FLBuilder._reorderModule(l)}FLBuilder._resizeLayout()},_reorderModule:function(e){var i=e.closest(".fl-col").attr("data-node"),t=e.attr("data-parent"),l=e.attr("data-node"),n=e.index();i==t?FLBuilder._reorderNode(l,n):(e.attr("data-parent",i),FLBuilder._moveNode(i,l,n))},_deleteModuleClicked:function(i){var t=e(this).closest(".fl-module"),l=confirm(FLBuilderStrings.deleteModuleMessage);l&&(FLBuilder._deleteModule(t),FLBuilder._removeAllOverlays()),i.stopPropagation()},_deleteModule:function(e){var i=e.closest(".fl-row"),t=e.attr("data-node");FLBuilder.ajax({action:"delete_node",node_id:t}),e.empty(),e.remove(),i.removeClass("fl-block-overlay-muted"),FLBuilder._highlightEmptyCols(),FLBuilder._removeAllOverlays(),FLBuilder.triggerHook("didDeleteModule",t)},_moduleCopyClicked:function(i){var t=e(window),l=e(this).closest(".fl-module"),n=l.attr("data-node"),s=l.parent(),o=l.clone(),r=e(".fl-builder-module-settings[data-node="+n+"]"),a=null;r.length&&(a=FLBuilder._getSettings(r),FLBuilderSettingsConfig.nodes[n]=a),o.addClass("fl-node-"+n+"-clone fl-builder-node-clone"),o.find(".fl-block-overlay").remove(),l.after(o),FLBuilder._showNodeLoading(n+"-clone"),t.scrollTop()+t.height()<o.offset().top&&e("html, body").animate({scrollTop:o.offset().top+o.height()-t.height()},500),FLBuilder.ajax({action:"copy_module",node_id:n,settings:a},function(e){var i=FLBuilder._jsonParse(e);i.nodeParent=s,i.nodePosition=s.find(" > .fl-col-group, > .fl-module").index(o),i.duplicatedModule=n,i.onAddNewHTML=function(){o.remove()},FLBuilder._moduleCopyComplete(i)}),i.stopPropagation()},_moduleCopyComplete:function(e){FLBuilder._renderLayout(e,function(){FLBuilder.triggerHook("didDuplicateModule",{newNodeId:e.nodeId,oldNodeId:e.duplicatedModule})})},_moduleSettingsClicked:function(i){var t=e(this),l=t.closest(".fl-module").attr("data-type"),n=t.closest(".fl-module").attr("data-node"),s=t.closest(".fl-col").attr("data-node"),o=t.closest(".fl-block-overlay-global").length>0;i.stopPropagation(),FLBuilder._colResizing||o&&!FLBuilderConfig.userCanEditGlobalTemplates||FLBuilder._showModuleSettings({type:l,nodeId:n,parentId:s,global:o})},_showModuleSettings:function(i,t){if(FLBuilderSettingsConfig.modules){var l=FLBuilderSettingsConfig.modules[i.type],n=i.settings?i.settings:FLBuilderSettingsConfig.nodes[i.nodeId],s=e("head");-1===e.inArray(i.type,FLBuilder._loadedModuleAssets)&&(""!==l.assets.css&&s.append(l.assets.css),""!==l.assets.js&&s.append(l.assets.js),FLBuilder._loadedModuleAssets.push(i.type)),FLBuilderSettingsForms.render({type:"module",id:i.type,nodeId:i.nodeId,className:"fl-builder-module-settings fl-builder-"+i.type+"-settings",attrs:'data-node="'+i.nodeId+'" data-parent="'+i.parentId+'" data-type="'+i.type+'"',buttons:i.global||FLBuilderConfig.lite||FLBuilderConfig.simpleUi?[]:["save-as"],badges:i.global?[FLBuilderStrings.global]:[],settings:n,legacy:i.legacy,helper:FLBuilder._moduleHelpers[i.type],rules:FLBuilder._moduleHelpers[i.type]?FLBuilder._moduleHelpers[i.type].rules:null,messages:FLBuilder._moduleHelpers[i.type]?FLBuilder._moduleHelpers[i.type].messages:null,hide:!(FLBuilderConfig.userCanEditGlobalTemplates||!i.global),preview:{type:"module",layout:i.layout,callback:function(){FLBuilder.triggerHook("didAddModule",i.nodeId)}}},t)}},_saveModuleClicked:function(){var i=e(this).closest(".fl-builder-settings"),t=i.attr("data-type"),l=(i.attr("data-node"),FLBuilder._moduleHelpers[t]),n=!0;"undefined"!=typeof l&&(i.find("label.error").remove(),i.validate().hideErrors(),n=i.validate().form(),n&&(n=l.submit())),n?FLBuilder._saveSettings():FLBuilder._toggleSettingsTabErrors()},_addModule:function(e,i,t,l,n,s){FLBuilder._showNodeLoadingPlaceholder(e,l),e.hasClass("fl-col-group")?(FLBuilder._newModuleParent=null,FLBuilder._newModulePosition=0):(FLBuilder._newModuleParent=e,FLBuilder._newModulePosition=l),FLBuilder.ajax({action:"render_new_module",parent_id:i,type:t,position:l,node_preview:1,widget:"undefined"==typeof n?"":n,alias:"undefined"==typeof s?"":s},FLBuilder._addModuleComplete)},_addModuleComplete:function(i){var t=FLBuilder._jsonParse(i);t.layout&&(FLBuilder._newModuleParent&&FLBuilder._newModuleParent.find(".fl-builder-node-loading-placeholder").hide(),t.layout.nodeParent=FLBuilder._newModuleParent,t.layout.nodePosition=FLBuilder._newModulePosition),t.settings||(t.settings=FLBuilderSettingsConfig.defaults.modules[t.type]),e("form.fl-builder-settings").length?t.layout&&FLBuilder._renderLayout(t.layout):FLBuilder._showModuleSettings(t,function(){e(".fl-builder-module-settings").data("new-module","1")})},registerModuleHelper:function(i,t){var l={rules:{},init:function(){},submit:function(){return!0},preview:function(){}};FLBuilder._moduleHelpers[i]=e.extend({},l,t)},_registerModuleHelper:function(e,i){FLBuilder.registerModuleHelper(e,i)},_showNodeTemplateSettings:function(i){var t=e(".fl-builder-settings-lightbox .fl-builder-settings"),l=t.attr("data-node"),n=FLBuilderStrings.saveModule;return t.hasClass("fl-builder-row-settings")?n=FLBuilderStrings.saveRow:t.hasClass("fl-builder-col-settings")&&(n=FLBuilderStrings.saveColumn),!!FLBuilder._triggerSettingsSave(!1,!1,!1)&&void FLBuilderSettingsForms.render({id:"node_template",nodeId:l,title:n,attrs:'data-node="'+l+'"',className:"fl-builder-node-template-settings",rules:{name:{required:!0}}},function(){FLBuilderConfig.userCanEditGlobalTemplates||e("#fl-field-global").hide()})},_saveNodeTemplate:function(){var i=e(".fl-builder-node-template-settings"),t=i.attr("data-node"),l=i.validate().form();l&&(FLBuilder._showNodeLoading(t),FLBuilder.ajax({action:"save_node_template",node_id:t,settings:FLBuilder._getSettings(i)},function(e){FLBuilder._saveNodeTemplateComplete(e),FLBuilder._hideNodeLoading(t)}),FLBuilder._lightbox.close())},_saveNodeTemplateComplete:function(i){var t=FLBuilder._jsonParse(i),l=e(".fl-builder-saved-"+t.type+"s"),n=l.find(".fl-builder-block"),s=null,o="",r=t.name.toLowerCase(),a=0,d=wp.template("fl-node-template-block"),u={name:t.name,isGlobal:t.global,content:t.type,id:t.id,postID:t.postID,kind:"template",type:"user",link:t.link,category:{uncategorized:FLBuilderStrings.uncategorized}};if(FLBuilderConfig.contentItems.template.push(u),FLBuilder.triggerHook("contentItemsChanged"),t.layout&&(FLBuilder._renderLayout(t.layout),FLBuilder.triggerHook("didSaveGlobalNodeTemplate",t.config)),0===n.length)l.append(d(t));else for(;a<n.length;a++){if(s=n.eq(a),o=s.text().toLowerCase().trim(),0===a&&r<o){l.prepend(d(t));break}if(r<o){s.before(d(t));break}if(n.length-1===a){l.append(d(t));break}}l.find(".fl-builder-block-no-node-templates").remove()},_nodeTemplateDragStop:function(i,t){FLBuilder._blockDragStop(i,t);var l=t.item,n=l.parent(),s=null,o=0,r=null,a="",d=null;if(n.hasClass("fl-builder-blocks-section-content"))return void l.remove();if(l.hasClass("fl-builder-block-saved-row")||l.hasClass("fl-builder-block-row-template"))r=l.closest(".fl-row"),o=r.length?e(FLBuilder._contentClass+" .fl-row").index(r):0,o=n.hasClass("fl-drop-target-last")?o+1:o,s=null,a="render_new_row_template",d=FLBuilder._addRowComplete,FLBuilder._newRowPosition=o,FLBuilder._showNodeLoadingPlaceholder(e(FLBuilder._contentClass),o);else if(l.hasClass("fl-builder-block-saved-column")){if(r=l.closest(".fl-col"),colGroup=n.closest(".fl-col-group"),colGroupId=colGroup.attr("data-node"),a="render_new_col_template",d=FLBuilder._addColsComplete,n.hasClass("fl-sortable-disabled"))return l.remove(),void FLBuilder._showPanel();n.hasClass("fl-row-drop-target")?(r=l.closest(".fl-row"),s=0,n=e(FLBuilder._contentClass),o=r.length?n.find(".fl-row").index(r):0):n.hasClass("fl-col-group-drop-target")?(n=l.closest(".fl-row-content"),s=l.closest(".fl-row").attr("data-node"),o=l.closest(".fl-row").find(".fl-row-content > .fl-col-group").index(l.closest(".fl-col-group"))):n.hasClass("fl-col-drop-target")&&(n=l.closest(".fl-col-group"),o=n.children(".fl-col").index(l.closest(".fl-col")),s=n.attr("data-node")),l.closest(".fl-drop-target-last").length&&(o+=1),n.hasClass("fl-col-group")?FLBuilder._newColParent=null:FLBuilder._newColParent=n,FLBuilder._newColPosition=o,FLBuilder._showNodeLoadingPlaceholder(n,o)}else if(l.hasClass("fl-builder-block-saved-module")||l.hasClass("fl-builder-block-module-template")){if(a="render_new_module",d=FLBuilder._addModuleComplete,n.hasClass("fl-sortable-disabled"))return l.remove(),void FLBuilder._showPanel();n.hasClass("fl-row-drop-target")?(n=l.closest(".fl-builder-content"),s=0,o=n.find(".fl-row").index(l.closest(".fl-row"))):n.hasClass("fl-col-group-drop-target")?(n=l.closest(".fl-row-content"),s=n.closest(".fl-row").attr("data-node"),o=n.find(" > .fl-col-group").index(l.closest(".fl-col-group"))):n.hasClass("fl-col-drop-target")?(n=l.closest(".fl-col-group"),o=n.children(".fl-col").index(l.closest(".fl-col")),s=n.attr("data-node")):(o=n.children(".fl-module, .fl-builder-block").index(l),s=l.closest(".fl-col").attr("data-node")),l.closest(".fl-drop-target-last").length&&(o+=1),n.hasClass("fl-col-group")?(FLBuilder._newModuleParent=null,FLBuilder._newModulePosition=0):(FLBuilder._newModuleParent=n,FLBuilder._newModulePosition=o),FLBuilder._showNodeLoadingPlaceholder(n,o)}FLBuilder.ajax({action:a,template_id:l.attr("data-id"),template_type:l.attr("data-type"),parent_id:s,position:o},function(e){if(a.indexOf("row")>-1){var i=FLBuilder._jsonParse(e);FLBuilder.triggerHook("didApplyRowTemplateComplete",i.config),d(i.layout)}else if(a.indexOf("col")>-1){var i=FLBuilder._jsonParse(e);FLBuilder.triggerHook("didApplyColTemplateComplete",i.config),d(i.layout)}else d(e)}),l.remove()},_editNodeTemplateClicked:function(i){i.preventDefault(),i.stopPropagation(),window.open(e(this).attr("href"))},_deleteNodeTemplateClicked:function(i){var t=e(i.target),l=t.closest(".fl-builder-blocks-section"),n=l.find(".fl-builder-blocks-section-content"),s=n.find(".fl-builder-block"),o=t.closest(".fl-builder-block"),r=o.hasClass("fl-builder-block-global"),a=r?FLBuilder._updateLayout:void 0,d=r?FLBuilderStrings.deleteGlobalTemplate:FLBuilderStrings.deleteTemplate,u=null;confirm(d)&&(o.remove(),1===s.length&&(o.hasClass("fl-builder-block-saved-row")?n.append('<span class="fl-builder-block-no-node-templates">'+FLBuilderStrings.noSavedRows+"</span>"):n.append('<span class="fl-builder-block-no-node-templates">'+FLBuilderStrings.noSavedModules+"</span>")),o.hasClass("fl-builder-block-global")&&FLBuilder.showAjaxLoader(),FLBuilder.ajax({action:"delete_node_template",template_id:o.attr("data-id")},a),u=_.findIndex(FLBuilderConfig.contentItems.template,{id:o.attr("data-id"),type:"user"}),FLBuilderConfig.contentItems.template.splice(u,1),FLBuilder.triggerHook("contentItemsChanged"))},_initSettingsForms:function(){FLBuilder._initSections(),FLBuilder._initButtonGroupFields(),FLBuilder._initCompoundFields(),FLBuilder._CodeFieldSSLCheck(),FLBuilder._initCodeFields(),FLBuilder._initColorPickers(),FLBuilder._initGradientPickers(),FLBuilder._initIconFields(),FLBuilder._initPhotoFields(),FLBuilder._initSelectFields(),FLBuilder._initEditorFields(),FLBuilder._initMultipleFields(),FLBuilder._initAutoSuggestFields(),FLBuilder._initLinkFields(),FLBuilder._initFontFields(),FLBuilder._initOrderingFields(),FLBuilder._initTimezoneFields(),FLBuilder._initDimensionFields(),FLBuilder._initFieldPopupSliders(),FLBuilder._initPresetFields(),FLBuilder._focusFirstSettingsControl(),FLBuilder._calculateSettingsTabsOverflow(),FLBuilder._lightbox._resizeEditors(),e(".fl-builder-settings-fields").css("visibility","visible"),e(".fl-builder-settings button").on("click",function(e){e.preventDefault()}),FLBuilder.triggerHook("settings-form-init")},_destroySettingsForms:function(){FLBuilder._destroyEditorFields()},_setSettingsFormContent:function(i){e(".fl-legacy-settings").remove(),e("body").append(i)},_settingsTabClicked:function(i){var t=e(this),l=t.closest(".fl-builder-settings"),n=t.attr("href").split("#").pop();FLBuilder._resetSettingsTabsState(),l.find(".fl-builder-settings-tab").removeClass("fl-active"),l.find("#"+n).addClass("fl-active"),l.find(".fl-builder-settings-tabs .fl-active").removeClass("fl-active"),l.find("a[href*="+n+"]").addClass("fl-active"),FLBuilder._focusFirstSettingsControl(),i.preventDefault()},_resetSettingsTabsState:function(){var i=e(".fl-lightbox:visible");FLBuilder._hideTabsOverflowMenu(),i.find(".fl-builder-settings-tabs .fl-active").removeClass("fl-active"),i.find(".fl-builder-settings-tabs-overflow-menu .fl-active").removeClass("fl-active"),i.find(".fl-contains-active").removeClass("fl-contains-active")},_calculateSettingsTabsOverflow:function(){var i=e(".fl-lightbox:visible"),t=i.outerWidth(),l=i.hasClass("fl-lightbox-width-slim"),n=i.find(".fl-builder-settings-tabs"),s=i.find(".fl-builder-settings-tabs-overflow-menu"),o=i.find(".fl-builder-settings-tabs-more"),r=n.find("a"),a=!1,d=t-60,u=0,c=l?16:30;s.html(""),FLBuilder._hideTabsOverflowMenu(),r.removeClass("fl-overflowed"),r.each(function(){if(!e(this).is(":visible"))return!0;if(!a){var i=e(this).textWidth()+c+12;u+=i,u>=d&&(a=!0)}if(a){var t=e(this).html(),l=e(this).attr("href"),n="";e(this).hasClass("fl-active")&&(n="fl-active"),e(this).hasClass("error")&&(n+=" error"),""!==n&&(n='class="'+n+'"');var o=e('<a href="'+l+'" '+n+">"+t+"</a>");s.append(o),e(this).addClass("fl-overflowed")}else e(this).removeClass("fl-overflowed")}),a?i.addClass("fl-lightbox-has-tab-overflow"):i.removeClass("fl-lightbox-has-tab-overflow"),s.find(".fl-active").length>0?o.addClass("fl-contains-active"):o.removeClass("fl-contains-active"),s.find(".error").length>0?o.addClass("fl-contains-errors"):o.removeClass("fl-contains-errors")},_settingsTabsToOverflowMenuItemClicked:function(i){var t=e(i.currentTarget),l=t.attr("href"),n=t.closest(".fl-lightbox-header-wrap").find(".fl-builder-settings-tabs"),s=n.find('a[href="'+l+'"]'),o=n.find(".fl-builder-settings-tabs-more");FLBuilder._resetSettingsTabsState(),s.trigger("click"),t.addClass("fl-active"),o.addClass("fl-contains-active"),FLBuilder._hideTabsOverflowMenu(),i.preventDefault()},_hasOverflowTabs:function(){var i=e(".fl-lightbox:visible"),t=i.find(".fl-builder-settings-tabs-overflow-menu a");return t.length>0},_showTabsOverflowMenu:function(){if(FLBuilder._hasOverflowTabs()){var i=e(".fl-lightbox:visible");i.find(".fl-builder-settings-tabs-overflow-menu").css("display","flex"),i.find(".fl-builder-settings-tabs-overflow-click-mask").show(),this.isShowingSettingsTabsOverflowMenu=!0}},_hideTabsOverflowMenu:function(){var i=e(".fl-lightbox:visible");i.find(".fl-builder-settings-tabs-overflow-menu").css("display","none"),i.find(".fl-builder-settings-tabs-overflow-click-mask").hide(),this.isShowingSettingsTabsOverflowMenu=!1},_toggleTabsOverflowMenu:function(e){FLBuilder.isShowingSettingsTabsOverflowMenu?FLBuilder._hideTabsOverflowMenu():FLBuilder._showTabsOverflowMenu(),e.stopPropagation()},_settingsCancelClicked:function(i){var t=e(".fl-builder-lightbox[data-parent]"),l=e(".fl-builder-module-settings"),n=null,s=null,o=null,r=null,a="column"==FLBuilderConfig.userTemplateType;return t.length>0?void FLBuilder._closeNestedSettings():(l.length>0&&"undefined"!=typeof l.data("new-module")?(n=e(FLBuilder.preview.state.html),s=e(".fl-node-"+l.data("node")),o=s.closest(".fl-col"),r=n.find(".fl-node-"+o.data("node")),r.length>0||a?FLBuilder._deleteModule(s):FLBuilder._deleteCol(o)):FLBuilder.preview&&FLBuilder.preview.revert(),FLBuilder.preview=null,FLLightbox.closeParent(this),void FLBuilder.triggerHook("didCancelNodeSettings"))},_focusFirstSettingsControl:function(){var i=e(".fl-builder-settings:visible"),t=i.find(".fl-builder-settings-tab.fl-active"),l=i.data("node"),n=t.find(".fl-field").first(),s=n.find('input:not([type="hidden"]), textarea, select, button, a, .fl-editor-field').first();if(!l||!e(".fl-node-"+l+" .fl-inline-editor").length){if("undefined"!=typeof tinyMCE&&s.hasClass("fl-editor-field")){var o=s.find("textarea.wp-editor-area").attr("id");tinyMCE.get(o).focus()}else setTimeout(function(){s.focus().css("animation-name","fl-grab-attention")},300);n.css("animation-name","fl-grab-attention"),n.on("animationend",function(){n.css("animation-name","")})}},_initSettingsValidation:function(i,t){var l=e(".fl-builder-settings").last();t||(t={}),l.validate({ignore:".fl-ignore-validation",rules:i,messages:t,errorPlacement:FLBuilder._settingsErrorPlacement})},_settingsErrorPlacement:function(e,i){e.appendTo(i.parent())},_toggleSettingsTabErrors:function(){for(var i=e(".fl-builder-settings:visible"),t=i.find(".fl-builder-settings-tab"),l=null,n=null,s=0;s<t.length;s++)l=t.eq(s),n=l.find("label.error"),tabLink=i.find(".fl-builder-settings-tabs a[href*="+l.attr("id")+"]"),tabLink.find(".fl-error-icon").remove(),tabLink.removeClass("error"),n.length>0&&(tabLink.append('<span class="fl-error-icon"></span>'),tabLink.addClass("error"));FLBuilder._calculateSettingsTabsOverflow()},_getSettings:function(i){FLBuilder._updateEditorFields();var t=i.serializeArray(),l=0,n=0,s="",o="",r="",a=[],d=[],u={};for(l=0;l<t.length;l++)if(s=t[l].value.replace(/\r/gm,"").replace(/&#39;/g,"'"),!(t[l].name.indexOf("flrich")>-1))if(t[l].name.indexOf("[")>-1){for(o=t[l].name.replace(/\[(.*)\]/,""),r=t[l].name.replace(o,""),a=[],d=r.match(/\[[^\]]*\]/g),n=0;n<d.length;n++)"[]"!=d[n]&&a.push(d[n].replace(/\[|\]/g,""));r.match(/\[\]\[[^\]]*\]\[[^\]]+\]/)||r.match(/\[\]\[[^\]]*\]\[\]\[[^\]]+\]/)?("undefined"==typeof u[o]&&(u[o]={}),"undefined"==typeof u[o][a[0]]&&(u[o][a[0]]={}),u[o][a[0]][a[1]]=s):r.match(/\[\]\[[^\]]*\]\[\]/)?("undefined"==typeof u[o]&&(u[o]={}),"undefined"==typeof u[o][a[0]]&&(u[o][a[0]]=[]),u[o][a[0]].push(s)):r.match(/\[\]\[[^\]]*\]/)?("undefined"==typeof u[o]&&(u[o]={}),u[o][a[0]]=s):r.match(/\[\]/)&&("undefined"==typeof u[o]&&(u[o]=[]),u[o].push(s))}else u[t[l].name]=s;for(r in u)if("undefined"!=typeof u["as_values_"+r]){u[r]=e.grep(u["as_values_"+r].split(","),function(e){return""!==e}).join(",");try{delete u["as_values_"+r]}catch(c){}}return e.each(i.find("[name]"),function(i,t){var l=e(t).attr("name").replace(/\[(.*)\]/,"");l in u||(u[l]="")}),u=e.extend({},FLBuilder._getOriginalSettings(i),u)},_getSettingsJSONForHTML:function(e){return JSON.stringify(e).replace(/\'/g,"&#39;").replace("<wbr />","<wbr>")},_getOriginalSettings:function(i,t){var l=i.find(".fl-builder-settings-json"),n=i.data("node"),s=FLBuilderSettingsConfig.nodes,o=null,r={};if(n&&s[n]?o=s[n]:l.length&&(o=FLBuilder._jsonParse(l.val().replace(/&#39;/g,"'"))),o)for(key in o)(e("#fl-field-"+key).length||t)&&(r[key]=o[key]);return r},_getSettingsForChangedCheck:function(i,t){var l=FLBuilder._getSettings(t);if(i){var n=e(".fl-node-"+i);if(n.hasClass("fl-module")){var s=n.data("type"),o=FLBuilderSettingsConfig.editables[s];if(o&&FLBuilderSettingsConfig.nodes[i])for(var r in o)l[r]=FLBuilderSettingsConfig.nodes[i][r]}}return l},_saveSettings:function(i){var t=e(".fl-builder-settings-lightbox .fl-builder-settings"),l=t.data("new-module"),n=t.attr("data-node"),s=FLBuilder._getSettings(t),o=FLBuilder.preview;return!FLBuilder.isUndefined(i)&&FLBuilder.isBoolean(i)||(i=!0),o&&!o._settingsHaveChanged()&&FLBuilder.isUndefined(l)?void FLBuilder._lightbox.close():(FLBuilder._showNodeLoading(n),FLBuilderSettingsConfig.nodes[n]=s,FLBuilder.ajax({action:"save_settings",node_id:n,settings:s},FLBuilder._saveSettingsComplete.bind(this,i,o)),FLBuilder.triggerHook("didSaveNodeSettings",{nodeId:n,settings:s}),void FLBuilder._lightbox.close())},_saveSettingsComplete:function(e,i,t){var l=FLBuilder._jsonParse(t),n=function(){i&&l.layout.partial&&l.layout.nodeId===i.nodeId&&(i.clear(),i=null)};!0===e?FLBuilder._renderLayout(l.layout,n):n(),FLBuilder.triggerHook("didSaveNodeSettingsComplete",{nodeId:l.node_id,settings:l.settings})},_triggerSettingsSave:function(i,t,l){var n=FLBuilder._lightbox._node.find("form.fl-builder-settings"),s=FLBuilder._lightbox._node.data("instance-id"),o=FLLightbox._instances[s],r=e(".fl-lightbox-wrap[data-parent]:visible"),a=!1,d=!0;return i=!_.isUndefined(i)&&i,t=!_.isUndefined(t)&&t,l=!!_.isUndefined(l)||l,n.length&&(r.length&&(r.find(".fl-builder-settings-save").trigger("click"),(r.find("label.error").length||e(".fl-builder-alert-lightbox:visible").length)&&(d=!1)),d&&!n.validate().form()&&(d=!1),a=FLBuilderSettingsForms.settingsHaveChanged(),d&&a&&(i&&o.disableClose(),n.find(".fl-builder-settings-save").trigger("click"),i&&o.enableClose(),(n.find("label.error").length||e(".fl-builder-alert-lightbox:visible").length)&&(d=!1)),l&&(FLBuilder._destroySettingsForms(),!a&&FLBuilder.preview&&(FLBuilder.preview.clear(),FLBuilder.preview=null)),a||i||o.close()),d?FLBuilder.triggerHook("didTriggerSettingsSave"):(FLBuilder.triggerHook("didFailSettingsSave"),FLBuilder._toggleSettingsTabErrors(),t&&!e(".fl-builder-alert-lightbox:visible").length&&FLBuilder.alert(FLBuilderStrings.settingsHaveErrors)),d},_refreshSettingsPreviewReference:function(){FLBuilder.preview&&FLBuilder.preview._initElementsAndClasses()},_openNestedSettings:function(i){i.className&&-1===i.className.indexOf("fl-builder-settings-lightbox")&&(i.className+=" fl-builder-settings-lightbox"),i=e.extend({className:"fl-builder-lightbox  fl-builder-settings-lightbox",destroyOnClose:!0,resizable:!0},i);var t=e(".fl-lightbox-wrap:visible"),l=t.find(".fl-lightbox"),n=new FLLightbox(i),s=n._node,o=s.find(".fl-lightbox");return t.hide(),s.attr("data-parent",t.attr("data-instance-id")),o.attr("style",l.attr("style")),n.on("resized",FLBuilder._calculateSettingsTabsOverflow),n.open('<div class="fl-builder-lightbox-loading"></div>'),n},_closeNestedSettings:function(){var i=e(".fl-builder-lightbox[data-parent]:visible"),t=i.find(".fl-lightbox"),l=i.attr("data-instance-id"),n=FLLightbox._instances[l],s=i.attr("data-parent"),o=e('[data-instance-id="'+s+'"]'),r=o.find(".fl-lightbox"),a=o.find("form"),d=FLLightbox._instances[s];n.on("close",function(){r.attr("style",t.attr("style")),o.show(),d._resize(),o.find("label.error").remove(),a.validate().hideErrors(),FLBuilder._toggleSettingsTabErrors()}),n.close()},_showHelpTooltip:function(){e(this).siblings(".fl-help-tooltip-text").fadeIn()},_hideHelpTooltip:function(){e(this).siblings(".fl-help-tooltip-text").fadeOut()},_initSections:function(){e(".fl-builder-settings:visible").find(".fl-builder-settings-section").each(FLBuilder._initSection)},_initSection:function(){var i=e(this),t=i.find(".fl-builder-settings-section-header");t.on("click",function(){i.toggleClass("fl-builder-settings-section-collapsed")})},_initButtonGroupFields:function(){e(".fl-builder-settings:visible").find(".fl-button-group-field").each(FLBuilder._initButtonGroupField)},_initButtonGroupField:function(){var i=e(this),t=i.find(".fl-button-group-field-option"),l=i.find("input");t.on("click",function(){var i=e(this);"1"==i.attr("data-selected")?(i.attr("data-selected","0"),l.val("").trigger("change")):(t.attr("data-selected","0"),i.attr("data-selected","1"),l.val(i.data("value")).trigger("change"))}),l.on("change",function(e){var i=l.val(),n=t.filter('[data-value="'+i+'"]');t.attr("data-selected","0"),n.attr("data-selected","1")})},_initCompoundFields:function(){e(".fl-builder-settings:visible").find(".fl-compound-field").each(FLBuilder._initCompoundField)},_initCompoundField:function(){var i=e(this),t=i.find(".fl-compound-field-section"),l=i.find(".fl-compound-field-section-toggle"),n=i.find(".fl-compound-field-setting").has(".fl-dimension-field-units");
t.each(function(){var i=e(this);i.find(".fl-compound-field-section-toggle").length||i.addClass("fl-compound-field-section-visible")}),l.on("click",function(){var i=e(this),t=i.closest(".fl-field"),l=i.closest(".fl-compound-field-section"),n="."+l.attr("class").split(" ").join(".");t.find(n).toggleClass("fl-compound-field-section-visible")}),n.each(function(){var i=e(this),t=i.find(".fl-compound-field-label"),l='<i class="fl-dimension-field-link fl-tip dashicons dashicons-admin-links" title="Link Values"></i>';t.length&&!i.find(".fl-shadow-field").length&&t.append(l)})},_initAutoSuggestFields:function(){var i=e(".fl-builder-settings:visible .fl-suggest-field"),t=null,l=null,n=null,s=[];i.each(function(){t=e(this),""!==t.attr("data-value")&&(FLBuilderSettingsForms.showFieldLoader(t),s.push({name:t.attr("name"),value:t.attr("data-value"),action:t.attr("data-action"),data:t.attr("data-action-data")}))}),s.length?FLBuilder.ajax({action:"get_autosuggest_values",fields:s},function(t){l=FLBuilder._jsonParse(t);for(n in l)e('.fl-suggest-field[name="'+n+'"]').attr("data-value",l[n]);i.each(FLBuilder._initAutoSuggestField)}):i.each(FLBuilder._initAutoSuggestField)},_initAutoSuggestField:function(){var i=e(this);i.autoSuggest(FLBuilder._ajaxUrl({fl_action:"fl_builder_autosuggest",fl_as_action:i.data("action"),fl_as_action_data:i.data("action-data"),_wpnonce:FLBuilderConfig.ajaxNonce}),e.extend({},{asHtmlID:i.attr("name"),selectedItemProp:"name",searchObjProps:"name",minChars:2,keyDelay:1e3,fadeOut:!1,usePlaceholder:!0,emptyText:FLBuilderStrings.noResultsFound,showResultListWhenNoMatch:!0,preFill:i.data("value"),queryParam:"fl_as_query",afterSelectionAdd:FLBuilder._updateAutoSuggestField,afterSelectionRemove:FLBuilder._updateAutoSuggestField,selectionLimit:i.data("limit"),canGenerateNewSelections:!1},i.data("args"))),FLBuilderSettingsForms.hideFieldLoader(i)},_updateAutoSuggestField:function(i,t,l){e(this).siblings(".as-values").val(l.join(",")).trigger("change")},_CodeFieldSSLCheck:function(){e("body").append('<div class="sg-test" style="display:none"><svg xmlns="http://www.w3.org/2000/svg"></svg></div>'),"https://www.w3.org/2000/svg"===e(".sg-test").find("svg").attr("xmlns")&&(FLBuilder._codeDisabled=!0),e(".sg-test").remove()},_initCodeFields:function(){FLBuilder._codeDisabled||e(".fl-builder-settings:visible").find(".fl-code-field").each(FLBuilder._initCodeField)},_initCodeField:function(){var i=e(this),t=i.closest(".fl-builder-settings"),l=i.find("textarea"),n=(l.attr("id"),l.data("editor")),s=l.data("wrap"),o=e("<div>",{position:"absolute",height:20*parseInt(l.attr("rows"),10)}),r=null;o.insertBefore(l),l.css("display","none"),ace.require("ace/ext/language_tools"),r=ace.edit(o[0]),r.$blockScrolling=1/0,r.getSession().setValue(l.val()),r.getSession().setMode("ace/mode/"+n),s&&r.getSession().setUseWrapMode(!0),r.setOptions(FLBuilderConfig.AceEditorSettings),r.getSession().on("change",function(e){l.val(r.getSession().getValue()).trigger("change")}),r.getSession().on("changeAnnotation",function(){for(var e=r.getSession().getAnnotations(),i=t.find(".fl-builder-settings-save"),l=t.find(".fl-builder-settings-error"),n=!1,s=0;s<e.length;s++)if(!(e[s].text.indexOf("DOCTYPE")>-1||e[s].text.indexOf("Named entity expected")>-1||e[s].text.indexOf("@supports")>-1||"error"!==e[s].type)){n=!0;break}n&&!l.length&&FLBuilderConfig.CheckCodeErrors?(i.addClass("fl-builder-settings-error"),i.on("click",FLBuilder._showCodeFieldError)):!n&&l.length&&(l.removeClass("fl-builder-settings-error"),l.off("click",FLBuilder._showCodeFieldError))}),l.closest(".fl-field").data("editor",r)},_showCodeFieldError:function(i){i.stopImmediatePropagation(),FLBuilder.confirm({message:FLBuilderStrings.codeError,cancel:function(){var i=e(".fl-builder-settings:visible .fl-builder-settings-save");i.removeClass("fl-builder-settings-error"),i.off("click",FLBuilder._showCodeFieldError),i.trigger("click")},strings:{ok:FLBuilderStrings.codeErrorFix,cancel:FLBuilderStrings.codeErrorIgnore}})},_initMultipleFields:function(){var i=e(".fl-builder-settings:visible .fl-builder-field-multiples"),t=null,l=null,n=0,s=FLBuilderConfig.isRtl?{left:10}:{right:10},o=i.attr("data-limit")||0,r=e("tbody.fl-builder-field-multiples").find("tr").length||0;for(parseInt(o)>0&&r-1>=parseInt(o)?(e(".fl-builder-field-copy").hide(),e(".fl-builder-field-add").fadeOut()):e(".fl-builder-field-copy, .fl-builder-field-add").show();n<i.length;n++)t=i.eq(n),l=t.find(".fl-builder-field-multiple"),1===l.length?l.eq(0).find(".fl-builder-field-actions").addClass("fl-builder-field-actions-single"):l.find(".fl-builder-field-actions").removeClass("fl-builder-field-actions-single");e(".fl-builder-field-multiples").sortable({items:".fl-builder-field-multiple",cursor:"move",cursorAt:s,distance:5,opacity:.5,placeholder:"fl-builder-field-dd-zone",stop:FLBuilder._fieldDragStop,tolerance:"pointer",axis:"y"})},_addFieldClicked:function(){var i=e(this),t=i.attr("data-field"),l=i.closest("tr").siblings("tr[data-field="+t+"]").last(),n=l.clone(),s=n.find(".fl-form-field"),o=null,r=null,a=parseInt(l.find("label span.fl-builder-field-index").html(),10)+1;n.find("th label span.fl-builder-field-index").html(a),n.find(".fl-form-field-preview-text").html(""),n.find(".fl-form-field-before").remove(),n.find(".fl-form-field-after").remove(),n.find("input, textarea, select").val(""),l.after(n),FLBuilder._initMultipleFields(),s.length?(o=s.find(".fl-form-field-edit").data("type"),s.find("input").val(JSON.stringify(FLBuilderSettingsConfig.defaults.forms[o]))):(s=i.closest("form.fl-builder-settings"),o=s.data("type"),o&&s.hasClass("fl-builder-module-settings")&&(r=FLBuilderSettingsConfig.defaults.modules[o][t][0],n.find("input, textarea, select").val(r)))},_copyFieldClicked:function(){var i=e(this),t=i.closest("tr"),l=t.clone(),n=parseInt(t.find("label span.fl-builder-field-index").html(),10)+1;l.find("th label span.fl-builder-field-index").html(n),t.after(l),FLBuilder._renumberFields(t.parent()),FLBuilder._initMultipleFields(),FLBuilder.preview.delayPreview()},_deleteFieldClicked:function(){var i=e(this).closest("tr"),t=i.parent(),l=confirm(FLBuilderStrings.deleteFieldMessage);l&&(i.remove(),FLBuilder._renumberFields(t),FLBuilder._initMultipleFields(),FLBuilder.preview.delayPreview())},_renumberFields:function(e){for(var i=e.find(".fl-builder-field-multiple"),t=0;t<i.length;t++)i.eq(t).find("th label span.fl-builder-field-index").html(t+1)},_fieldDragHelper:function(){return e('<div class="fl-builder-field-dd-helper"></div>')},_fieldDragStop:function(e,i){FLBuilder._renumberFields(i.item.parent()),FLBuilder.preview.delayPreview()},_initSelectFields:function(){var i=e(".fl-builder-settings:visible").find("select");i.on("change",FLBuilder._settingsSelectChanged),i.trigger("change"),i.on("change",FLBuilder._calculateSettingsTabsOverflow);var t=e(".fl-builder-settings:visible").find(".fl-button-group-field input[type=hidden]");t.on("change",FLBuilder._settingsSelectChanged),t.trigger("change"),t.on("change",FLBuilder._calculateSettingsTabsOverflow)},_settingsSelectChanged:function(){var i=e(this),t=i.attr("data-toggle"),l=i.attr("data-hide"),n=i.attr("data-trigger"),s=i.val(),o=0;if("undefined"!=typeof t){t=FLBuilder._jsonParse(t);for(o in t)FLBuilder._settingsSelectToggle(t[o].fields,"hide","#fl-field-"),FLBuilder._settingsSelectToggle(t[o].sections,"hide","#fl-builder-settings-section-"),FLBuilder._settingsSelectToggle(t[o].tabs,"hide","a[href*=fl-builder-settings-tab-","]");"undefined"!=typeof t[s]&&(FLBuilder._settingsSelectToggle(t[s].fields,"show","#fl-field-"),FLBuilder._settingsSelectToggle(t[s].sections,"show","#fl-builder-settings-section-"),FLBuilder._settingsSelectToggle(t[s].tabs,"show","a[href*=fl-builder-settings-tab-","]"))}if("undefined"!=typeof l){l=FLBuilder._jsonParse(l);for(o in l)FLBuilder._settingsSelectToggle(l[o].fields,"show","#fl-field-"),FLBuilder._settingsSelectToggle(l[o].sections,"show","#fl-builder-settings-section-"),FLBuilder._settingsSelectToggle(l[o].tabs,"show","a[href*=fl-builder-settings-tab-","]");"undefined"!=typeof l[s]&&(FLBuilder._settingsSelectToggle(l[s].fields,"hide","#fl-field-"),FLBuilder._settingsSelectToggle(l[s].sections,"hide","#fl-builder-settings-section-"),FLBuilder._settingsSelectToggle(l[s].tabs,"hide","a[href*=fl-builder-settings-tab-","]"))}if("undefined"!=typeof n&&(n=FLBuilder._jsonParse(n),"undefined"!=typeof n[s]&&"undefined"!=typeof n[s].fields))for(o=0;o<n[s].fields.length;o++)e("#fl-field-"+n[s].fields[o]).find("select").trigger("change")},_settingsSelectToggle:function(i,t,l,n){var s=0;if(n="undefined"==typeof n?"":n,"undefined"!=typeof i)for(;s<i.length;s++)e(".fl-builder-settings:visible").find(l+i[s]+n)[t](),e(l+i[s]+n).parent().find('.fl-field[data-type="code"]').each(function(){FLBuilder._codeDisabled||e(this).data("editor").resize()})},_initColorPickers:function(){var i=FLBuilderConfig.colorPresets?FLBuilderConfig.colorPresets:[];FLBuilder.colorPicker=new FLBuilderColorPicker({mode:"hsv",elements:".fl-color-picker .fl-color-picker-value",presets:i,labels:{colorPresets:FLBuilderStrings.colorPresets,colorPicker:FLBuilderStrings.colorPicker,placeholder:FLBuilderStrings.placeholder,removePresetConfirm:FLBuilderStrings.removePresetConfirm,noneColorSelected:FLBuilderStrings.noneColorSelected,alreadySaved:FLBuilderStrings.alreadySaved,noPresets:FLBuilderStrings.noPresets,presetAdded:FLBuilderStrings.presetAdded}}),e(FLBuilder.colorPicker).on("presetRemoved presetAdded",function(e,i){FLBuilder.ajax({action:"save_color_presets",presets:i.presets})})},_initGradientPickers:function(){e(".fl-builder-settings:visible .fl-gradient-picker").each(FLBuilder._initGradientPicker)},_initGradientPicker:function(){var i=e(this),t=i.find(".fl-gradient-picker-type-select"),l=i.find(".fl-gradient-picker-angle-wrap"),n=i.find(".fl-gradient-picker-position");t.on("change",function(){"linear"===e(this).val()?(l.show(),n.hide()):(l.hide(),n.show())})},_initPhotoFields:function(){var i=e(".fl-builder-settings:visible").find(".fl-photo-field select");i.on("change",FLBuilder._toggleSettingsOnIconChange),i.trigger("change")},_initSinglePhotoSelector:function(){null===FLBuilder._singlePhotoSelector&&(FLBuilder._singlePhotoSelector=wp.media({title:FLBuilderStrings.selectPhoto,button:{text:FLBuilderStrings.selectPhoto},library:{type:"image"},multiple:!1}),FLBuilder._singlePhotoSelector.on("open",FLBuilder._wpmedia_reset_errors),_wpPluploadSettings.defaults.multipart_params.fl_upload_type="photo")},_selectSinglePhoto:function(){FLBuilder._initSinglePhotoSelector(),FLBuilder._singlePhotoSelector.once("open",e.proxy(FLBuilder._singlePhotoOpened,this)),FLBuilder._singlePhotoSelector.once("select",e.proxy(FLBuilder._singlePhotoSelected,this)),FLBuilder._singlePhotoSelector.open()},_singlePhotoOpened:function(){var i=FLBuilder._singlePhotoSelector.state().get("selection"),t=e(this).closest(".fl-photo-field"),l=t.find("input[type=hidden]"),n=l.val(),s=null;e(this).hasClass("fl-photo-replace")?(i.reset(),t.addClass("fl-photo-empty"),l.val("")):""!==n?(s=wp.media.attachment(n),s.fetch(),i.add(s?[s]:[])):i.reset()},_singlePhotoSelected:function(){var i=FLBuilder._singlePhotoSelector.state().get("selection").first().toJSON(),t=e(this).closest(".fl-photo-field"),l=t.find("input[type=hidden]"),n=t.find(".fl-photo-preview img"),s=t.find("select");l.val(i.id),n.attr("src",FLBuilder._getPhotoSrc(i)),t.removeClass("fl-photo-empty").removeClass("fl-photo-no-attachment"),t.find("label.error").remove(),s.show(),s.html(FLBuilder._getPhotoSizeOptions(i)),s.trigger("change"),FLBuilderSettingsConfig.attachments[i.id]=i},_singlePhotoRemoved:function(){FLBuilder._initSinglePhotoSelector();var i=FLBuilder._singlePhotoSelector.state(),t="undefined"!=typeof i?i.get("selection"):null,l=e(this).closest(".fl-photo-field"),n=l.find("input[type=hidden]"),s=l.find("select");t&&t.reset(),l.addClass("fl-photo-empty"),n.val(""),s.html('<option value="" selected></option>'),s.trigger("change")},_getPhotoSrc:function(e){return"undefined"==typeof e.sizes?e.url:"undefined"!=typeof e.sizes.thumbnail?e.sizes.thumbnail.url:e.sizes.full.url},_getPhotoSizeOptions:function(e,i){var t="",l=null,n=null,s="",o={full:FLBuilderStrings.fullSize,large:FLBuilderStrings.large,medium:FLBuilderStrings.medium,thumbnail:FLBuilderStrings.thumbnail};if("undefined"==typeof e.sizes||0===e.sizes.length)t+='<option value="'+e.url+'">'+FLBuilderStrings.fullSize+"</option>";else{i&&(i=i.split(/[\\\/]/).pop());for(l in e.sizes)s="undefined"!=typeof o[l]?o[l]+" - ":"undefined"!=typeof FLBuilderConfig.customImageSizeTitles[l]?FLBuilderConfig.customImageSizeTitles[l]+" - ":"",n="",i?i===e.sizes[l].url.split(/[\\\/]/).pop()&&(n=' selected="selected"'):n="full"==l?' selected="selected"':"",t+='<option value="'+e.sizes[l].url+'"'+n+">"+s+e.sizes[l].width+" x "+e.sizes[l].height+"</option>"}return t},_selectMultiplePhotos:function(){var i=e(this).closest(".fl-multiple-photos-field"),t=i.find("input[type=hidden]"),l=t.val(),n=""===l?"":FLBuilder._jsonParse(l),s=wp.media.gallery.defaults.id,o='[gallery ids="-1"]',r=null,a=null,d=null,u=null,c=[];if("object"==typeof n){for(u in n)c.push(n[u]);o='[gallery ids="'+c.join()+'"]'}r=wp.shortcode.next("gallery",o).shortcode,_.isUndefined(r.get("id"))&&!_.isUndefined(s)&&r.set("id",s),a=wp.media.gallery.attachments(r),d=new wp.media.model.Selection(a.models,{props:a.props.toJSON(),multiple:!0}),d.gallery=a.gallery,d.more().done(function(){d.length||FLBuilder._multiplePhotoSelector.setState("gallery-library"),d.props.set({query:!1}),d.unmirror(),d.props.unset("orderby")}),FLBuilder._multiplePhotoSelector&&FLBuilder._multiplePhotoSelector.dispose(),FLBuilder._multiplePhotoSelector=wp.media({frame:"post",state:e(this).hasClass("fl-multiple-photos-edit")?"gallery-edit":"gallery-library",title:wp.media.view.l10n.editGalleryTitle,editing:!0,multiple:!0,selection:d}).open(),e(FLBuilder._multiplePhotoSelector.views.view.el).addClass("fl-multiple-photos-lightbox"),FLBuilder._multiplePhotoSelector.once("update",e.proxy(FLBuilder._multiplePhotosSelected,this))},_multiplePhotosSelected:function(i){for(var t=e(this).closest(".fl-multiple-photos-field"),l=t.find("input[type=hidden]"),n=t.find(".fl-multiple-photos-count"),s=[],o=0;o<i.models.length;o++)s.push(i.models[o].id);1==s.length?n.html("1 "+FLBuilderStrings.photoSelected):n.html(s.length+" "+FLBuilderStrings.photosSelected),t.removeClass("fl-multiple-photos-empty"),t.find("label.error").remove(),l.val(JSON.stringify(s)).trigger("change")},_initSingleVideoSelector:function(){null===FLBuilder._singleVideoSelector&&(FLBuilder._singleVideoSelector=wp.media({title:FLBuilderStrings.selectVideo,button:{text:FLBuilderStrings.selectVideo},library:{type:"video"},multiple:!1}),FLBuilder._singleVideoSelector.on("open",FLBuilder._wpmedia_reset_errors),_wpPluploadSettings.defaults.multipart_params.fl_upload_type="video")},_selectSingleVideo:function(){FLBuilder._initSingleVideoSelector(),FLBuilder._singleVideoSelector.once("select",e.proxy(FLBuilder._singleVideoSelected,this)),FLBuilder._singleVideoSelector.open()},_singleVideoSelected:function(){var i=FLBuilder._singleVideoSelector.state().get("selection").first().toJSON(),t=e(this).closest(".fl-video-field"),l=t.find(".fl-video-preview-img"),n=t.find(".fl-video-preview-filename"),s=t.find("input[type=hidden]");l.html('<span class="dashicons dashicons-media-video"></span>'),n.html(i.filename),t.removeClass("fl-video-empty"),t.find("label.error").remove(),s.val(i.id).trigger("change"),FLBuilderSettingsConfig.attachments[i.id]=i},_singleVideoRemoved:function(){FLBuilder._initSingleVideoSelector();var i=FLBuilder._singleVideoSelector.state(),t="undefined"!=typeof i?i.get("selection"):null,l=e(this).closest(".fl-video-field"),n=l.find(".fl-video-preview-img img"),s=l.find(".fl-video-preview-filename"),o=l.find("input[type=hidden]");t&&t.reset(),n.attr("src",""),s.html(""),l.addClass("fl-video-empty"),o.val("").trigger("change")},_selectMultipleAudios:function(){var i=e(this).closest(".fl-multiple-audios-field"),t=i.find("input[type=hidden]"),l=t.val(),n=""==l?'[playlist ids="-1"]':'[playlist ids="'+FLBuilder._jsonParse(l).join()+'"]',s=wp.shortcode.next("playlist",n).shortcode,o=wp.media.playlist.defaults.id,r=null,a=null;_.isUndefined(s.get("id"))&&!_.isUndefined(o)&&s.set("id",o),r=wp.media.playlist.attachments(s),a=new wp.media.model.Selection(r.models,{props:r.props.toJSON(),multiple:!0}),a.playlist=r.playlist,a.more().done(function(){a.props.set({query:!1}),a.unmirror(),a.props.unset("orderby")}),FLBuilder._multipleAudiosSelector&&FLBuilder._multipleAudiosSelector.dispose(),FLBuilder._multipleAudiosSelector=wp.media({frame:"post",state:e(this).hasClass("fl-multiple-audios-edit")?"playlist-edit":"playlist-library",title:wp.media.view.l10n.editPlaylistTitle,editing:!0,multiple:!0,selection:a}).open(),FLBuilder._multipleAudiosSelector.content.get("view").sidebar.unset("playlist"),FLBuilder._multipleAudiosSelector.on("content:render:browse",function(e){e&&e.sidebar.on("ready",function(){e.sidebar.unset("playlist")})}),FLBuilder._multipleAudiosSelector.once("update",e.proxy(FLBuilder._multipleAudiosSelected,this))},_multipleAudiosSelected:function(i){for(var t=e(this).closest(".fl-multiple-audios-field"),l=t.find(".fl-multiple-audios-count"),n=t.find("input[type=hidden]"),s=[],o=0;o<i.models.length;o++)s.push(i.models[o].id);1==s.length?l.html("1 "+FLBuilderStrings.audioSelected):l.html(s.length+" "+FLBuilderStrings.audiosSelected),n.val(JSON.stringify(s)).trigger("change"),t.removeClass("fl-multiple-audios-empty"),t.find("label.error").remove()},_initIconFields:function(){var i=e(".fl-builder-settings:visible").find(".fl-icon-field input");i.on("change",FLBuilder._toggleSettingsOnIconChange),i.trigger("change")},_toggleSettingsOnIconChange:function(){var i=e(this),t=i.val(),l=i.attr("data-show");"undefined"!=typeof l&&(l=FLBuilder._jsonParse(l),FLBuilder._settingsSelectToggle(l.fields,"hide","#fl-field-"),FLBuilder._settingsSelectToggle(l.sections,"hide","#fl-builder-settings-section-"),FLBuilder._settingsSelectToggle(l.tabs,"hide","a[href*=fl-builder-settings-tab-","]"),t&&(FLBuilder._settingsSelectToggle(l.fields,"show","#fl-field-"),FLBuilder._settingsSelectToggle(l.sections,"show","#fl-builder-settings-section-"),FLBuilder._settingsSelectToggle(l.tabs,"show","a[href*=fl-builder-settings-tab-","]"),FLBuilder._calculateSettingsTabsOverflow()))},_selectIcon:function(){var e=this;FLIconSelector.open(function(i){FLBuilder._iconSelected.apply(e,[i])})},_iconSelected:function(i){var t=e(this).closest(".fl-icon-field"),l=t.find("input[type=hidden]"),n=t.find("i"),s=n.attr("data-icon");l.val(i).trigger("change"),n.removeClass(s),n.addClass(i),n.attr("data-icon",i),t.removeClass("fl-icon-empty"),t.find("label.error").remove()},_removeIcon:function(){var i=e(this).closest(".fl-icon-field"),t=i.find("input[type=hidden]"),l=i.find("i");t.val("").trigger("change"),l.removeClass(),l.attr("data-icon",""),i.addClass("fl-icon-empty")},_formFieldClicked:function(){var i=e(this),t=i.closest(".fl-builder-settings"),l=i.attr("data-type"),n=i.siblings("input").val(),s=FLBuilder._moduleHelpers[l],o=(FLBuilderSettingsConfig.forms[l],FLBuilder._openNestedSettings({className:"fl-builder-lightbox fl-form-field-settings"}));""===n&&(n=JSON.stringify(FLBuilderSettingsConfig.forms[l])),FLBuilderSettingsForms.render({id:l,nodeId:t.attr("data-node"),nodeSettings:FLBuilder._getSettings(t),settings:FLBuilder._jsonParse(n.replace(/&#39;/g,"'")),lightbox:o,helper:s,rules:s?s.rules:null},function(){i.attr("id","fl-"+o._node.attr("data-instance-id")),o._node.find("form.fl-builder-settings").attr("data-type",l)})},_saveFormFieldClicked:function(){var i=e(this).closest(".fl-builder-settings"),t=e(this).closest(".fl-lightbox-wrap").attr("data-instance-id"),l=i.attr("data-type"),n=FLBuilder._getSettings(i),s={},o=FLBuilder._moduleHelpers[l],r=e(".fl-builder-settings #fl-"+t),a=r.parent().attr("data-preview-text"),d=i.find("#fl-field-"+a),u=n[a],c=e('select[name="'+a+'"]'),f=document.createElement("div"),h=!0;return c.length>0&&(u=c.find('option[value="'+n[a]+'"]').text()),"undefined"!=typeof o&&(i.find("label.error").remove(),i.validate().hideErrors(),h=i.validate().form(),h&&(h=o.submit())),h?("undefined"!=typeof a&&"undefined"!=typeof u&&("icon"===d.data("type")?u='<i class="'+u+'"></i>':u.length>35&&(f.innerHTML=u,u=(f.textContent||f.innerText||"").replace(/^(.{35}[^\s]*).*/,"$1")+"..."),r.siblings(".fl-form-field-preview-text").html(u)),s=r.siblings("input").val().replace(/&#39;/g,"'"),""!=s&&(n=e.extend(FLBuilder._jsonParse(s),n)),r.siblings("input").val(JSON.stringify(n)).trigger("change"),FLBuilder._closeNestedSettings(),!0):(FLBuilder._toggleSettingsTabErrors(),!1)},_layoutFieldClicked:function(){var i=e(this);i.siblings().removeClass("fl-layout-field-option-selected"),i.addClass("fl-layout-field-option-selected"),i.siblings("input").val(i.attr("data-value"))},_initLinkFields:function(){e(".fl-builder-settings:visible .fl-link-field").each(FLBuilder._initLinkField)},_initLinkField:function(){var i=e(this),t=i.find(".fl-link-field-search-input"),l=i.find(".fl-link-field-options-wrap input[type=checkbox]");t.autoSuggest(FLBuilder._ajaxUrl({fl_action:"fl_builder_autosuggest",fl_as_action:"fl_as_links",_wpnonce:FLBuilderConfig.ajaxNonce}),{asHtmlID:t.attr("name"),selectedItemProp:"name",searchObjProps:"name",minChars:3,keyDelay:1e3,fadeOut:!1,usePlaceholder:!0,emptyText:FLBuilderStrings.noResultsFound,showResultListWhenNoMatch:!0,queryParam:"fl_as_query",selectionLimit:1,afterSelectionAdd:FLBuilder._updateLinkField}),l.on("click",FLBuilder._linkFieldCheckboxClicked)},_updateLinkField:function(e,i,t){var l=e.closest(".fl-link-field"),n=l.find(".fl-link-field-search"),s=l.find(".fl-link-field-search-input"),o=l.find(".fl-link-field-input");o.val(i.value).trigger("keyup"),s.autoSuggest("remove",i.value),n.hide()},_linkFieldSelectClicked:function(){var i=e(this).closest(".fl-link-field").find(".fl-link-field-search");i.show(),i.find("input").focus()},_linkFieldSelectCancelClicked:function(){var i=e(this);i.parent().hide(),i.closest(".fl-link-field").find("input.fl-link-field-input").focus()},_linkFieldCheckboxClicked:function(){var i=e(this),t=i.is(":checked"),l=i.siblings("input[type=hidden]"),n="";n=i.hasClass("fl-link-field-target-cb")?t?"_blank":"_self":t?"yes":"no",l.val(n)},_initFontFields:function(){e(".fl-builder-settings:visible .fl-font-field").each(FLBuilder._initFontField)},_initFontField:function(){var i=e(this),t=i.attr("data-value"),l=i.find(".fl-font-field-font"),n=i.find(".fl-font-field-weight");l.on("change",function(){FLBuilder._getFontWeights(l)}),t.indexOf("family")>-1&&(t=FLBuilder._jsonParse(t),l.val(t.family),l.trigger("change"),n.find("option[value="+t.weight+"]").length&&n.val(t.weight))},_getFontWeights:function(i){var t=i.closest(".fl-font-field").find(".fl-font-field-weight"),l=i.val(),n=t.val(),s=FLBuilderConfig.FontWeights,o={},r=i.closest(".fl-font-field").find(".recent-fonts option");if(t.html(""),r.length>0){var a=e(r).filter(function(e,i){return i.value===l}).length>0;!1===a&&i.closest(".fl-font-field").find(".recent-fonts").append(e("<option>",{value:l,text:l}))}o="undefined"!=typeof FLBuilderFontFamilies.system[l]?FLBuilderFontFamilies.system[l].weights:"undefined"!=typeof FLBuilderFontFamilies.google[l]?FLBuilderFontFamilies.google[l]:FLBuilderFontFamilies["default"][l],e.each(o,function(e,i){var l=n===i?" selected":"";t.append('<option value="'+i+'"'+l+">"+s[i]+"</option>")})},_initTinyMCE:function(){"object"==typeof tinymce&&"undefined"!=typeof tinymce.ui.FloatPanel&&(tinymce.ui.FloatPanel.zIndex=100100),e(".fl-builder-hidden-editor").each(FLBuilder._initEditorField)},_initEditorFields:function(){e(".fl-builder-settings:visible .fl-editor-field").each(FLBuilder._initEditorField)},_initEditorField:function(){var i=e(this),t=i.find("textarea"),l=i.attr("data-name"),n="flrich"+(new Date).getTime()+"_"+l,s=FLBuilderConfig.wp_editor,o=tinyMCEPreInit,r=Number(i.attr("data-buttons")),a=i.attr("data-rows"),d=null,u=null;s=s.replace(/flbuildereditor/g,n),o=FLBuilder._jsonParse(JSON.stringify(o).replace(/flbuildereditor/g,n)),o=JSONfn.parse(JSONfn.stringify(o).replace(/flbuildereditor/g,n)),t.after(s).remove(),e("textarea#"+n).val(t.val()),void 0!==typeof tinymce&&void 0!==o.mceInit[n]&&(d=o.mceInit[n],d.setup=function(e){e.on("SaveContent",function(e){e.content=e.content.replace(/<a href="(\.\.\/){1,2}/g,'<a href="'+FLBuilderConfig.homeUrl+"/"),e.content=e.content.replace(/src="(\.\.\/){1,2}/g,'src="'+FLBuilderConfig.homeUrl+"/")})},u=tinymce.$("#wp-"+n+"-wrap"),u.find("textarea").attr("rows",a),r||u.find(".wp-media-buttons").remove(),!u.hasClass("tmce-active")&&o.qtInit.hasOwnProperty(n)||d.wp_skip_init||tinymce.init(d)),void 0!==typeof quicktags&&quicktags(o.qtInit[n]),window.wpActiveEditor=n},_reinitEditorFields:function(){e(".fl-lightbox-resizable:visible").length&&setTimeout(function(){var i,t;if("undefined"!=typeof tinymce){for(i=tinymce.editors.length-1;i>-1;i--)tinymce.editors[i].inline||(t=tinymce.editors[i].id,tinyMCE.execCommand("mceRemoveEditor",!0,t),tinyMCE.execCommand("mceAddEditor",!0,t));FLBuilder.preview&&FLBuilder.preview._initDefaultFieldPreviews(e('.fl-field[data-type="editor"]'))}},1)},_destroyEditorFields:function(){var i;if("undefined"!=typeof tinymce){for(i=tinymce.editors.length-1;i>-1;i--)tinymce.editors[i].inline||tinyMCE.execCommand("mceRemoveEditor",!0,tinymce.editors[i].id);e(".wplink-autocomplete").remove(),e(".ui-helper-hidden-accessible").remove()}},_updateEditorFields:function(){var i=e(".fl-builder-settings:visible textarea.wp-editor-area");i.each(FLBuilder._updateEditorField)},_updateEditorField:function(){var i=e(this),t=i.closest(".fl-editor-field"),l=(i.closest(".fl-builder-settings"),i.closest(".wp-editor-wrap")),n=i.attr("id"),s=t.attr("data-name"),o="undefined"!=typeof tinymce&&tinymce.get(n),r=i.siblings('textarea[name="'+s+'"]'),a=t.data("wpautop");0===r.length&&(r=e('<textarea name="'+s+'"></textarea>').hide(),i.after(r)),a?o&&l.hasClass("tmce-active")?r.val(o.getContent()):"undefined"!=typeof switchEditors?r.val(switchEditors.wpautop(i.val())):r.val(i.val()):(o&&l.hasClass("tmce-active")&&o.save(),r.val(i.val()))},_loopDataSourceChange:function(){var i=e(this).val();e(".fl-loop-data-source").hide(),e('.fl-loop-data-source[data-source="'+i+'"]').show()},_customQueryPostTypeChange:function(){var i=e(this).val();e(".fl-custom-query-filter").hide(),e(".fl-custom-query-"+i+"-filter").show()},_initOrderingFields:function(){e(".fl-builder-settings:visible .fl-ordering-field-options").each(FLBuilder._initOrderingField)},_initOrderingField:function(){e(this).sortable({items:".fl-ordering-field-option",containment:"parent",tolerance:"pointer",stop:FLBuilder._updateOrderingField})},_updateOrderingField:function(i){var t=e(i.target),l=t.siblings("input[type=hidden]"),n=[];t.find(".fl-ordering-field-option").each(function(){n.push(e(this).attr("data-key"))}),l.val(JSON.stringify(n)).trigger("change")},_textFieldAddValueSelectChange:function(){var i=e(this),t=e('input[name="'+i.data("target")+'"]'),l=t.val(),n=i.val(),s="";-1==l.indexOf(n)&&(s=(l.trim()+" "+n.trim()).trim(),t.val(s).trigger("change").trigger("keyup")),i.val("")},_onNumberFieldFocus:function(i){var t=e(i.currentTarget);t.addClass("mousetrap"),Mousetrap.bind("up",function(){t.attr("step",1)}),Mousetrap.bind("down",function(){t.attr("step",1)}),Mousetrap.bind("shift+up",function(){t.attr("step",10)}),Mousetrap.bind("shift+down",function(){t.attr("step",10)})},_onNumberFieldBlur:function(i){var t=e(i.currentTarget);t.attr("step","any").removeClass("mousetrap")},_initTimezoneFields:function(){e(".fl-builder-settings:visible .fl-field[data-type=timezone]").each(FLBuilder._initTimezoneField)},_initTimezoneField:function(){var i=e(this).find("select"),t=i.attr("data-value");i.find('option[value="'+t+'"]').prop("selected",!0)},_initDimensionFields:function(){var i=e(".fl-builder-settings:visible");i.find(".fl-field[data-type=dimension]").each(FLBuilder._initDimensionField),i.find(".fl-dimension-field-link").on("click",FLBuilder._dimensionFieldLinkClicked),FLBuilder.addHook("responsive-editing-switched",this._initResponsiveDimensionFieldLinking),i.find(".fl-compound-field-setting").has(".fl-dimension-field-link").each(FLBuilder._initDimensionFieldLinking)},_initDimensionField:function(){var i=e(this),t=i.find(".fl-field-label label"),l=i.find(".fl-field-control-wrapper"),n='<i class="fl-dimension-field-link fl-tip dashicons dashicons-admin-links" title="Link Values"></i>';t.append(n),l.prepend(n),FLBuilder._initTipTips(),FLBuilder._initDimensionFieldLinking.apply(this)},_initDimensionFieldLinking:function(){var i=e(this),t=i.find(".fl-dimension-field-link"),l=FLBuilder._getDimensionFieldLinkingInputs(i),n=FLBuilder._dimensionFieldInputsAreEqual(l);n?(t.removeClass("dashicons-admin-links"),t.addClass("dashicons-editor-unlink"),l.off("input",FLBuilder._dimensionFieldLinkedValueChange),l.on("input",FLBuilder._dimensionFieldLinkedValueChange)):(t.addClass("dashicons-admin-links"),t.removeClass("dashicons-editor-unlink"))},_initResponsiveDimensionFieldLinking:function(){var i=e(".fl-builder-settings:visible");i.find(".fl-field[data-type=dimension]").each(FLBuilder._initDimensionFieldLinking)},_dimensionFieldLinkClicked:function(){var i=e(this),t=i.closest(".fl-compound-field-setting"),l=t.length?t:i.closest(".fl-field"),n=l.find(".fl-dimension-field-link"),s=n.hasClass("dashicons-editor-unlink"),o=FLBuilder._getDimensionFieldLinkingInputs(l);n.toggleClass("dashicons-admin-links"),n.toggleClass("dashicons-editor-unlink"),s?o.off("input",FLBuilder._dimensionFieldLinkedValueChange):(o.val(o.eq(0).val()).trigger("input"),o.on("input",FLBuilder._dimensionFieldLinkedValueChange))},_dimensionFieldLinkedValueChange:function(){var i=e(this),t=i.attr("name"),l=i.closest(".fl-dimension-field-units"),n=l.find('input:not([name="'+t+'"])');n.off("input",FLBuilder._dimensionFieldLinkedValueChange),n.val(i.val()).trigger("input"),n.on("input",FLBuilder._dimensionFieldLinkedValueChange)},_getDimensionFieldLinkingInputs:function(e){var i=!!e.find(".fl-field-responsive-setting").length,t=FLBuilderResponsiveEditing._mode,l=null;return l=i?e.find(".fl-field-responsive-setting-"+t+" input"):e.find(".fl-dimension-field-unit input")},_dimensionFieldInputsAreEqual:function(e){var i=e.eq(0).val();if(""===i)return!1;for(var t=1;t<4;t++)if(e.eq(t).val()!==i)return!1;return!0},_initFieldPopupSliders:function(){var i=e(".fl-builder-settings:visible"),t=i.find(".fl-field-popup-slider");t.each(FLBuilder._initFieldPopupSlider)},_initFieldPopupSlider:function(){var i=e("body"),t=e(this),l=t.find(".fl-field-popup-slider-input"),n=t.find(".fl-field-popup-slider-arrow"),s=t.data("input"),o=e('input[name="'+s+'"]');o.on("click",function(){l.hasClass("fl-field-popup-slider-init")||(l.slider({value:o.val(),slide:function(e,i){o.val(i.value).trigger("input")}}),o.on("input",function(){l.slider("value",e(this).val())}),l.addClass("fl-field-popup-slider-init"),l.find(".ui-slider-handle").removeAttr("tabindex")),FLBuilder._setFieldPopupSliderMinMax(l),FLBuilder._hideFieldPopupSliders(),i.on("mousedown",FLBuilder._hideFieldPopupSliders),o.addClass("fl-field-popup-slider-focus"),t.show();var s=e(".fl-builder-settings:visible .fl-builder-settings-tab.fl-active"),r=s.offset(),a=o.offset(),d=o.width(),u=t.offset();u.top+t.outerHeight()>r.top+s.outerHeight()&&t.addClass("fl-field-popup-slider-top"),n.css("left",2+a.left-u.left+d/2+"px")}),o.on("focus",function(){FLBuilder._hideFieldPopupSliders()})},_hideFieldPopupSliders:function(i){var t=i?e(i.target):null,l=e("body"),n=e(".fl-field-popup-slider:visible"),s=e(".fl-field-popup-slider-focus");if(t){if(t.closest(".fl-field-popup-slider").length)return;if(t.closest(".fl-field-popup-slider-focus").length)return}l.off("mousedown",FLBuilder._hideFieldPopupSliders),
s.removeClass("fl-field-popup-slider-focus"),n.hide()},_setFieldPopupSliderMinMax:function(e){var i=e.parent(),t=i.parent().parent(),l=t.find("select.fl-field-unit-select"),n=l.val(),s=i.data("slider"),o=0,r=100,a=1;""!==n&&"em"!==n&&"rem"!==n||(r=10,a=.1),"object"==typeof s&&(o=s.min?parseFloat(s.min):o,r=s.max?parseFloat(s.max):r,a=s.step?parseFloat(s.step):a,l.length&&s[n]&&(o=s[n].min?parseFloat(s[n].min):o,r=s[n].max?parseFloat(s[n].max):r,a=s[n].step?parseFloat(s[n].step):a)),e.slider({min:o,max:r,step:a})},_initPresetFields:function(){var i=e(".fl-builder-settings:visible"),t=i.find(".fl-preset-select-controls");t.each(FLBuilder._initPresetField)},_initPresetField:function(){var i=e(this),t=i.find("select"),l=i.data("presets"),n=i.data("prefix");t.on("change",FLBuilder._setFormPreset.bind(this,l,n))},_setFormPreset:function(i,t,l){var n=e(l.currentTarget).val();if(presetLists=FLBuilderConfig.presets,presets=presetLists[i],form=e(".fl-builder-settings:visible"),"undefined"!==presets&&"undefined"!==presets[n]){var s=presets[n].settings;for(var o in s){var r,n=s[o];r="undefined"!=typeof t&&""!==t?form.find('[name="'+t+o+'"]'):form.find('[name="'+o+'"]'),r.val(n).trigger("change").trigger("input")}}},ajax:function(i,t){var l;if(FLBuilder._ajaxRequest)return void FLBuilder._ajaxQueue.push({data:i,callback:t});FLBuilder.triggerHook("didBeginAJAX",i);for(l in i)"undefined"==typeof i[l]&&(i[l]=null);return i._wpnonce=FLBuilderConfig.ajaxNonce,i.post_id=FLBuilderConfig.postId,i.fl_builder=1,i.fl_action=i.action,"undefined"!=typeof i.settings&&(i.settings=FLBuilder._ajaxModSecFix(e.extend(!0,{},i.settings))),"undefined"!=typeof i.node_settings&&(i.node_settings=FLBuilder._ajaxModSecFix(e.extend(!0,{},i.node_settings))),"undefined"!=typeof i.node_preview&&(i.node_preview=FLBuilder._ajaxModSecFix(e.extend(!0,{},i.node_preview))),i.settings=FLBuilder._inputVarsCheck(i.settings),i.node_settings=FLBuilder._inputVarsCheck(i.node_settings),"error"===i.settings||"error"===i.node_settings?0:(i={fl_builder_data:i},FLBuilder._ajaxRequest=e.post(FLBuilder._ajaxUrl(),i,function(e){"undefined"!=typeof t&&t.call(this,e),FLBuilder.triggerHook("didCompleteAJAX",i)}).always(FLBuilder._ajaxComplete).fail(function(e,i,t){switch(msg=!1,e.status){case 403:case 409:msg="Something you entered has triggered a "+e.status+" error.<br /><br />This is nearly always due to mod_security settings from your hosting provider.",window.crash_vars.white_label||(msg+='<br /><br />See this <a target="_blank" style="color: #428bca;font-size:inherit" href="https://kb.wpbeaverbuilder.com/article/40-403-forbidden-or-blocked-error">Knowledge Base</a> article for more info.</br />')}msg&&(console.log(e),console.log(t),FLBuilder.alert(msg))}),FLBuilder._ajaxRequest)},_inputVarsCheck:function(i){var t=FLBuilderConfig.MaxInputVars||0;return"undefined"!=typeof i&&t>0&&(count=e.map(i,function(e,i){return i}).length,count>t)?(FLBuilder.alert('<h1 style="font-size:2em;text-align:center">Critical Issue</h1><br />The number of settings being saved ('+count+") exceeds the PHP Max Input Vars setting ("+t+").<br />Please contact your host to have this value increased, the default is 1000."),console.log("Vars Count: "+count),console.log("Max Input: "+t),"error"):i},_ajaxComplete:function(){if(FLBuilder._ajaxRequest=null,FLBuilder.hideAjaxLoader(),FLBuilder._ajaxQueue.length){var e=FLBuilder._ajaxQueue.shift();FLBuilder.ajax(e.data,e.callback)}},_ajaxUrl:function(e){var i=window.location.href.split("#").shift(),t=null;if("undefined"!=typeof e)for(t in e)i+=i.indexOf("?")>-1?"&":"?",i+=t+"="+e[t];return i},showAjaxLoader:function(){0===e(".fl-builder-lightbox-loading").length&&e(".fl-builder-loading").show()},hideAjaxLoader:function(){e(".fl-builder-loading").hide()},_showNodeLoading:function(i){var t=e(".fl-node-"+i);t.addClass("fl-builder-node-loading"),FLBuilder._removeAllOverlays(),FLBuilder.triggerHook("didStartNodeLoading",t)},_hideNodeLoading:function(i){var t=e(".fl-node-"+i);t.removeClass("fl-builder-node-loading")},_showNodeLoadingPlaceholder:function(i,t){var l=e('<div class="fl-builder-node-loading-placeholder"></div>');e(".fl-builder-node-loading-placeholder").remove(),i.hasClass("fl-builder-content")?siblings=i.find(" > .fl-row"):i.hasClass("fl-row-content")?siblings=i.find(" > .fl-col-group"):i.hasClass("fl-col-group")?(i.addClass("fl-col-group-has-child-loading"),siblings=i.find(" > .fl-col")):siblings=i.find(" > .fl-col-group, > .fl-module"),0===siblings.length||siblings.length==t?i.append(l):siblings.eq(t).before(l)},_removeNodeLoadingPlaceholder:function(e){var i=e.prev(".fl-builder-node-loading-placeholder"),t=e.next(".fl-builder-node-loading-placeholder");i.length?i.remove():t.remove()},_ajaxModSecFix:function(e){var i;if(FLBuilderConfig.modSecFix&&"undefined"!=typeof btoa)if("string"==typeof e)e=FLBuilder._btoa(e);else for(i in e)"string"==typeof e[i]?e[i]=FLBuilder._btoa(e[i]):"object"==typeof e[i]&&(e[i]=FLBuilder._ajaxModSecFix(e[i]));return e},_btoa:function(e){return btoa(encodeURIComponent(e).replace(/%([0-9A-F]{2})/g,function(e,i){return String.fromCharCode("0x"+i)}))},_wpmedia_reset_errors:function(){e(".upload-error").remove(),e(".media-uploader-status").removeClass("errors").hide()},_initLightboxes:function(){FLBuilder._lightbox=new FLLightbox({className:"fl-builder-lightbox fl-builder-settings-lightbox",resizable:!0}),FLBuilder._lightbox.on("resized",FLBuilder._calculateSettingsTabsOverflow),FLBuilder._lightbox.on("close",FLBuilder._lightboxClosed),FLBuilder._lightbox.on("beforeCloseLightbox",FLBuilder._destroyEditorFields),FLBuilder._actionsLightbox=new FLLightbox({className:"fl-builder-actions-lightbox"})},_showLightbox:function(e){e||(e='<div class="fl-builder-lightbox-loading"></div>'),FLBuilder._lightbox.open(e),FLBuilder._initLightboxScrollbars()},_setLightboxContent:function(e){FLBuilder._lightbox.setContent(e)},_initLightboxScrollbars:function(){FLBuilder._initScrollbars(),clearTimeout(FLBuilder._lightboxScrollbarTimeout),FLBuilder._lightboxScrollbarTimeout=setTimeout(FLBuilder._initLightboxScrollbars,500)},_lightboxClosed:function(){FLBuilder.triggerHook("settings-lightbox-closed"),FLBuilder._lightbox.empty(),clearTimeout(FLBuilder._lightboxScrollbarTimeout),FLBuilder._lightboxScrollbarTimeout=null},_showActionsLightbox:function(e){var i=wp.template("fl-actions-lightbox");FLBuilder.triggerHook("actions-lightbox-settings",e),FLBuilder._actionsLightbox.open(i(e))},alert:function(e){var i=new FLLightbox({className:"fl-builder-alert-lightbox",destroyOnClose:!0}),t=wp.template("fl-alert-lightbox");i.open(t({message:e}))},crashMessage:function(e){FLLightbox.closeAll();var i=new FLLightbox({className:"fl-builder-alert-lightbox fl-builder-crash-lightbox",destroyOnClose:!0}),t=wp.template("fl-crash-lightbox"),l=window.crash_vars.product,n=window.crash_vars.white_label,s=window.crash_vars.labeled_txt;message=l+" has detected a plugin conflict that is preventing the page from saving.<p>( In technical terms there’s probably a PHP error in Ajax. )</p>",info="<p>If you contact Beaver Builder Support, we need to know what the error is in the JavaScript console in your browser.</p>",info+="<div><div style='width:49%;float:left;'>",info+="<p>MacOS Users:<br />Chrome: View > Developer > JavaScript Console<br />Firefox: Tools > Web Developer > Browser Console<br />Safari: Develop > Show JavaScript console</p>",info+="</div>",info+="<div style='width:49%;float:right;'>",info+="<p>Windows Users:<br />Chrome: Settings > More Tools > Developer > Console<br />Firefox: Menu/Settings > Web Developer > Web Console<br />Edge: Settings and More > More Tools > Console</p>",info+="</div></div>",info+="<p style='display:inline-block;'>Copy the errors you find there and submit them with your Support ticket. It saves us having to ask you that as a second step.<br /><br />If you want to troubleshoot further, you can check our <a class='link' target='_blank' href='https://kb.wpbeaverbuilder.com/article/42-known-beaver-builder-incompatibilities'>Knowledge Base</a> for plugins we know to be incompatible. Then deactivate your plugins one by one while you try to save the page in the Beaver Builder editor. When the page saves normally, you have identified the plugin causing the conflict. <a class='link' target='_blank' href='https://www.wpbeaverbuilder.com/beaver-builder-support/'>Contact Support</a> if you need further help.</p>",FLBuilderConfig.MaxInputVars<=3e3&&(info+="<br /><br />The PHP config value max_input_vars is only set to "+FLBuilderConfig.MaxInputVars+'. If you are using 3rd party addons this could very likely be the cause of this error. [<a class="link" href="https://kb.wpbeaverbuilder.com/article/746-troubleshooting-number-of-settings-being-saved-exceeds-php-max-input-vars">doc link</a>].'),e=!1,n&&(info=s),i.open(t({message:message,info:info,debug:e}))},_alertClose:function(){FLLightbox.closeParent(this)},confirm:function(i){var t={message:"",ok:function(){},cancel:function(){},strings:{ok:FLBuilderStrings.ok,cancel:FLBuilderStrings.cancel}},l=e.extend({},t,"undefined"==typeof i?{}:i);lightbox=new FLLightbox({className:"fl-builder-confirm-lightbox fl-builder-alert-lightbox",destroyOnClose:!0}),template=wp.template("fl-confirm-lightbox"),lightbox.open(template(l)),lightbox._node.find(".fl-builder-confirm-ok").on("click",l.ok),lightbox._node.find(".fl-builder-confirm-cancel").on("click",l.cancel)},triggerHook:function(i,t){e("body").trigger("fl-builder."+i,t)},addHook:function(i,t){e("body").on("fl-builder."+i,t)},removeHook:function(i,t){e("body").off("fl-builder."+i,t)},log:function(e){"undefined"!=typeof window.console&&"undefined"!=typeof window.console.log&&console.log(e)},logError:function(i,t){var l=null;"undefined"!=typeof i&&("undefined"!=typeof i.stack?l=i.stack:"undefined"!=typeof i.message&&(l=i.message),l&&(FLBuilder.log("************************************************************************"),FLBuilder.log(FLBuilderStrings.errorMessage),FLBuilder.log(l),"undefined"!=typeof t&&t&&(FLBuilder.log("Debug Info"),console.log(t)),e.each(window.crash_vars.vars,function(e,i){console.log(e+": "+i)}),FLBuilder.log("************************************************************************"),"undefined"!=typeof t&&t&&(l=t+"\n"+l),FLBuilder.crashMessage(l)))},logGlobalError:function(e,i,t,l,n){FLBuilder.log("************************************************************************"),FLBuilder.log(FLBuilderStrings.errorMessage),FLBuilder.log(FLBuilderStrings.globalErrorMessage.replace("{message}",e).replace("{line}",t).replace("{file}",i)),"undefined"!=typeof n&&"undefined"!=typeof n.stack&&FLBuilder.log(n.stack),FLBuilder.log("************************************************************************")},_jsonParse:function(e){try{e=JSON.parse(e)}catch(i){FLBuilder.logError(i,FLBuilder._parseError(e))}return e},_parseError:function(i){if(i.indexOf("</head>"))return"AJAX returned HTML page instead of data. (Possible 404 or max_input_vars)";if(php=i.match(/^<.*/gm)||!1,php&&php.length>0){var t="";return e.each(php,function(e,i){t+=i}),e(t).text()}return!1},isUndefined:function(e){return void 0===e},isBoolean:function(e){return e===!0||e===!1}},e(function(){FLBuilder._init()})}(jQuery),function(e){FLBuilderAJAXLayout=function(i,t){this._data=e.extend({},this._defaults,"string"==typeof i?FLBuilder._jsonParse(i):i),this._callback=t,this._post=FLBuilderConfig.postId,this._head=e("head").eq(0),this._body=e("body").eq(0),this._data.css&&("inline"===FLBuilderConfig.enqueueMethod?(this._oldCss=e("#fl-builder-layout-"+this._post+"-inline-css"),this._newCss=e('<style id="fl-builder-layout-'+this._post+'-inline-css" type="text/css">'+this._data.css+"</style>")):(this._loader=e('<img src="'+this._data.css+'" />'),this._oldCss=e('link[href*="/cache/'+this._post+'-layout"]'),this._newCss=e('<link rel="stylesheet" id="fl-builder-layout-'+this._post+'-css"  href="'+this._data.css+'" />'))),this._data.partial?(this._data.js&&(this._oldJs=e("#fl-builder-partial-refresh-js"),this._newJs=e('<script type="text/javascript" id="fl-builder-partial-refresh-js">'+this._data.js+"</script>")),this._data.nodeId&&(this._data.oldNodeId?(this._oldScriptsStyles=e('.fl-builder-node-scripts-styles[data-node="'+this._data.oldNodeId+'"]'),this._content=e(".fl-node-"+this._data.oldNodeId)):(this._oldScriptsStyles=e('.fl-builder-node-scripts-styles[data-node="'+this._data.nodeId+'"]'),this._content=e(".fl-node-"+this._data.nodeId).eq(0)))):("inline"===FLBuilderConfig.enqueueMethod?(this._oldJs=e("#fl-builder-layout-"+this._post+"-inline-js"),this._newJs=e('<script id="fl-builder-layout-'+this._post+'-inline-js">'+this._data.js+"</script>")):(this._oldJs=e('script[src*="/cache/'+this._post+'"]'),this._newJs=e('<script src="'+this._data.js+'"></script>')),this._oldScriptsStyles=e(".fl-builder-layout-scripts-styles"),this._content=e(FLBuilder._contentClass)),this._init()},FLBuilderAJAXLayout.prototype={_defaults:{partial:!1,nodeId:null,nodeType:null,nodeParent:null,nodePosition:null,oldNodeId:null,html:null,scriptsStyles:null,css:null,js:null},_data:null,_callback:function(){},_post:null,_head:null,_body:null,_loader:null,_oldCss:null,_newCss:null,_oldJs:null,_newJs:null,_oldScriptsStyles:null,_content:null,_init:function(){this._body.height(this._body.height()),this._data.css?"inline"===FLBuilderConfig.enqueueMethod?(this._addNewCSS(),this._finish()):"onload"in document.createElement("link")?(this._newCss.on("load",e.proxy(this._finish,this)),this._addNewCSS()):(this._loader.on("error",e.proxy(this._loadNewCSSFallbackComplete,this)),this._body.append(this._loader)):this._finish()},_loadNewCSSFallbackComplete:function(){this._loader.remove(),this._addNewCSS(),setTimeout(e.proxy(this._finish,this),250)},_addNewCSS:function(){this._oldCss.length>0?this._oldCss.after(this._newCss):this._head.append(this._newCss)},_finish:function(){this._removeOldContentAndAssets(),this._cleanNewHTML(),this._cleanNewAssets(),this._addNewHTML(),this._addNewScriptsStyles(),this._addNewJS(),e(FLBuilder._contentClass).trigger("fl-builder.layout-rendered"),FLBuilder.hideAjaxLoader()},_removeOldContentAndAssets:function(){this._content&&this._content.empty(),this._oldCss&&this._oldCss.remove(),this._oldJs&&this._oldJs.remove(),this._oldScriptsStyles&&this._oldScriptsStyles.remove()},_cleanNewHTML:function(){if(this._data.scriptsStyles){var i=e("<div>"+this._data.html+"</div>"),t="fl-row",l=this._data.scriptsStyles,n="";this._data.partial&&(t="column-group"==this._data.nodeType?"fl-col-group":"column"==this._data.nodeType?"fl-col":"fl-"+this._data.nodeType),i.find("> *, script").each(function(){e(this).hasClass(t)||"application/json"==e(this).attr("type")||(n=e(this).remove(),l+=n[0].outerHTML)}),""!==l&&(l=this._data.partial?'<div class="fl-builder-node-scripts-styles" data-node="'+this._data.nodeId+'">'+l+"<div>":'<div class="fl-builder-node-scripts-styles">'+l+"<div>"),this._data.html=i.html(),this._data.scriptsStyles=l}},_addNewHTML:function(){var i;if(this._data.partial?this._data.nodeParent?(i=this._data.nodeParent.hasClass("fl-builder-content")?this._data.nodeParent.find(" > .fl-row"):this._data.nodeParent.hasClass("fl-row-content")?this._data.nodeParent.find(" > .fl-col-group"):this._data.nodeParent.hasClass("fl-col-group")?this._data.nodeParent.find(" > .fl-col"):this._data.nodeParent.find(" > .fl-col-group, > .fl-module"),i=i.filter(":not(.fl-builder-node-clone)"),0===i.length||this._data.nodePosition>=i.length?this._data.nodeParent.append(this._data.html):i.eq(this._data.nodePosition).before(this._data.html),this._data.nodeId&&FLBuilder._removeNodeLoadingPlaceholder(e(".fl-node-"+this._data.nodeId))):(this._content.after(this._data.html),this._content.remove()):this._content.append(this._data.html),FLBuilder.preview&&this._data.nodeId&&this._data.nodeId!=FLBuilder.preview.nodeId){var t=e(FLBuilder.preview.classes.node),l=t.closest(".fl-node-"+this._data.nodeId).length;l&&t.html(FLBuilder.preview.elements.node.html())}this._data.onAddNewHTML&&this._data.onAddNewHTML()},_cleanNewAssets:function(){var i=this;this._data.html=this._removeDuplicateAssets(this._data.html),this._data.scriptsStyles&&""!==this._data.scriptsStyles&&(this._data.scriptsStyles=this._removeDuplicateAssets(this._data.scriptsStyles)),this._data.partial?e(".fl-builder-node-scripts-styles").each(function(){i._data.html.indexOf("fl-node-"+e(this).data("node"))>-1&&e(this).remove()}):(e("#fl-builder-partial-refresh-js").remove(),e(".fl-builder-node-scripts-styles").remove())},_removeDuplicateAssets:function(i){var t=e("<div>"+i+"</div>"),l="",n=null,s="",o=null,r=window.location,a=r.protocol+"//"+r.hostname+(r.port?":"+r.port:"");return t.find("script").each(function(){l=e(this).attr("src"),"undefined"!=typeof l&&(l=l.replace(a,""),n=e('script[src*="'+l+'"]'),n.length>0&&e(this).remove())}),t.find("link").each(function(){s=e(this).attr("href"),"undefined"!=typeof s&&(s=s.replace(a,""),o=e('link[href*="'+s+'"]'),o.length>0&&e(this).remove())}),t.html()},_addNewScriptsStyles:function(){this._data.scriptsStyles&&""!==this._data.scriptsStyles&&this._body.append(this._data.scriptsStyles)},_addNewJS:function(){setTimeout(e.proxy(function(){this._newJs&&this._head.append(this._newJs),FLBuilder.triggerHook("didRenderLayoutJSComplete")},this),50)},_complete:function(){FLBuilder._dragging?(FLBuilder._highlightRowsAndColsForDrag(),FLBuilder._refreshSortables()):(FLBuilder._setupEmptyLayout(),FLBuilder._highlightEmptyCols(),FLBuilder._initDropTargets(),FLBuilder._initSortables(),FLBuilder._resizeLayout()),FLBuilder._initMediaElements(),FLBuilderLayout.init(),FLBuilderResponsiveEditing.refreshPreview(this._callback),FLBuilder.triggerHook("didRenderLayoutComplete"),this._body.height("auto")}}}(jQuery),function(e){FLBuilderPreview=function(e){this.id=(new Date).getTime(),this.type=e.type,this._saveState(),e.layout?FLBuilder._renderLayout(e.layout,function(){this._init(),e.callback&&e.callback()}.bind(this)):this._init()},FLBuilderPreview._fontsList={},FLBuilderPreview.getFormattedSelector=function(e,i){for(var t="",l=i.split(","),n=0;n<l.length;n++)t+=l[n].indexOf("{node}")>-1?l[n].replace("{node}",e):l[n].indexOf("{node_id}")>-1?l[n].replace(/{node_id}/g,this.nodeId):e+" "+l[n],n!=l.length-1&&(t+=", ");return t},FLBuilderPreview.prototype={id:"",type:"",nodeId:null,classes:{},elements:{},state:null,_savedSettings:null,_styleSheet:null,_styleSheetMedium:null,_styleSheetResponsive:null,_timeout:null,_loaderTimeout:null,_lastClassName:null,_xhr:null,_init:function(){switch(this.nodeId=e(".fl-builder-settings").data("node"),this._saveSettings(),this._initElementsAndClasses(),this._createSheets(),this._initResponsivePreviews(),this._initDefaultFieldPreviews(),this.type){case"row":this._initRow();break;case"col":this._initColumn();break;case"module":this._initModule()}FLBuilder.triggerHook("preview-init",this)},_saveSettings:function(){var i=e(".fl-builder-settings-lightbox .fl-builder-settings");this._savedSettings=FLBuilder._getSettingsForChangedCheck(this.nodeId,i)},_settingsHaveChanged:function(){var i=e(".fl-builder-settings-lightbox .fl-builder-settings"),t=FLBuilder._getSettings(i);return JSON.stringify(this._savedSettings)!=JSON.stringify(t)},_initElementsAndClasses:function(){var i;i="row"==this.type?".fl-row-content-wrap":".fl-"+this.type+"-content",e.extend(this.classes,{settings:".fl-builder-"+this.type+"-settings",settingsHeader:".fl-builder-"+this.type+"-settings .fl-lightbox-header",node:FLBuilder._contentClass+" .fl-node-"+this.nodeId,content:FLBuilder._contentClass+" .fl-node-"+this.nodeId+" > "+i}),e.extend(this.elements,{settings:e(this.classes.settings),settingsHeader:e(this.classes.settingsHeader),node:e(this.classes.node),content:e(this.classes.content)})},_createSheets:function(){this._destroySheets(),this._styleSheet||(this._styleSheet=new FLStyleSheet({id:"fl-builder-preview",className:"fl-builder-preview-style"})),this._styleSheetMedium||(this._styleSheetMedium=new FLStyleSheet({id:"fl-builder-preview-medium",className:"fl-builder-preview-style"}),this._styleSheetMedium.disable()),this._styleSheetResponsive||(this._styleSheetResponsive=new FLStyleSheet({id:"fl-builder-preview-responsive",className:"fl-builder-preview-style"}),this._styleSheetResponsive.disable())},_destroySheets:function(){this._styleSheet&&(this._styleSheet.destroy(),this._styleSheet=null),this._styleSheetMedium&&(this._styleSheetMedium.destroy(),this._styleSheetMedium=null),this._styleSheetResponsive&&(this._styleSheetResponsive.destroy(),this._styleSheetResponsive=null)},_disableStyles:function(){var e=FLBuilderResponsiveEditing._mode,i=FLBuilderConfig.global,t=this.elements.node;"responsive"===e?(FLBuilderSimulateMediaQuery.disableStyles(i.responsive_breakpoint),this._styleSheetResponsive.disable()):"medium"===e?(FLBuilderSimulateMediaQuery.disableStyles(i.medium_breakpoint),this._styleSheetMedium.disable()):t.removeClass(function(e,i){return(i.match(/fl-node-[^\s]*/g)||[]).join(" ")})},_enableStyles:function(){var e=FLBuilderResponsiveEditing._mode,i=this.elements.node;"responsive"===e?(FLBuilderSimulateMediaQuery.enableStyles(),this._styleSheetResponsive.enable()):"medium"===e?(FLBuilderSimulateMediaQuery.enableStyles(),this._styleSheetMedium.enable()):i.addClass("fl-node-"+i.data("node"))},_getDefaultValue:function(i,t){var l="",n=e(i),s=n.closest("[data-node]"),o=["line-height","font-weight"];return"width"===t?l="auto":-1===e.inArray(t,o)&&s.length&&(this._disableStyles(),l=n.css(t),this._enableStyles()),l},updateCSSRule:function(e,i,t,l){var n=FLBuilderResponsiveEditing._mode,s="";""!==t&&"null"!==t||(t=this._getDefaultValue(e,i)),l?(s="string"==typeof l?this.toUpperCaseWords(l):"default"===n?"":this.toUpperCaseWords(n),this["_styleSheet"+s].updateRule(e,i,t)):this._styleSheet.updateRule(e,i,t)},delay:function(e,i){this._cancelDelay(),this._timeout=setTimeout(i,e)},_cancelDelay:function(){null!==this._timeout&&clearTimeout(this._timeout)},hexToRgb:function(e){var i=parseInt(e,16),t=i>>16&255,l=i>>8&255,n=255&i;return[t,l,n]},hexOrRgb:function(e){return e.indexOf("rgb")<0&&e.indexOf("#")<0&&(e="#"+e),e},parseFloat:function(e){return isNaN(parseFloat(e))?0:parseFloat(e)},_initResponsivePreviews:function(){var i=".preview-"+this.id;FLBuilder.addHook("responsive-editing-switched"+i,e.proxy(this._responsiveEditingSwitched,this)),FLBuilder.addHook("responsive-editing-before-preview-fields"+i,e.proxy(this._responsiveEditingPreviewFields,this))},_destroyResponsivePreviews:function(){var e=".preview-"+this.id;FLBuilder.removeHook("responsive-editing-switched"+e),FLBuilder.removeHook("responsive-editing-before-preview-fields"+e)},_responsiveEditingSwitched:function(e,i){"default"==i?(this._styleSheetMedium.disable(),this._styleSheetResponsive.disable()):"medium"==i?(this._styleSheetMedium.enable(),this._styleSheetResponsive.disable()):"responsive"==i&&(this._styleSheetMedium.enable(),this._styleSheetResponsive.enable())},_responsiveEditingPreviewFields:function(e,i){"medium"===i&&"col"===this.type&&this.elements.node[0].style.width&&(size=parseFloat(this.elements.node[0].style.width),this.elements.size.val(size))},updateResponsiveCSSRule:function(e,i,t){this.updateCSSRule(e,i,t,!0)},_saveState:function(){var i=FLBuilderConfig.postId,t=e('link[href*="/cache/'+i+'"]').attr("href"),l=e('script[src*="/cache/'+i+'"]').attr("src"),n=e(FLBuilder._contentClass).html();this.state={css:t,js:l,html:n}},preview:function(){var i=e(".fl-builder-settings-lightbox .fl-builder-settings"),t=i.attr("data-node"),l=FLBuilder._getSettings(i);return FLBuilder._showNodeLoading(t),this._cancelPreview(),l=FLBuilder._inputVarsCheck(l),"error"===l?0:void(this._xhr=FLBuilder.ajax({action:"render_layout",node_id:t,node_preview:l},e.proxy(this._renderPreview,this)))},delayPreview:function(i){var t="undefined"==typeof i?[]:e(i.target).closest("tr").find("th"),l=e(".fl-builder-widget-settings .fl-builder-settings-title"),n=e(".fl-builder-settings .fl-lightbox-header"),s=FLBuilderLayoutConfig.paths.pluginUrl+"img/ajax-loader-small.svg",o=e('<img class="fl-builder-preview-loader" src="'+s+'" />');this.delay(1e3,e.proxy(this.preview,this)),this._loaderTimeout=setTimeout(function(){e(".fl-builder-preview-loader").remove(),t.length>0?t.append(o):l.length>0?l.append(o):n.length>0&&n.append(o)},1500)},_cancelPreview:function(){this._xhr&&(this._xhr.abort(),this._xhr=null)},_renderPreview:function(i){this._xhr=null,FLBuilder._renderLayout(i,e.proxy(this._renderPreviewComplete,this))},_renderPreviewComplete:function(){this._createSheets(),this._initElementsAndClasses(),this._initDefaultFieldPreviews(),null!==this._loaderTimeout&&clearTimeout(this._loaderTimeout),e(".fl-builder-preview-loader").remove(),e(FLBuilder._contentClass).trigger("fl-builder.preview-rendered")},revert:function(){var e=this.nodeId;return this._settingsHaveChanged()?("col"===this.type&&(e=this.elements.node.closest(".fl-col-group").data("node")),void FLBuilder._updateNode(e,function(){this.clear()}.bind(this))):void this.clear()},cancel:function(){this._cancelDelay(),this._cancelPreview()},clear:function(){this.cancel(),this._destroySheets(),this._destroyResponsivePreviews()},_initNodeTextColor:function(){e.extend(this.elements,{textColor:e(this.classes.settings+" input[name=text_color]"),linkColor:e(this.classes.settings+" input[name=link_color]"),hoverColor:e(this.classes.settings+" input[name=hover_color]"),headingColor:e(this.classes.settings+" input[name=heading_color]")}),this.elements.textColor.on("change",e.proxy(this._textColorChange,this)),this.elements.linkColor.on("change",e.proxy(this._textColorChange,this)),this.elements.hoverColor.on("change",e.proxy(this._textColorChange,this)),this.elements.headingColor.on("change",e.proxy(this._textColorChange,this))},_textColorChange:function(i){var t=this.elements.textColor.val(),l=this.elements.linkColor.val(),n=this.elements.hoverColor.val(),s=this.elements.headingColor.val();l=""===l?t:l,n=""===n?t:n,s=""===s?t:s,t&&t.indexOf("rgb")<0&&(t="#"+t),l&&l.indexOf("rgb")<0&&(l="#"+l),n&&n.indexOf("rgb")<0&&(n="#"+n),s&&s.indexOf("rgb")<0&&(s="#"+s),this.delay(50,e.proxy(function(){""===t?this.updateCSSRule(this.classes.node,"color",""):this.updateCSSRule(this.classes.node,"color",t),""===l?this.updateCSSRule(this.classes.node+" a","color",""):this.updateCSSRule(this.classes.node+" a","color",l),""===n?this.updateCSSRule(this.classes.node+" a:hover","color",""):this.updateCSSRule(this.classes.node+" a:hover","color",n),""===s?(this.updateCSSRule(this.classes.node+" h1","color",""),this.updateCSSRule(this.classes.node+" h2","color",""),this.updateCSSRule(this.classes.node+" h3","color",""),this.updateCSSRule(this.classes.node+" h4","color",""),this.updateCSSRule(this.classes.node+" h5","color",""),this.updateCSSRule(this.classes.node+" h6","color",""),this.updateCSSRule(this.classes.node+" h1 a","color",""),this.updateCSSRule(this.classes.node+" h2 a","color",""),this.updateCSSRule(this.classes.node+" h3 a","color",""),this.updateCSSRule(this.classes.node+" h4 a","color",""),this.updateCSSRule(this.classes.node+" h5 a","color",""),this.updateCSSRule(this.classes.node+" h6 a","color","")):(this.updateCSSRule(this.classes.node+" h1","color",s),this.updateCSSRule(this.classes.node+" h2","color",s),this.updateCSSRule(this.classes.node+" h3","color",s),this.updateCSSRule(this.classes.node+" h4","color",s),this.updateCSSRule(this.classes.node+" h5","color",s),this.updateCSSRule(this.classes.node+" h6","color",s),this.updateCSSRule(this.classes.node+" h1 a","color",s),this.updateCSSRule(this.classes.node+" h2 a","color",s),this.updateCSSRule(this.classes.node+" h3 a","color",s),this.updateCSSRule(this.classes.node+" h4 a","color",s),this.updateCSSRule(this.classes.node+" h5 a","color",s),this.updateCSSRule(this.classes.node+" h6 a","color",s))},this))},_initNodeBg:function(){e.extend(this.elements,{bgType:e(this.classes.settings+" select[name=bg_type]"),bgColor:e(this.classes.settings+" input[name=bg_color]"),bgColorPicker:e(this.classes.settings+" .fl-picker-bg_color"),bgGradientType:e(this.classes.settings+" select.fl-gradient-picker-type-select"),bgVideoSource:e(this.classes.settings+" select[name=bg_video_source]"),bgVideo:e(this.classes.settings+" input[name=bg_video]"),bgVideoServiceUrl:e(this.classes.settings+" input[name=bg_video_service_url]"),bgVideoFallbackSrc:e(this.classes.settings+" select[name=bg_video_fallback_src]"),bgSlideshowSource:e(this.classes.settings+" select[name=ss_source]"),bgSlideshowPhotos:e(this.classes.settings+" input[name=ss_photos]"),bgSlideshowFeedUrl:e(this.classes.settings+" input[name=ss_feed_url]"),bgSlideshowSpeed:e(this.classes.settings+" input[name=ss_speed]"),bgSlideshowTrans:e(this.classes.settings+" select[name=ss_transition]"),bgSlideshowTransSpeed:e(this.classes.settings+" input[name=ss_transitionDuration]"),bgParallaxImageSrc:e(this.classes.settings+" select[name=bg_parallax_image_src]"),bgOverlayType:e(this.classes.settings+" select[name=bg_overlay_type]"),bgOverlayColor:e(this.classes.settings+" input[name=bg_overlay_color]"),bgOverlayGradient:e(this.classes.settings+" #fl-field-bg_overlay_gradient select")}),this.elements.bgType.on("change",e.proxy(this._bgTypeChange,this)),this.elements.bgColor.on("change",e.proxy(this._bgColorChange,this)),this.elements.bgVideoServiceUrl.on("change",e.proxy(this._bgVideoChange,this)),this.elements.bgSlideshowSource.on("change",e.proxy(this._bgSlideshowChange,this)),this.elements.bgSlideshowPhotos.on("change",e.proxy(this._bgSlideshowChange,this)),this.elements.bgSlideshowFeedUrl.on("keyup",e.proxy(this._bgSlideshowChange,this)),this.elements.bgSlideshowSpeed.on("keyup",e.proxy(this._bgSlideshowChange,this)),this.elements.bgSlideshowTrans.on("change",e.proxy(this._bgSlideshowChange,this)),this.elements.bgSlideshowTransSpeed.on("keyup",e.proxy(this._bgSlideshowChange,this)),this.elements.bgParallaxImageSrc.on("change",e.proxy(this._bgParallaxChange,this)),this.elements.bgOverlayType.on("change",e.proxy(this._bgOverlayChange,this)),this.elements.bgOverlayColor.on("change",e.proxy(this._bgOverlayChange,this))},_bgTypeChange:function(e){var i=this.elements.bgType.val(),t=FLBuilderResponsiveEditing._mode;this.elements.node.removeClass("fl-row-bg-video"),this.elements.node.removeClass("fl-row-bg-slideshow"),this.elements.node.removeClass("fl-row-bg-parallax"),this.elements.node.find(".fl-bg-video").remove(),this.elements.node.find(".fl-bg-slideshow").remove(),this.elements.content.css("background-image",""),this.updateCSSRule(this.classes.content,"background-color","transparent"),this.updateCSSRule(this.classes.content,"background-image","none"),this.updateCSSRule(this.classes.content,"background-image","none","medium"),this.updateCSSRule(this.classes.content,"background-image","none","responsive"),"none"==i?this._bgOverlayClear():"color"==i?(this.elements.bgColor.trigger("change"),this._bgOverlayClear()):"gradient"==i?(this.elements.bgGradientType.trigger("change"),this._bgOverlayClear()):"photo"==i?(this.elements.bgColor.trigger("change"),this.elements.settings.find('[data-device="'+t+'"] select[name*="bg_"]').trigger("change")):"video"==i?(this.elements.bgColor.trigger("change"),this._bgVideoChange()):"slideshow"==i?(this.elements.bgColor.trigger("change"),this._bgSlideshowChange()):"parallax"==i&&(this.elements.bgColor.trigger("change"),this.elements.bgParallaxImageSrc.trigger("change"))},_bgColorChange:function(i){var t;""===this.elements.bgColor.val()?this.updateCSSRule(this.classes.content,"background-color","transparent"):(t=this.hexOrRgb(this.elements.bgColor.val()),this.delay(100,e.proxy(function(){this.updateCSSRule(this.classes.content,"background-color",t)},this)))},_bgVideoChange:function(i){var t=this.elements,l=t.bgVideoSource.val(),n=t.bgVideo.val(),s=t.bgVideoServiceUrl.val(),o="https://www.youtube.com/iframe_api",r="https://player.vimeo.com/api/player.js",a=e("<script>");"video_service"==l&&""!=s?(/^(?:(?:(?:https?:)?\/\/)?(?:www.)?(?:youtu(?:be.com|.be))\/(?:watch\?v\=|v\/|embed\/)?([\w\-]+))/i.test(s)&&e('script[src*="youtube.com"').length<1?a.attr("src",o):/^(http\:\/\/|https\:\/\/)?(www\.)?(vimeo\.com\/)([0-9]+)$/.test(s)&&e('script[src*="vimeo.com"').length<1&&a.attr("src",r),
a.attr("type","text/javascript").appendTo("head"),this.delay(500,e.proxy(this.preview,this))):""!=n&&this.preview()},_bgSlideshowChange:function(i){var t=this.elements,l=t.bgSlideshowSource.val(),n=t.bgSlideshowPhotos.val(),s=t.bgSlideshowFeedUrl.val(),o=t.bgSlideshowSpeed.val(),r=t.bgSlideshowTransSpeed.val();"wordpress"==l&&""===n||"smugmug"==l&&""===s||isNaN(parseInt(o))||isNaN(parseInt(r))||this.delay(500,e.proxy(this.preview,this))},_bgParallaxChange:function(e){this.elements.bgParallaxImageSrc.val()&&this.updateCSSRule(this.classes.content,{"background-image":"url("+this.elements.bgParallaxImageSrc.val()+")","background-repeat":"no-repeat","background-position":"center center","background-attachment":"fixed","background-size":"cover"})},_bgOverlayChange:function(i){var t,l=this.elements.bgOverlayType.val(),n=this.elements.bgOverlayColor.val();"color"===l?(""===n?(this.elements.node.removeClass("fl-row-bg-overlay"),this.elements.node.removeClass("fl-col-bg-overlay"),this.updateCSSRule(this.classes.content+"::after","background-color","transparent")):(t=this.hexOrRgb(this.elements.bgOverlayColor.val()),this.delay(100,e.proxy(function(){this._bgOverlayAddClasses(),this.updateCSSRule(this.classes.content+"::after","background-color",t)},this))),this.updateCSSRule(this.classes.content+"::after","background-image","none")):"gradient"===l?(this._bgOverlayAddClasses(),this.updateCSSRule(this.classes.content+"::after","background-color","transparent"),this.elements.bgOverlayGradient.trigger("change")):(this.elements.node.removeClass("fl-row-bg-overlay"),this.elements.node.removeClass("fl-col-bg-overlay"),this.updateCSSRule(this.classes.content+"::after","background-color","transparent"),this.updateCSSRule(this.classes.content+"::after","background-image","none"))},_bgOverlayAddClasses:function(){this.elements.node.hasClass("fl-col")?this.elements.node.addClass("fl-col-bg-overlay"):this.elements.node.addClass("fl-row-bg-overlay")},_bgOverlayClear:function(e){this.elements.bgOverlayColor.prev(".fl-color-picker-clear").trigger("click"),this.elements.bgOverlayType.val("color").trigger("change")},_initNodeClassName:function(){e.extend(this.elements,{className:e(this.classes.settings+" input[name=class]")}),this.elements.className.on("keyup",e.proxy(this._classNameChange,this)),this._lastClassName=this.elements.className.val()},_classNameChange:function(e){var i=this.elements.className.val();null!==this._lastClassName&&this.elements.node.removeClass(this._lastClassName),this.elements.node.addClass(i),this._lastClassName=i},_initNodeDimensions:function(i){var t={},l=["Top","Bottom","Left","Right"],n=["","Medium","Responsive"],s=this.classes.settings,o="",r="",a=null,d=null;for(a=0;a<l.length;a++)for(d=0;d<n.length;d++)o=i+l[a]+n[d],r=i+"_"+l[a].toLowerCase(),""!=n[d]&&(r+="_"+n[d].toLowerCase()),t[o]=e(s+" input[name="+r+"]");e.extend(this.elements,t)},_initRow:function(){e.extend(this.elements,{width:e(this.classes.settings+" select[name=width]"),contentWidth:e(this.classes.settings+" select[name=content_width]"),maxContentWidth:e(this.classes.settings+" input[name=max_content_width]"),maxContentWidthUnit:e(this.classes.settings+" select[name=max_content_width_unit]"),height:e(this.classes.settings+" select[name=full_height]"),minHeight:e(this.classes.settings+" input[name=min_height]"),align:e(this.classes.settings+" select[name=content_alignment]")}),this.elements.width.on("change",e.proxy(this._rowWidthChange,this)),this.elements.contentWidth.on("change",e.proxy(this._rowContentWidthChange,this)),this.elements.maxContentWidth.on("input",e.proxy(this._rowMaxContentWidthChange,this)),this.elements.maxContentWidthUnit.on("change",e.proxy(this._rowMaxContentWidthChange,this)),this.elements.height.on("change",e.proxy(this._rowHeightChange,this)),this.elements.align.on("change",e.proxy(this._rowHeightChange,this)),this._initNodeTextColor(),this._initNodeBg(),this._initNodeClassName(),this._initNodeDimensions("border"),this._initNodeDimensions("margin"),this._initNodeDimensions("padding")},_rowWidthChange:function(e){var i=(FLBuilderConfig.global,this.elements.node),t=this.elements.content.find(".fl-row-content");this.elements.maxContentWidth.val(),this.elements.maxContentWidthUnit.val();i.css("max-width","none"),t.css("max-width","none"),"full"==this.elements.width.val()?(i.removeClass("fl-row-fixed-width"),i.addClass("fl-row-full-width")):(i.removeClass("fl-row-full-width"),i.addClass("fl-row-fixed-width")),this._rowMaxContentWidthChange()},_rowContentWidthChange:function(e){var i=(FLBuilderConfig.global,this.elements.node),t=this.elements.content.find(".fl-row-content");this.elements.maxContentWidth.val(),this.elements.maxContentWidthUnit.val();i.css("max-width","none"),t.css("max-width","none"),"full"==this.elements.contentWidth.val()?(t.removeClass("fl-row-fixed-width"),t.addClass("fl-row-full-width")):(t.removeClass("fl-row-full-width"),t.addClass("fl-row-fixed-width"),this._rowMaxContentWidthChange())},_rowMaxContentWidthChange:function(e){var i=FLBuilderConfig.global,t=this.elements.node,l=this.elements.content.find(".fl-row-content"),n=this.elements.maxContentWidth.val(),s=this.elements.maxContentWidthUnit.val();""==n?n=i.row_width+i.row_width_unit:n+=s,"fixed"===this.elements.width.val()&&t.css("max-width",n),l.css("max-width",n)},_rowHeightChange:function(e){var i=this.elements.node;this.elements.content;i.removeClass("fl-row-align-top"),i.removeClass("fl-row-align-center"),i.removeClass("fl-row-align-bottom"),i.removeClass("fl-row-full-height"),i.removeClass("fl-row-custom-height"),"full"==this.elements.height.val()?(i.addClass("fl-row-full-height"),i.addClass("fl-row-align-"+this.elements.align.val()),this.elements.minHeight.val("").trigger("input")):"custom"==this.elements.height.val()?(i.addClass("fl-row-custom-height"),i.addClass("fl-row-align-"+this.elements.align.val()),this.elements.minHeight.trigger("input")):this.elements.minHeight.val("").trigger("input")},_initColumn:function(){e.extend(this.elements,{size:e(this.classes.settings+" input[name=size]"),sizeMedium:e(this.classes.settings+" input[name=size_medium]"),sizeResponsive:e(this.classes.settings+" input[name=size_responsive]"),columnHeight:e(this.classes.settings+" select[name=equal_height]"),columnAlign:e(this.classes.settings+" select[name=content_alignment]"),responsiveOrder:e(this.classes.settings+" select[name=responsive_order]")}),this.elements.size.on("input",e.proxy(this._colSizeChange,this)),this.elements.sizeMedium.on("input",e.proxy(this._colSizeChange,this)),this.elements.sizeResponsive.on("input",e.proxy(this._colSizeChange,this)),this.elements.columnHeight.on("change",e.proxy(this._colHeightChange,this)),this.elements.columnAlign.on("change",e.proxy(this._colHeightChange,this)),this.elements.responsiveOrder.on("change",e.proxy(this._colResponsiveOrder,this)),this._initNodeTextColor(),this._initNodeBg(),this._initNodeClassName(),this._initNodeDimensions("border"),this._initNodeDimensions("margin"),this._initNodeDimensions("padding")},_colSizeChange:function(i){var t=e(i.target),l=8,n=100-l,s=parseFloat(t.val()),o=this.elements.node.closest(".fl-col-group"),r=this.elements.node.prev(".fl-col"),a=this.elements.node.next(".fl-col"),d=0===a.length?r:a,u=this.elements.node.siblings(".fl-col"),c=0,f=FLBuilderResponsiveEditing._mode;0!==u.length&&(isNaN(s)&&("medium"===f?s=this.elements.size.val():"responsive"===f&&(s=this.elements.sizeMedium.val()?this.elements.sizeMedium.val():"auto"),"auto"!==s&&isNaN(s)&&(s=l)),"default"===f?(u.each(function(){e(this).data("node")!=d.data("node")&&(n-=parseFloat(e(this)[0].style.width),c+=parseFloat(e(this)[0].style.width))}),s<l&&(s=l),s>n&&(s=n),this.elements.node.css("width",s+"%"),d.css("width",100-c-s+"%")):(s>100&&(s=100,t.val(100)),this.updateCSSRule(this.classes.node,{"max-width":("auto"===s?100:s)+"% !important",width:("auto"===s?s:s+"%")+" !important"},void 0,!0),"responsive"===f&&(t.val()?(this.updateCSSRule(this.classes.node,"float",FLBuilderConfig.isRtl?"right":"left",!0),this.updateCSSRule(this.classes.node,"clear","none",!0)):(this.updateCSSRule(this.classes.node,"float","none",!0),this.updateCSSRule(this.classes.node,"clear","both",!0)),t.val()||this._colsHaveCustomResponsiveWidth(u)?o.addClass("fl-col-group-custom-width"):o.removeClass("fl-col-group-custom-width"))))},_colsHaveCustomResponsiveWidth:function(i){var t=FLBuilderSettingsConfig.nodes,l=!1;return i.each(function(){var i=e(this).data("node");t[i]&&t[i].size_responsive&&(l=!0)}),l},_colHeightChange:function(){var e=this.elements.node.parent(".fl-col-group");e.removeClass("fl-col-group-align-top"),e.removeClass("fl-col-group-align-center"),e.removeClass("fl-col-group-align-bottom"),"yes"==this.elements.columnHeight.val()?(e.addClass("fl-col-group-equal-height"),e.addClass("fl-col-group-align-"+this.elements.columnAlign.val())):e.removeClass("fl-col-group-equal-height")},_colResponsiveOrder:function(){var e=this.elements.node.parent(".fl-col-group");"reversed"==this.elements.responsiveOrder.val()?e.addClass("fl-col-group-responsive-reversed"):e.removeClass("fl-col-group-responsive-reversed")},_initModule:function(){this._initNodeClassName(),this._initNodeDimensions("margin")},_initDefaultFieldPreviews:function(e){for(var e=FLBuilder.isUndefined(e)?this.elements.settings.find(".fl-field"):e,i=null,t=null,l=null,n=0;n<e.length;n++)i=e.eq(n),t=i.data("type"),l=i.data("preview"),"refresh"==l.type&&this._initFieldRefreshPreview(i),"text"==l.type&&this._initFieldTextPreview(i),"css"==l.type&&this._initFieldCSSPreview(i),"widget"==l.type&&this._initFieldWidgetPreview(i),"font"==l.type&&this._initFieldFontPreview(i),"attribute"==l.type&&this._initFieldAttributePreview(i),"animation"==l.type&&this._initFieldAnimationPreview(l,i),"callback"==l.type&&this._initFieldCallbackPreview(l,i,t,e),this._initFieldUnitSelect(i)},_initFieldCallbackPreview:function(i,t,l,n){var s,o=i.callback,r=e(".fl-builder-settings:visible"),a=r.data("node"),d=e(".fl-builder-content .fl-node-"+a);if("undefined"!=typeof FLBuilderPreviewCallbacks[o]?s=FLBuilderPreviewCallbacks[o]:"undefined"!=typeof window[o]&&(s=window[o]),"function"==typeof s){var u={field:t,fields:n,type:l,preview:i,form:r,nodeID:a,node:d};switch(l){case"align":case"button-group":case"text":case"multiple-photos":case"video":case"icon":case"ordering":u.input=t.find("input"),u.getValue=function(){return u.input.val()};break;case"color":u.input=t.find("input.fl-color-picker-value"),u.getValues=function(){var e=u.input.val();({value:e,formattedValue:FLBuilderPreview.formatColor(e)})};break;case"textarea":case"code":u.textarea=t.find("textarea"),u.getValue=function(){return u.textarea.val()};break;case"select":case"photo-sizes":case"post-type":u.select=t.find("select"),u.getValue=function(){return u.select.val()};break;case"photo":u.input=t.find("input[type=hidden]"),u.sizeSelect=t.find("select"),u.getValues=function(){return{value:u.input.val(),size:u.sizeSelect.val()}};break;case"unit":u.input=t.find("input[type=number]"),u.unitSelect=t.find(".fl-field-unit-select"),u.getValues=function(){var e=u.input.val(),i=u.unitSelect.val(),t={value:e,unit:i,formattedValue:e+i};return t};break;case"dimension":u.inputs=t.find("input[type=number]"),u.unitSelect=t.find(".fl-field-unit-select"),u.getValues=function(){var i={inputs:[],props:{},unit:u.unitSelect.val()};return u.inputs.each(function(t,l){var l=e(l),n=l.val(),s=l.data("unit");i.inputs.push(n),i.props[s]=n}),i};break;case"animation":u.input=t.find("input"),u.select=t.find("select"),u.getValues=function(){return{delay:u.input.val(),style:u.select.val()}};break;case"link":u.input=t.find(".fl-link-field-input-wrap input"),u.targetInput=t.find("input[name$=_target]"),u.noFollowInput=t.find("input[name$=_nofollow]"),u.getValues=function(){return{url:u.input.val(),target:u.targetInput.val(),noFollow:u.noFollowInput.val()}};break;case"shadow":u.colorInput=t.find("input.fl-color-picker-value"),u.inputs=t.find("input[type=number]"),u.getValues=function(){({color:u.colorInput.val(),x:u.inputs[0].val(),y:u.inputs[1].val(),blur:u.inputs[2].val(),spread:u.inputs[3].val()})};break;case"gradient":u.inputs=t.find("input"),u.select=t.find("select"),u.gradientInputs={},u.gradientInputs.type=t.find('select[name$="[type]"]'),u.gradientInputs.angle=t.find('input[name$="[angle]"]'),u.gradientInputs.position=t.find('select[name$="[position]"]'),u.gradientInputs.stops=[],t.find(".fl-gradient-picker-colors .fl-gradient-picker-color-row").each(function(i,t){t=e(t),u.gradientInputs.stops.push({color:t.find(".fl-gradient-picker-color input"),stop:t.find(".fl-gradient-picker-stop input")})}),u.getValues=function(){var e={type:u.gradientInputs.type.val(),angle:u.gradientInputs.angle.val(),position:u.gradientInputs.position.val(),stops:[]};for(var i in u.gradientInputs.stops){var t=u.gradientInputs.stops[i];e.stops[i]={color:t.color.val(),stop:t.stop.val()}}return e};break;case"shape-transform":u.inputs=t.find("input"),u.getValues=function(){return{scaleXSign:u.inputs.eq(0).val(),scaleYSign:u.inputs.eq(1).val(),skewX:u.inputs.eq(2).val(),skewY:u.inputs.eq(3).val(),scaleX:u.inputs.eq(4).val(),rotate:u.inputs.eq(5).val(),scaleY:u.inputs.eq(6).val()}};break;default:u.input=t.find("input"),u.getValue=function(){return u.input.val()}}var c=t.find(".fl-field-responsive-toggle");u.responsiveToggle=!!c.length&&c,s=s.bind(this,u);var f={input:"change keyup input",inputs:"change keyup input",targetInput:"change keyup input",noFollowInput:"change keyup input",colorInput:"change input",textarea:"change keyup input",select:"change",sizeSelect:"change",unitSelect:"change"};for(var h in f)"undefined"!=typeof u[h]&&u[h].on(f[h],s)}},_initFieldRefreshPreview:function(i){var t=i.data("type"),l=i.data("preview"),n=e.proxy(this.delayPreview,this);switch(t){case"align":i.find("input").on("change",n);break;case"text":i.find("input[type=text]").on("keyup",n);break;case"textarea":i.find("textarea").on("keyup",n);break;case"select":i.find("select").on("change",n);break;case"color":i.find(".fl-color-picker-value").on("change",n);break;case"photo":i.find("select").on("change",n);break;case"multiple-photos":i.find("input").on("change",n);break;case"photo-sizes":i.find("select").on("change",n);break;case"video":i.find("input").on("change",n);break;case"multiple-audios":i.find("input").on("change",n);break;case"icon":i.find("input").on("change",n);break;case"form":i.delegate("input","change",n);break;case"editor":this._addTextEditorCallback(i,l);break;case"code":i.find("textarea").on("change",n);break;case"post-type":i.find("select").on("change",n);break;case"suggest":i.find(".as-values").on("change",n),i.find("select").on("change",n);break;case"unit":case"dimension":i.find("input[type=number]").on("input",n);break;case"ordering":i.find("input[type=hidden]").on("change",n);break;default:i.on("change",n)}},_initFieldTextPreview:function(i){var t=i.data("type"),l=i.data("preview"),n=e.proxy(this._previewText,this,l);switch(t){case"text":i.find("input[type=text]").on("keyup",n);break;case"unit":i.find("input[type=number]").on("keyup",n);break;case"textarea":i.find("textarea").on("keyup",n);break;case"code":i.find("textarea").on("change",n);break;case"editor":this._addTextEditorCallback(i,l)}},_previewText:function(i,t){var l=this._getPreviewSelector(this.classes.node,i.selector),n=e(l),s=e("<div>"+e(t.target).val()+"</div>");n.length>0?(s.find("script").remove(),n.html(s.html())):this.delayPreview(t)},_previewTextEditor:function(i,t,l){var n=this._getPreviewSelector(this.classes.node,i.selector),s=e(n),o="undefined"!=typeof tinyMCE?tinyMCE.get(t):null,r=e("#"+t),a="";s.length>0&&(a=e(o&&"none"==r.css("display")?"<div>"+o.getContent()+"</div>":"undefined"==typeof switchEditors||"undefined"==typeof switchEditors.wpautop?"<div>"+r.val()+"</div>":"<div>"+switchEditors.wpautop(r.val())+"</div>"),a.find("script").remove(),s.html(a.html()))},_addTextEditorCallback:function(i,t){var l=i.find("textarea.wp-editor-area").attr("id"),n=null;if("refresh"==t.type)n=e.proxy(this.delayPreview,this);else{if("text"!=t.type)return;n=e.proxy(this._previewTextEditor,this,t,l)}e("#"+l).on("keyup",n),"undefined"!=typeof tinyMCE&&(editor=tinyMCE.get(l),editor.on("change",n),editor.on("keyup",n))},_initFieldFontPreview:function(i){var t=i.data("type"),l=i.data("preview");l.id=i.attr("id");var n=e.proxy(this._previewFont,this,l);"font"==t&&i.find(".fl-font-field").on("change","select",n)},_previewFont:function(i,t){var l=e(t.delegateTarget),n=l.find(".fl-font-field-font"),s=e(n).find(":selected"),o=s.parent().attr("label"),r=l.find(".fl-font-field-weight"),a=i.id+"-"+this.nodeId,d=this._getPreviewSelector(this.classes.node,i.selector),u=i.important?" !important":"",c="";"Google"==o&&this._buildFontStylesheet(a,n.val(),r.val()),c=n.val();var f=new RegExp("[0-9]");f.test(n.val())&&(c='"'+n.val()+'"'),this.updateCSSRule(d,"font-family","Default"===n.val()?"":c+u),this.updateCSSRule(d,"font-weight","default"===r.val()?"":r.val()+u)},_buildFontStylesheet:function(i,t,l){var n=FLBuilderConfig.googleFontsUrl,s="",o={},r={};o[t]=[l],FLBuilderPreview._fontsList[i]=o,Object.keys(FLBuilderPreview._fontsList).forEach(function(e){var i=FLBuilderPreview._fontsList[e];Object.keys(i).forEach(function(e){var t=i[e];r[e]=r[e]||[],t=t.filter(function(i){return r[e].indexOf(i)<0}),r[e]=r[e].concat(t)})}),e.each(r,function(e,i){s+=e+":"+i.join()+"|"}),s=n+s.slice(0,-1).replace(" ","+"),e("#fl-builder-google-fonts-preview").length<1?e("<link>").attr("id","fl-builder-google-fonts-preview").attr("type","text/css").attr("rel","stylesheet").attr("href",s).appendTo("head"):e("#fl-builder-google-fonts-preview").attr("href",s)},_initFieldCSSPreview:function(e){var i=e.data("preview"),t=null;if("undefined"!=typeof i.rules)for(t in i.rules)this._initFieldCSSPreviewCallback(e,i.rules[t]);else this._initFieldCSSPreviewCallback(e,i)},_initFieldCSSPreviewCallback:function(i,t){switch(i.data("type")){case"align":i.find("input").on("change",e.proxy(this._previewCSS,this,t,i));break;case"border":i.find("select").on("change",e.proxy(this._previewBorderCSS,this,t,i)),i.find("input[type=number]").on("input",e.proxy(this._previewBorderCSS,this,t,i)),i.find("input[type=hidden]").on("change",e.proxy(this._previewBorderCSS,this,t,i));break;case"color":i.find(".fl-color-picker-value").on("change",e.proxy(this._previewColorCSS,this,t,i));break;case"dimension":i.find("input[type=number]").on("input",e.proxy(this._previewDimensionCSS,this,t,i));break;case"gradient":i.find("select").on("change",e.proxy(this._previewGradientCSS,this,t,i)),i.find(".fl-gradient-picker-angle").on("input",e.proxy(this._previewGradientCSS,this,t,i)),i.find(".fl-color-picker-value").on("change",e.proxy(this._previewGradientCSS,this,t,i)),i.find(".fl-gradient-picker-stop").on("input",e.proxy(this._previewGradientCSS,this,t,i));break;case"photo":i.find("select").on("change",e.proxy(this._previewCSS,this,t,i));break;case"select":i.find("select").on("change",e.proxy(this._previewCSS,this,t,i));break;case"shadow":i.find("input").on("input",e.proxy(this._previewShadowCSS,this,t,i)),i.find(".fl-color-picker-value").on("change",e.proxy(this._previewShadowCSS,this,t,i));break;case"text":i.find("input[type=text]").on("keyup",e.proxy(this._previewCSS,this,t,i));break;case"typography":i.find("select").on("change",e.proxy(this._previewTypographyCSS,this,t,i)),i.find("input[type=number]").on("input",e.proxy(this._previewTypographyCSS,this,t,i)),i.find("input[type=hidden]").on("change",e.proxy(this._previewTypographyCSS,this,t,i));break;case"unit":i.find("input[type=number]").on("input",e.proxy(this._previewCSS,this,t,i))}},_previewCSS:function(i,t,l){var n=this._getPreviewSelector(this.classes.node,i.selector),s=i.property,o=this._getPreviewCSSUnit(i,t,l),r=e(l.target),a=r.val(),d=!!r.closest(".fl-field-responsive-setting").length,u=i.important&&""!==a?" !important":"";s.indexOf("image")>-1&&a?a="url("+a+")":"%"===o&&"opacity"===s?a=parseInt(a)/100:""!==a&&(a+=o),this.updateCSSRule(n,s,a+u,d)},_previewBorderCSS:function(i,t,l){var n=this._getPreviewSelector(this.classes.node,i.selector),s=e(l.target),t=s.closest(".fl-field"),o=s.closest(".fl-compound-field-setting"),r=o.data("property"),a=s.val(),d=(o.find(".fl-field-unit-select"),!!s.closest(".fl-field-responsive-setting").length),u=i.important&&""!==a?" !important":"";i.property=r,"border-color"===r?this._previewColorCSS(i,t,l):"border-width"===r||"border-radius"===r?this._previewDimensionCSS(i,t,l):"box-shadow"===r?this._previewShadowCSS(i,o,l):("border-style"===r&&t.find(".fl-border-field-width input:visible").trigger("input"),this.updateCSSRule(n,r,a+u,d))},_previewColorCSS:function(i,t,l){var n=this._getPreviewSelector(this.classes.node,i.selector),s=e(l.target),o=s.val(),r=!!s.closest(".fl-field-responsive-setting").length,a=i.important&&""!==o?" !important":"";""!==o&&o.indexOf("rgb")<0&&(o="#"+o),this.updateCSSRule(n,i.property,o+a,r)},_previewDimensionCSS:function(i,t,l){var n=this._getPreviewSelector(this.classes.node,i.selector),s=i.property,o=t.attr("id").replace("fl-field-",""),r=e(l.target).data("unit"),a=this._getDimensionValue(i,t,r,l),d=!!t.find(".fl-field-responsive-setting").length,u=i.important&&""!==a?" !important":"";s="border-radius"===s?"border-"+r.replace("_","-")+"-radius":"border-width"===s?"border-"+r+"-width":s+"-"+r,this.updateCSSRule(n,s,a+u,d),"margin"!==o&&"padding"!==o&&"border"!==o||this.elements.node.find(".fl-bg-slideshow").length&&FLBuilder._resizeLayout()},_getDimensionValue:function(i,t,l,n){var s=e(n.target).val(),o="";return s=s.toLowerCase().replace(/[^a-z0-9%.\-]/g,""),null===s||""===s||isNaN(s)||(o=this._getPreviewCSSUnit(i,t,n),s=parseFloat(s)+(o?o:"px")),s},_getPreviewCSSUnit:function(i,t,l){var n=e(l.target),s=(FLBuilderResponsiveEditing._mode,!!n.closest(".fl-compound-field-setting").length),o=!!n.closest(".fl-field-responsive-setting").length,r=null;return r=s?n.closest(".fl-compound-field-setting").find(".fl-field-unit-select"):o?n.closest(".fl-field-responsive-setting").find(".fl-field-unit-select"):t.find(".fl-field-unit-select"),r&&r.length?"SELECT"===r.prop("tagName")?r.val():r.text():i.unit?i.unit:""},_initFieldUnitSelect:function(i){i.find(".fl-field-unit-select").on("change",function(){var i=e(this),t=i.closest(".fl-field-responsive-setting"),l=i.closest(".fl-field");t.length?t.find("input").trigger("input"):l.find("input").trigger("input")})},_previewGradientCSS:function(i,t,l){var n=this._getPreviewSelector(this.classes.node,i.selector),s=t.find(".fl-gradient-picker-type-select").val(),o=t.find(".fl-gradient-picker-angle").val(),r=t.find(".fl-gradient-picker-position").val(),a=t.find(".fl-color-picker-value"),d=t.find(".fl-gradient-picker-stop input"),u=[],c="",f="";a.each(function(i){var t=e(this).val(),l=d.eq(i).val();""===t&&(t="rgba(255,255,255,0)"),t.indexOf("rgb")<0&&(t="#"+t),isNaN(l)&&(l=0),u.push(t+" "+l+"%")}),u=u.join(", "),"linear"===s?(isNaN(o)&&(o=0),c="linear-gradient("+o+"deg, "+u+")"):c="radial-gradient(at "+r+", "+u+")",f=i.important&&""!==c?" !important":"",this.updateCSSRule(n,i.property,c+f)},_previewShadowCSS:function(i,t,l){var n=this._getPreviewSelector(this.classes.node,i.selector),s=t.find(".fl-shadow-field-color input").val(),o=t.find(".fl-shadow-field-horizontal input").val(),r=t.find(".fl-shadow-field-vertical input").val(),a=t.find(".fl-shadow-field-blur input").val(),d=t.find(".fl-shadow-field-spread input").val(),u=!!t.find(".fl-shadow-field-spread input").length,c=!!e(l.target).closest(".fl-field-responsive-setting").length,f="",h="";""!==s&&(""===o&&(o=0),""===r&&(r=0),""===a&&(a=0),""===d&&(d=0),s.indexOf("rgb")<0&&(s="#"+s),f=o+"px ",f+=r+"px ",f+=a+"px ",u&&(f+=d+"px "),f+=s,f+=h),h=i.important&&""!==f?" !important":"",this.updateCSSRule(n,i.property,f,c)},_previewTypographyCSS:function(i,t,l){var n=this._getPreviewSelector(this.classes.node,i.selector),s=e(l.target),t=s.closest(".fl-field"),o=s.closest(".fl-compound-field-setting"),r=o.data("property"),a=s.val(),d=o.find(".fl-field-unit-select"),u=!!s.closest(".fl-field-responsive-setting").length,c=i.important&&""!==a?" !important":"";"font-family"===r?(i.id=t.attr("id"),this._previewFont(i,{delegateTarget:o})):"text-shadow"===r?(i.property="text-shadow",this._previewShadowCSS(i,o,l)):(d.length&&""!==a&&("vw"===d.val()?a="calc("+FLBuilderConfig.global.responsive_base_fontsize+"px + "+a+"vw)":a+="SELECT"===d.prop("tagName")?d.val():"px"),this.updateCSSRule(n,r,a+c,u))},_initFieldAttributePreview:function(i){var t=i.data("preview"),l=t.attribute,n=i.find("input"),s=(i.val(),window[t.format_callback]),o=this._getPreviewSelector(this.classes.node,t.selector),r=e(o),a=this._previewAttribute.bind(this,n,r,l,s);n.on("change",a),n.on("keyup",a),n.on("input",a)},_previewAttribute:function(e,i,t,l){var n=e.val();"function"==typeof l&&(n=l(n)),i[0].setAttribute(t,n)},_initFieldWidgetPreview:function(i){var t=e.proxy(this.delayPreview,this);i.find("input").on("keyup",t),i.find("input[type=checkbox]").on("click",t),i.find("textarea").on("keyup",t),i.find("select").on("change",t)},_initFieldAnimationPreview:function(i,t){t.find(".fl-animation-field-style select").on("change",e.proxy(this._previewAnimationField,this,i,t)),t.find(".fl-animation-field-duration input").on("input",e.proxy(this._previewAnimationField,this,i,t))},_previewAnimationField:function(i,t,l){var n=this._getPreviewSelector(this.classes.node,i.selector),s=e(n),o=t.find(".fl-animation-field-style select"),r=t.find(".fl-animation-field-duration input"),a=o[0].options;s.removeClass("fl-animated"),s.removeClass("fl-animation"),s.css("animation-duration","");for(var d=0;d<a.length;d++)s.removeClass("fl-"+a[d].value);""!==o.val()&&(s.addClass("fl-animation"),s.addClass("fl-"+o.val()),s.data("animation-delay",0),s.data("animation-duration",r.val())),FLBuilderLayout._doModuleAnimation.apply(s)},_getPreviewSelector:function(e,i){return FLBuilderPreview.getFormattedSelector.call(this,e,i)},toUpperCaseWords:function(e){return e.charAt(0).toUpperCase()+e.slice(1)}},FLBuilderPreview.formatColor=function(e){return""!==e&&e.indexOf("rgb")<0&&e.indexOf("url")<0&&(e="#"+e),e},FLBuilderPreviewCallbacks={previewShape:function(e,i){var t=e.preview.position,l=e.preview.prefix,n=e.form,s=l+"transform[][scaleYSign]";yOrientation=n.find('input[name="'+s+'"]'),"bottom"===t?yOrientation.val("invert"):yOrientation.val(""),yOrientation.trigger("change"),this.delayPreview()},previewShapeLayerSize:function(e,i){var t=e.getValues(),l=t.unit,n=t.props.width,s=t.props.height,o=t.props.top,r=e.preview.prefix,a=e.preview.position,d=this._getPreviewSelector(this.classes.node,".fl-builder-"+a+"-edge-layer"),u=d+" > *",c=e.form.find('[name="'+r+'align"]'),f=c.val(),h=f.split(" "),g=h[0],p=h[1],b=e.form.find('[name="'+r+'shape"]'),v=b.val(),m=FLBuilderConfig.presets.shape[v];if(shapeProps={},shapeProps.width="100%",shapeProps.left="auto",shapeProps.right="auto",shapeProps.height="auto",shapeProps.top="auto",shapeProps.bottom="auto",n){shapeProps.width=n+l;var _=n/2+l;switch(p){case"left":shapeProps.left="0",shapeProps.right="auto";break;case"right":shapeProps.left="auto",shapeProps.right="0";break;case"center":shapeProps.left="calc( 50% - "+_+")",shapeProps.right="auto"}}this.updateCSSRule(u,"width",shapeProps.width),this.updateCSSRule(u,"left",shapeProps.left),this.updateCSSRule(u,"right",shapeProps.right);var w;if(s)w=s/2+l;else if(n){var L=m.data.viewBox.width,F=n/L*100;w=F/2+l}else w="";switch(s&&(shapeProps.height=s+l),g){case"top":shapeProps.top="0",shapeProps.bottom="auto";break;case"bottom":shapeProps.top="auto",shapeProps.bottom="0";break;case"center":shapeProps.top="calc( 50% - "+w+")",shapeProps.bottom="auto"}this.updateCSSRule(u,"height",shapeProps.height),this.updateCSSRule(u,"top",shapeProps.top),this.updateCSSRule(u,"bottom",shapeProps.bottom),""===o?this.updateCSSRule(d,a,"0"):this.updateCSSRule(d,a,o+l)},previewShapeAlign:function(e,i){var t=e.preview.prefix,l=e.form.find('[name="'+t+'size_width"]');l.trigger("input")},previewShapeFillStyle:function(e,i){var t=e.input.val(),l=e.preview,n=e.preview.prefix,s="fl-row-"+e.nodeID+"-"+n+"-linear-gradient",o="fl-row-"+e.nodeID+"-"+n+"-radial-gradient",r="fl-row-"+e.nodeID+"-"+n+"-pattern",a=e.form;if("undefined"!=typeof t){var d=this._getPreviewSelector(this.classes.node,l.selector);switch(t){case"color":var u=a.find("[name="+n+"fill_color]").val();this.updateCSSRule(d,"fill",FLBuilderPreview.formatColor(u));break;case"gradient":var c=a.find("#fl-field-"+n+"fill_gradient"),f=c.find('select[name$="[type]"]').val(),h="radial"===f?o:s;this.updateCSSRule(d,"fill","url(#"+h+")");break;case"pattern":var g="url(#"+r+")";this.updateCSSRule(d,"fill",g)}}},previewShapeGradientFill:function(e,i){var t=e.getValues(),l=e.node,n=e.preview,s=".fl-builder-"+n.position+"-edge-layer",o=l.find(s+" "+t.type+"Gradient"),r="url(#"+o.attr("id")+")",a=this._getPreviewSelector(this.classes.node,s+" .fl-shape");this.updateCSSRule(a,"fill",r);var d=o.find("stop");for(var u in t.stops){var c=t.stops[u],f=d.eq(u),h=c.color,g=c.stop,p=1;if(0===h.indexOf("rgba")){var b=h.substring(h.indexOf("(")+1,h.lastIndexOf(")")).split(/,\s*/);p=b.pop(),h="rgb("+b.join(",")+")"}f.attr("stop-color",FLBuilderPreview.formatColor(h)),f.attr("stop-opacity",p),f.attr("offset",g+"%")}if("linear"===t.type&&"undefined"!=typeof o[0]&&o[0].setAttribute("gradientTransform","rotate("+t.angle+" .5 .5 )"),"radial"===t.type){parts=t.position.split(" ");var v,m,_,w=parts[0],L=parts[1];switch(w){case"top":case"left":v=0;break;case"center":v=.5;break;case"bottom":case"right":v=1}switch(L){case"top":case"left":m=0;break;case"center":m=.5;break;case"bottom":case"right":m=1}_=.5,.5===v&&.5===m||(_=1),o.attr("cx",v),o.attr("cy",m),o.attr("r",_)}},previewShapeTransform:function(e,i){var t=(e.form,e.preview),l=(t.prefix,this._getPreviewSelector(this.classes.node,t.selector)),n=l+" > *",s=e.getValues(),o=[];Object.keys(s).map(function(e){var i=s[e],t="",l="";switch(e){case"scaleXSign":case"scaleYSign":return;case"scaleX":case"scaleY":i&&""!==i&&0!==i||(i="1"),l="scaleX"===e?s.scaleXSign:s.scaleYSign,i="invert"===l?-Math.abs(i):Math.abs(i),o.push(e+"("+i+")");break;case"translateX":case"translateY":i&&(t="px",o.push(e+"("+i+t+")"));break;case"skewX":case"skewY":i&&(t="deg",o.push(e+"("+i+t+")"));break;case"rotate":t="deg",""!==i&&"0"!==i&&o.push("rotate("+i+t+")")}}),this.updateCSSRule(n,"transform",o.join(" "))}}}(jQuery),function(e){var i={ignored:[],reparsed:[],width:null,callback:null,sheets:{},styles:[],queue:[],emPxValue:null,regex:{media:/@media[^{]*{([\s\S]+?})\s*}/gi,empty:/@media[^{]*{([^{}]*?)}/gi,keyframes:/@(?:\-(?:o|moz|webkit)\-)?keyframes[^\{]+\{(?:[^\{\}]*\{[^\}\{]*\})+[^\}]*\}/gi,comments:/\/\*[^*]*\*+([^\/][^*]*\*+)*\//gi,urls:/(url\()['"]?([^\/\)'"][^:\)'"]+)['"]?(\))/g,findStyles:/@media *([^\{]+)\{([\S\s]+?)\}$/,only:/(only\s+)?([a-zA-Z]+)\s?/,minw:/\(\s*min\-width\s*:\s*(\s*[0-9\.]+)(px|em)\s*\)/,maxw:/\(\s*max\-width\s*:\s*(\s*[0-9\.]+)(px|em)\s*\)/,minmaxwh:/\(\s*m(in|ax)\-(height|width)\s*:\s*(\s*[0-9\.]+)(px|em)\s*\)/gi,other:/\([^\)]*\)/g},ignore:function(e){Array.prototype.push.apply(this.ignored,e)},reparse:function(e){Array.prototype.push.apply(this.reparsed,e)},update:function(e,i){this.width=void 0===e?null:e,this.callback=void 0===i?null:i,t.update(),this.queueSheets()?this.runQueue():this.applyStyles()},queueSheets:function(){for(var i=e("link, style"),t=null,l=null,n=null,s=null,o=null,r=null,a=null,d=!1,u=0,c=0;u<i.length;u++)if(element=i[u],t=element.href,l=element.id,n=element.tagName.toLowerCase(),s=element.rel,o=element.media,r=t?t.split("?").shift():l?l:"style-"+u,a=!0,d=!1,"style"===n||t&&s&&"stylesheet"===s.toLowerCase()){for(c=0;c<this.ignored.length;c++)if(r.indexOf(this.ignored[c])>-1){d=!0;break}if(d)continue;for(c=0;c<this.reparsed.length;c++)if(r.indexOf(this.reparsed[c])>-1){this.sheets[r]=null;break}void 0!==this.sheets[r]&&this.sheets[r]||this.queue.push({
element:i.eq(u),key:r,tagName:n,href:t,id:l,media:o})}return this.queue.length},runQueue:function(){var i;this.queue.length?(i=this.queue.shift(),"style"===i.tagName?(this.parse(i.element.html(),i),this.runQueue()):e.get(i.href,e.proxy(function(e){this.parse(e,i),this.runQueue()},this)).fail(this.runQueue.bind(this))):this.applyStyles()},parse:function(e,i){var t=this.regex,l=this.cleanStyles(e),n=l.match(t.media),s=n&&n.length||0,o=!s&&i.media,r=null,a=null,d=null,u="",c=0,f=0;for(n?u=l.replace(t.media,""):o&&"all"!=i.media?s=1:u=l,this.sheets[i.key]={element:i.element,key:i.key,tagName:i.tagName,href:i.href,id:i.id,all:u,queries:[]},c=0;c<s;c++)for(o?(r=i.media,l=this.convertURLs(l,i.href)):(r=n[c].match(t.findStyles)&&RegExp.$1,l=RegExp.$2&&this.convertURLs(RegExp.$2,i.href)),a=r.split(","),f=0;f<a.length;f++)r=a[f],d=r.split("(")[0].match(t.only)&&RegExp.$2,"print"!=d&&(r.replace(t.minmaxwh,"").match(t.other)||this.sheets[i.key].queries.push({minw:r.match(t.minw)&&parseFloat(RegExp.$1)+(RegExp.$2||""),maxw:r.match(t.maxw)&&parseFloat(RegExp.$1)+(RegExp.$2||""),styles:l}))},applyStyles:function(){var i=e("head"),t={all:"",queries:[]},l=null,n=null,s=null,o=null,r=null,a=null,d=null,u=!1;this.clearStyles();for(s in this.sheets)if(n=this.sheets[s],n.queries.length&&this.width){for(t.all+=n.all,r=0;r<n.queries.length;r++)o=n.queries[r],a=o.minw,d=o.maxw,u=!1,a&&(a=parseFloat(a)*(a.indexOf("em")>-1?this.getEmPxValue():1),this.width>=a&&(t.queries.push({media:"min",width:a,styles:o.styles}),u=!0)),d&&!u&&(d=parseFloat(d)*(d.indexOf("em")>-1?this.getEmPxValue():1),this.width<=d&&t.queries.push({media:"max",width:d,styles:o.styles}));n.element[0].disabled=!0}for(""!==t.all&&(l=e('<style class="fl-builder-media-query" data-query="all"></style>'),this.styles.push(l),i.append(l),l.html(t.all)),r=0;r<t.queries.length;r++)o=t.queries[r],l=e('<style class="fl-builder-media-query" data-query="'+o.media+'" data-value="'+o.width+'"></style>'),this.styles.push(l),i.append(l),l.html(o.styles);this.callback&&(this.callback(),this.callback=null)},clearStyles:function(){var e=null,i=this.styles.slice(0);this.styles=[];for(e in this.sheets)this.sheets[e].element[0].disabled=!1;for(var t=0;t<i.length;t++)i[t].empty(),i[t].remove()},disableStyles:function(e){for(var i,t,l,n=0;n<this.styles.length;n++)i=this.styles[n],t=i.attr("data-query"),l=parseInt(i.attr("data-value")),"max"===t&&!isNaN(l)&&l<=e&&(this.styles[n][0].sheet.disabled=!0)},enableStyles:function(){for(var e=0;e<this.styles.length;e++)this.styles[e][0].sheet.disabled=!1},cleanStyles:function(e){var i=this.regex;return e.replace(i.comments,"").replace(i.keyframes,"").replace(i.empty,"")},convertURLs:function(e,i){return i?(i=i.substring(0,i.lastIndexOf("/")),i.length&&(i+="/"),e.replace(this.regex.urls,"$1"+i+"$2$3")):e},getEmPxValue:function(){if(this.emPxValue)return this.emPxValue;var e=null,i=window.document,t=i.documentElement,l=i.body,n=i.createElement("div"),s=t.style.fontSize,o=l&&l.style.fontSize,r=!1;return n.style.cssText="position:absolute;font-size:1em;width:1em",l||(l=r=i.createElement("body"),l.style.background="none"),t.style.fontSize="100%",l.style.fontSize="100%",l.appendChild(n),r&&t.insertBefore(l,t.firstChild),e=parseFloat(n.offsetWidth),r?t.removeChild(l):l.removeChild(n),t.style.fontSize=s,o?l.style.fontSize=o:l.style.fontSize="",this.emPxValue=e,e}},t={_functions:null,update:function(){var e;if(!this._functions){this._functions={};for(e in l)this._functions[e]=jQuery.fn[e]}if(i.width)for(e in l)jQuery.fn[e]=l[e];else for(e in this._functions)jQuery.fn[e]=this._functions[e]}},l={width:function(l){return void 0!=l?t._functions.width.call(this,l):e.isWindow(this[0])?i.width:t._functions.width.call(this)}};FLBuilderSimulateMediaQuery={ignore:function(e){i.ignore(e)},reparse:function(e){i.reparse(e)},update:function(e,t){i.update(e,t)},disableStyles:function(e){i.disableStyles(e)},enableStyles:function(){i.enableStyles()}}}(jQuery),function(e){FLBuilderResponsiveEditing={_mode:"default",refreshPreview:function(i){var t;e(".fl-responsive-preview").length&&"default"!==this._mode?("responsive"==this._mode?(t=FLBuilderConfig.global.responsive_breakpoint>=320?320:FLBuilderConfig.global.responsive_breakpoint,FLBuilderSimulateMediaQuery.update(t,i)):"medium"==this._mode&&(t=FLBuilderConfig.global.medium_breakpoint>=769?769:FLBuilderConfig.global.medium_breakpoint,FLBuilderSimulateMediaQuery.update(t,i)),FLBuilder._resizeLayout()):i&&i()},_init:function(){this._bind(),this._initMediaQueries()},_bind:function(){FLBuilder.addHook("endEditingSession",this._clearPreview),FLBuilder.addHook("didEnterRevisionPreview",this._clearPreview),FLBuilder.addHook("responsiveEditing",this._menuToggleClicked),FLBuilder.addHook("preview-init",this._switchAllSettingsToCurrentMode),e("body").delegate(".fl-field-responsive-toggle","click",this._settingToggleClicked),e("body").delegate(".fl-responsive-preview-message button","click",this._previewToggleClicked)},_initMediaQueries:function(){FLBuilderSimulateMediaQuery.ignore([FLBuilderConfig.pluginUrl,FLBuilderConfig.relativePluginUrl,"fl-builder-preview","fl-theme-builder","/wp-includes/","/wp-admin/","admin-bar-inline-css","ace-tm","ace_editor.css"]),FLBuilderSimulateMediaQuery.reparse([FLBuilderConfig.postId+"-layout-draft.css",FLBuilderConfig.postId+"-layout-draft-partial.css",FLBuilderConfig.postId+"-layout-preview.css",FLBuilderConfig.postId+"-layout-preview-partial.css","fl-builder-global-css","fl-builder-layout-css"])},_switchTo:function(i,t){var l=e("html"),n=e("body"),s=e(FLBuilder._contentClass),o=e(".fl-responsive-preview"),r=e(".fl-responsive-preview-mask"),a=e(".fl-content-placeholder"),d=null;if(FLBuilderResponsiveEditing._mode=i,"default"==i){if(0===a.length)return;l.removeClass("fl-responsive-preview-enabled"),a.after(s),a.remove(),o.remove(),r.remove()}else 0===o.length?(l.addClass("fl-responsive-preview-enabled"),s.after('<div class="fl-content-placeholder"></div>'),n.prepend(wp.template("fl-responsive-preview")()),e(".fl-responsive-preview").addClass("fl-preview-"+i),e(".fl-responsive-preview-content").append(s)):(o.removeClass("fl-preview-responsive fl-preview-medium"),o.addClass("fl-preview-"+i));"responsive"==i?(d=FLBuilderConfig.global.responsive_breakpoint>=360?360:FLBuilderConfig.global.responsive_breakpoint,s.width(d),FLBuilderSimulateMediaQuery.update(d,t)):"medium"==i?(d=FLBuilderConfig.global.medium_breakpoint>=769?769:FLBuilderConfig.global.medium_breakpoint,s.width(d),FLBuilderSimulateMediaQuery.update(d,t)):(s.width(""),FLBuilderSimulateMediaQuery.update(null,t)),this._setContentBackgroundColor(),FLBuilder._resizeLayout(),this._previewFields(),FLBuilder.triggerHook("responsive-editing-switched",i)},_setContentBackgroundColor:function(){var i=e(FLBuilder._contentClass),t=e(".fl-responsive-preview"),l=e(".fl-content-placeholder"),n=l.parents(),s="#fff",o=0;if(0===t.length)i.css("background-color","");else{for(;o<n.length&&(s=n.eq(o).css("background-color"),"rgba(0, 0, 0, 0)"==s);o++);i.css("background-color",s)}},_switchToAndScroll:function(i){var t=e(".fl-builder-settings").data("node"),l=void 0===t?void 0:e(".fl-node-"+t);FLBuilderResponsiveEditing._switchTo(i,function(){if(void 0!==l&&l){var i=(e(window),e(".fl-responsive-preview-content"));i.length?(i.scrollTop(0),i.scrollTop(l.offset().top-150)):e("html, body").scrollTop(l.offset().top-100)}})},_switchAllSettingsTo:function(i){var t="dashicons-desktop dashicons-tablet dashicons-smartphone";e(".fl-field-responsive-toggle").removeClass(t),e(".fl-field-responsive-setting").hide(),t="default"==i?"dashicons-desktop":"medium"==i?"dashicons-tablet":"dashicons-smartphone",e(".fl-field-responsive-toggle").addClass(t).data("mode",i),e(".fl-field-responsive-setting-"+i).css("display","inline-block")},_switchAllSettingsToCurrentMode:function(){var e=FLBuilderResponsiveEditing;e._switchAllSettingsTo(e._mode),FLBuilder.triggerHook("responsive-editing-switched",e._mode)},_settingToggleClicked:function(){var i=e(this),t=i.data("mode");t="default"==t?"medium":"medium"==t?"responsive":"default",FLBuilderResponsiveEditing._switchAllSettingsTo(t),FLBuilderResponsiveEditing._switchToAndScroll(t),i.siblings(".fl-field-responsive-setting:visible").find("input").focus()},_menuToggleClicked:function(){var e=FLBuilderResponsiveEditing._mode;e="default"==e?"medium":"medium"==e?"responsive":"default",FLBuilder.MainMenu.hide(),FLBuilderResponsiveEditing._switchAllSettingsTo(e),FLBuilderResponsiveEditing._switchToAndScroll(e)},_previewToggleClicked:function(){var i=e(this).data("mode");FLBuilderResponsiveEditing._switchAllSettingsTo(i),FLBuilderResponsiveEditing._switchToAndScroll(i)},_clearPreview:function(){FLBuilderResponsiveEditing._switchToAndScroll("default")},_previewFields:function(){var i=FLBuilderResponsiveEditing._mode,t=e(".fl-builder-settings:visible");0!==t.length&&void 0!==t.attr("data-node")&&(FLBuilder.triggerHook("responsive-editing-before-preview-fields",i),t.find(".fl-builder-settings-tab").each(function(){var t=e(this);t.css("display","block"),t.find(".fl-field-responsive-setting-"+i+":visible").each(function(){var t=e(this),l=t.closest(".fl-field"),n=l.data("type"),s=l.data("preview"),o=l.find(".fl-field-connection-visible").length;"refresh"!=s.type&&(o?"photo"===n&&"default"!==i&&t.find(".fl-photo-remove").trigger("click"):(t.find("input").trigger("keyup"),t.find("select").trigger("change")))}),t.css("display","")}),FLBuilder.triggerHook("responsive-editing-after-preview-fields",i))}},e(function(){FLBuilderResponsiveEditing._init()})}(jQuery),function(e){FLBuilderResponsivePreview={enter:function(){this.render()},exit:function(){this.destroy()},switchTo:function(i){var t=FLBuilderConfig.global,l=e("#fl-builder-preview-frame"),n="100%";"responsive"==i?(n=t.responsive_breakpoint>=360?360:t.responsive_breakpoint,l.width(n)):"medium"==i&&(n=t.medium_breakpoint>=769?769:t.medium_breakpoint,l.width(n)),l.width(n)},render:function(){var i=e("body"),t=FLBuilderConfig.previewUrl,l=e("#fl-builder-preview-mask, #fl-builder-preview-frame"),n=e('<div id="fl-builder-preview-mask"></div>'),s=e('<iframe id="fl-builder-preview-frame" src="'+t+'"></iframe>');l.remove(),i.append(n),i.append(s),i.css("overflow","hidden")},destroy:function(){e("#fl-builder-preview-mask, #fl-builder-preview-frame").remove(),e("body").css("overflow","visible")}}}(jQuery),function(e){var i={init:function(){var i=e("body");i.delegate(".fl-builder-service-select","change",this._serviceChange),i.delegate(".fl-builder-service-connect-button","click",this._connectClicked),i.delegate(".fl-builder-service-account-select","change",this._accountChange),i.delegate(".fl-builder-service-account-delete","click",this._accountDeleteClicked),i.delegate(".fl-builder-campaign-monitor-client-select","change",this._campaignMonitorClientChange),i.delegate(".fl-builder-mailchimp-list-select","change",this._mailChimpListChange),i.delegate(".fl-builder-activecampaign-list_type-select","change",this._activeCampaignChange)},_startSettingsLoading:function(i){var t=e(".fl-builder-settings"),l=i.closest(".fl-builder-service-settings"),n=e(".fl-builder-service-error");t.append('<div class="fl-builder-loading"></div>'),l.addClass("fl-builder-service-settings-loading"),n.remove()},_finishSettingsLoading:function(){var i=e(".fl-builder-settings"),t=e(".fl-builder-service-settings-loading");i.find(".fl-builder-loading").remove(),t.removeClass("fl-builder-service-settings-loading")},_serviceChange:function(){var t=e(".fl-builder-settings").data("node"),l=e(this),n=l.closest("tr"),s=l.val();n.siblings("tr.fl-builder-service-account-row").remove(),n.siblings("tr.fl-builder-service-connect-row").remove(),n.siblings("tr.fl-builder-service-field-row").remove(),e(".fl-builder-service-error").remove(),""!==s&&(i._startSettingsLoading(l),FLBuilder.ajax({action:"render_service_settings",node_id:t,service:s},i._serviceChangeComplete))},_serviceChangeComplete:function(t){var l=FLBuilder._jsonParse(t),n=e(".fl-builder-service-settings-loading"),s=n.find(".fl-builder-service-select-row");s.after(l.html),i._addAccountDelete(n),i._finishSettingsLoading()},_connectClicked:function(){for(var t=e(".fl-builder-settings").data("node"),l=e(this).closest(".fl-builder-service-settings"),n=l.find(".fl-builder-service-select"),s=l.find(".fl-builder-service-connect-row"),o=l.find(".fl-builder-service-connect-input"),r=null,a=null,d=0,u={action:"connect_service",node_id:t,service:n.val(),fields:{}};d<o.length;d++)r=o.eq(d),a=r.attr("name"),u.fields[a]=r.val();s.hide(),i._startSettingsLoading(n),FLBuilder.ajax(u,i._connectComplete)},_connectComplete:function(t){var l=FLBuilder._jsonParse(t),n=e(".fl-builder-service-settings-loading"),s=n.find(".fl-builder-service-select-row"),o=n.find(".fl-builder-service-select"),r=n.find(".fl-builder-service-account-row"),a=n.find(".fl-builder-service-account-select"),d=n.find(".fl-builder-service-connect-row");l.error?(d.show(),0===a.length?o.after('<div class="fl-builder-service-error">'+l.error+"</div>"):a.after('<div class="fl-builder-service-error">'+l.error+"</div>")):(d.remove(),r.remove(),s.after(l.html)),i._addAccountDelete(n),i._finishSettingsLoading()},_accountChange:function(){var t=e(".fl-builder-settings").data("node"),l=e(this).closest(".fl-builder-service-settings"),n=l.find(".fl-builder-service-select"),s=l.find(".fl-builder-service-account-select"),o=l.find(".fl-builder-service-connect-row"),r=l.find("tr.fl-builder-service-field-row"),a=e(".fl-builder-service-error"),d=s.val(),u=null;o.remove(),r.remove(),a.remove(),"add_new_account"==d?u={action:"render_service_settings",node_id:t,service:n.val(),add_new:!0}:""!==d&&(u={action:"render_service_fields",node_id:t,service:n.val(),account:d}),u&&(i._startSettingsLoading(n),FLBuilder.ajax(u,i._accountChangeComplete)),i._addAccountDelete(l)},_accountChangeComplete:function(t){var l=FLBuilder._jsonParse(t),n=e(".fl-builder-service-settings-loading"),s=n.find(".fl-builder-service-account-row");s.after(l.html),i._finishSettingsLoading()},_addAccountDelete:function(e){var i=e.find(".fl-builder-service-account-select");i.length>0&&(e.find(".fl-builder-service-account-delete").remove(),""!==i.val()&&"add_new_account"!=i.val()&&i.after('<a href="javascript:void(0);" class="fl-builder-service-account-delete">'+FLBuilderStrings.deleteAccount+"</a>"))},_accountDeleteClicked:function(){var t=e(this).closest(".fl-builder-service-settings"),l=t.find(".fl-builder-service-select"),n=t.find(".fl-builder-service-account-select");confirm(FLBuilderStrings.deleteAccountWarning)&&(FLBuilder.ajax({action:"delete_service_account",service:l.val(),account:n.val()},i._accountDeleteComplete),i._startSettingsLoading(n))},_accountDeleteComplete:function(){var t=e(".fl-builder-service-settings-loading"),l=t.find(".fl-builder-service-select");i._finishSettingsLoading(),l.trigger("change")},_campaignMonitorClientChange:function(){var t=e(".fl-builder-settings").data("node"),l=e(this).closest(".fl-builder-service-settings"),n=l.find(".fl-builder-service-select"),s=l.find(".fl-builder-service-account-select"),o=e(this),r=l.find(".fl-builder-service-list-select"),a=o.val();0!==r.length&&r.closest("tr").remove(),""!==a&&(i._startSettingsLoading(n),FLBuilder.ajax({action:"render_service_fields",node_id:t,service:n.val(),account:s.val(),client:a},i._campaignMonitorClientChangeComplete))},_campaignMonitorClientChangeComplete:function(t){var l=FLBuilder._jsonParse(t),n=e(".fl-builder-service-settings-loading"),s=n.find(".fl-builder-campaign-monitor-client-select");s.closest("tr").after(l.html),i._finishSettingsLoading()},_mailChimpListChange:function(){var t=e(".fl-builder-settings").data("node"),l=e(this).closest(".fl-builder-service-settings"),n=l.find(".fl-builder-service-select"),s=l.find(".fl-builder-service-account-select"),o=l.find(".fl-builder-service-list-select");e(".fl-builder-mailchimp-group-select").closest("tr").remove(),""!==o.val()&&(i._startSettingsLoading(n),FLBuilder.ajax({action:"render_service_fields",node_id:t,service:n.val(),account:s.val(),list_id:o.val()},i._mailChimpListChangeComplete))},_mailChimpListChangeComplete:function(t){var l=FLBuilder._jsonParse(t),n=e(".fl-builder-service-settings-loading"),s=n.find(".fl-builder-service-list-select");s.closest("tr").after(l.html),i._finishSettingsLoading()},_activeCampaignChange:function(){var t=e(".fl-builder-settings").data("node"),l=e(this).closest(".fl-builder-service-settings"),n=l.find(".fl-builder-service-select"),s=l.find(".fl-builder-service-account-select"),o=l.find(".fl-builder-service-list-select");list_type=l.find('select[name="list_type"]'),0!==o.length&&o.closest("tr").remove(),""!==list_type.val()&&(i._startSettingsLoading(n),FLBuilder.ajax({action:"render_service_fields",node_id:t,service:n.val(),account:s.val(),list_type:list_type.val()},i._activeCampaignTypeChangeComplete))},_activeCampaignTypeChangeComplete:function(t){var l=FLBuilder._jsonParse(t),n=e(".fl-builder-service-settings-loading"),s=n.find(".fl-builder-service-field-row");s.after(l.html),i._finishSettingsLoading()}};e(function(){i.init()})}(jQuery),function(e){FLBuilderTour={_tour:null,start:function(){FLBuilderTour._tour?FLBuilderTour._tour.restart():(FLBuilderTour._tour=new Tour(FLBuilderTour._config()),FLBuilderTour._tour.init()),FLBuilder._triggerSettingsSave(!1,!0)&&FLBuilderTour._tour.start()},_config:function(){var i={storage:!1,onStart:FLBuilderTour._onStart,onPrev:FLBuilderTour._onPrev,onNext:FLBuilderTour._onNext,onEnd:FLBuilderTour._onEnd,template:'<div class="popover" role="tooltip"> <i class="fas fa-times" data-role="end"></i> <div class="arrow"></div> <h3 class="popover-title"></h3> <div class="popover-content"></div> <div class="popover-navigation clearfix"> <button class="fl-builder-button fl-builder-button-primary fl-builder-tour-next" data-role="next">'+FLBuilderStrings.tourNext+"</button> </div> </div>",steps:[{animation:!1,element:".fl-builder--content-library-panel",placement:"left",title:FLBuilderStrings.tourTemplatesTitle,content:FLBuilderStrings.tourTemplates,onShow:function(){FLBuilder.ContentPanel.show("templates")}},{animation:!1,element:".fl-builder--content-library-panel",placement:"left",title:FLBuilderStrings.tourAddRowsTitle,content:FLBuilderStrings.tourAddRows,onShow:function(){FLBuilder.ContentPanel.show("rows")}},{animation:!1,element:".fl-builder--content-library-panel",placement:"left",title:FLBuilderStrings.tourAddContentTitle,content:FLBuilderStrings.tourAddContent,onShow:function(){FLBuilder.ContentPanel.show("modules")}},{animation:!1,element:".fl-row:first-of-type",placement:"top",title:FLBuilderStrings.tourEditContentTitle,content:FLBuilderStrings.tourEditContent,onShow:function(){FLBuilderTour._dimSection(".fl-builder-bar"),FLBuilder._closePanel(),e(".fl-row").eq(0).trigger("mouseenter"),e(".fl-module").eq(0).trigger("mouseenter")}},{animation:!1,element:".fl-row:first-of-type .fl-module-overlay .fl-block-overlay-actions",placement:"top",title:FLBuilderStrings.tourEditContentTitle,content:FLBuilderStrings.tourEditContent2,onShow:function(){FLBuilderTour._dimSection(".fl-builder-bar"),FLBuilder._closePanel(),e(".fl-row").eq(0).trigger("mouseenter"),e(".fl-module").eq(0).trigger("mouseenter")}},{animation:!1,element:".fl-builder-content-panel-button",placement:"bottom",title:FLBuilderStrings.tourAddContentButtonTitle,content:FLBuilderStrings.tourAddContentButton,onShow:function(){FLBuilderTour._dimSection("body"),e(".fl-row").eq(0).trigger("mouseleave"),e(".fl-module").eq(0).trigger("mouseleave")}},{animation:!1,element:".fl-builder-templates-button",placement:"bottom",title:FLBuilderStrings.tourTemplatesButtonTitle,content:FLBuilderStrings.tourTemplatesButton,onShow:function(){FLBuilderTour._dimSection("body")}},{animation:!1,element:".fl-builder-tools-button",placement:"bottom",title:FLBuilderStrings.tourToolsButtonTitle,content:FLBuilderStrings.tourToolsButton,onShow:function(){FLBuilderTour._dimSection("body")}},{animation:!1,element:".fl-builder-done-button",placement:"bottom",title:FLBuilderStrings.tourDoneButtonTitle,content:FLBuilderStrings.tourDoneButton,onShow:function(){FLBuilderTour._dimSection("body")}},{animation:!1,orphan:!0,backdrop:!0,title:FLBuilderStrings.tourFinishedTitle,content:FLBuilderStrings.tourFinished,template:'<div class="popover" role="tooltip"> <div class="arrow"></div> <i class="fas fa-times" data-role="end"></i> <h3 class="popover-title"></h3> <div class="popover-content"></div> <div class="popover-navigation clearfix"> <button class="fl-builder-button fl-builder-button-primary fl-builder-tour-next" data-role="end">'+FLBuilderStrings.tourEnd+"</button> </div> </div>"}]};return FLBuilderConfig.lite?i.steps.shift():"disabled"==FLBuilderConfig.enabledTemplates?i.steps.shift():"fl-builder-template"==FLBuilderConfig.postType&&i.steps.shift(),i},_onStart:function(){var i=e("body");i.scrollTop(0),i.append('<div class="fl-builder-tour-mask"></div>'),0===e(".fl-row").length&&"module"!=FLBuilderConfig.userTemplateType&&(e(".fl-builder-content").append('<div class="fl-builder-tour-demo-content fl-row fl-row-fixed-width fl-row-bg-none"> <div class="fl-row-content-wrap"> <div class="fl-row-content fl-row-fixed-width fl-node-content"> <div class="fl-col-group"> <div class="fl-col" style="width:100%"> <div class="fl-col-content fl-node-content"> <div class="fl-module fl-module-rich-text" data-type="rich-text" data-name="Text Editor"> <div class="fl-module-content fl-node-content"> <div class="fl-rich-text"> <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Vivamus pellentesque ut lorem non cursus. Sed mauris nunc, porttitor iaculis lorem a, sollicitudin lacinia sapien. Proin euismod orci lacus, et sollicitudin leo posuere ac. In hac habitasse platea dictumst. Maecenas elit magna, consequat in turpis suscipit, ultrices rhoncus arcu. Phasellus finibus sapien nec elit tempus venenatis. Maecenas tincidunt sapien non libero maximus, in aliquam felis tincidunt. Mauris mollis ultricies facilisis. Duis condimentum dignissim tortor sit amet facilisis. Aenean gravida lacus eu risus molestie egestas. Donec ut dolor dictum, fringilla metus malesuada, viverra nunc. Maecenas ut purus ac justo aliquet lacinia. Cras vestibulum elementum tincidunt. Maecenas mattis tortor neque, consectetur dignissim neque tempor nec.</p></div> </div> </div> </div> </div> </div> </div> </div> </div>'),FLBuilder._setupEmptyLayout(),FLBuilder._highlightEmptyCols())},_onPrev:function(){e(".fl-builder-tour-dimmed").remove()},_onNext:function(){e(".fl-builder-tour-dimmed").remove()},_onEnd:function(){e("body").off("fl-builder.template-selector-loaded"),e(".fl-builder-tour-mask").remove(),e(".fl-builder-tour-dimmed").remove(),e(".fl-builder-tour-demo-content").remove(),FLBuilder._setupEmptyLayout(),FLBuilder._highlightEmptyCols(),FLBuilder._showPanel(),FLBuilder._initTemplateSelector()},_dimSection:function(i){e(i).find(".fl-builder-tour-dimmed").remove(),e(i).append('<div class="fl-builder-tour-dimmed"></div>')}}}(jQuery),function(e,i){String.prototype.startsWith||(String.prototype.startsWith=function(e,i){return i=i||0,this.substr(i,e.length)===e}),String.prototype.endsWith||(String.prototype.endsWith=function(e,i){var t=this.toString();("number"!=typeof i||!isFinite(i)||Math.floor(i)!==i||i>t.length)&&(i=t.length),i-=e.length;var l=t.indexOf(e,i);return l!==-1&&l===i}),e.fn.textWidth=function(i,t){return e.fn.textWidth.fakeEl||(e.fn.textWidth.fakeEl=e("<span>").hide().appendTo(document.body)),e.fn.textWidth.fakeEl.text(i||this.val()||this.text()).css("font",t||this.css("font")),e.fn.textWidth.fakeEl.width()},FLExtendableObject={create:function(i){var t=Object.create(this);return t=e.extend(t,i),e(this).trigger("onCreate"),t}},e.fn.switchClass=function(i,t){return this.each(function(){return e(this).removeClass(function(e,t){var l=[],n=t.split(" ");for(var e in n)n[e].startsWith(i)&&l.push(n[e]);return l.join(" ")}),e(this).addClass(i+t)})};var t={init:function(){i.addHook("cancelTask",this.onCancelTask.bind(this)),i.addHook("showSavedMessage",this.onSaveShortcut.bind(this)),i.addHook("goToNextTab",this.onNextPrevTabShortcut.bind(this,"next")),i.addHook("goToPrevTab",this.onNextPrevTabShortcut.bind(this,"prev")),i.addHook("endEditingSession",this.onEndEditingSession.bind(this)),i.addHook("restartEditingSession",this.onRestartEditingSession.bind(this)),this.setDefaultKeyboardShortcuts()},addShortcut:function(i,t,l){var n=e.proxy(this,"onTriggerKey",i);l?Mousetrap.bindGlobal(t,n):Mousetrap.bind(t,n)},reset:function(){Mousetrap.reset()},setDefaultKeyboardShortcuts:function(){this.reset();for(var e in FLBuilderConfig.keyboardShortcuts){var i=FLBuilderConfig.keyboardShortcuts[e].keyCode,t=FLBuilderConfig.keyboardShortcuts[e].isGlobal;this.addShortcut(e,i,t)}},onTriggerKey:function(e,t){i.triggerHook(e),t.preventDefault?t.preventDefault():t.returnValue=!1},onCancelTask:function(){return s.isPreviewing?void s.endPreview():n.isShowing?void n.hide():i.ContentPanel.isShowing?void i.ContentPanel.hide():void 0},pause:function(){Mousetrap.pause()},unpause:function(){Mousetrap.unpause()},onEndEditingSession:function(){this.reset(),this.addShortcut("restartEditingSession","mod+e")},onRestartEditingSession:function(){this.reset(),this.setDefaultKeyboardShortcuts()},onSaveShortcut:function(){if(i.SaveManager.layoutNeedsPublish()){var e=FLBuilderStrings.savedStatus.hasAlreadySaved;i.SaveManager.showStatusMessage(e),setTimeout(function(){i.SaveManager.resetStatusMessage()},2e3)}else{var e=FLBuilderStrings.savedStatus.nothingToSave;i.SaveManager.showStatusMessage(e),setTimeout(function(){i.SaveManager.resetStatusMessage()},2e3)}},onNextPrevTabShortcut:function(t,l){var n,s,o=e(".fl-lightbox:visible"),r=o.find(".fl-builder-settings-tabs a");o.length>0&&(n=r.filter("a.fl-active"),s="next"==t?n.is(r.last())?r.first():n.next("a"):n.is(r.first())?r.last():n.prev("a"),s.trigger("click")),i._calculateSettingsTabsOverflow(),l.preventDefault()}},l={isShowing:!1,init:function(){this.render(),i.addHook("showKeyboardShortcuts",this.show.bind(this))},render:function(){var i=wp.template("fl-keyboard-shortcuts"),t=FLBuilderConfig.keyboardShortcuts;this.$el=e(i(t)),e("body").append(this.$el),this.$el.find(".dismiss-shortcut-ui").on("click",this.hide.bind(this)),this.$el.on("click",this.hide.bind(this))},show:function(){this.isShowing||(this.$el.addClass("is-showing"),this.isShowing=!0)},hide:function(){this.isShowing&&(this.$el.removeClass("is-showing"),this.isShowing=!1)},toggle:function(){this.isShowing?this.hide():this.show()}},n=FLExtendableObject.create({isShowing:!1,init:function(){this.$el=e(".fl-builder-publish-actions"),this.$defaultBarButtons=e(".fl-builder-bar-actions"),this.$clickAwayMask=e(".fl-builder-publish-actions-click-away-mask"),this.$doneBtn=this.$defaultBarButtons.find(".fl-builder-done-button"),this.$doneBtn.on("click",this.onDoneTriggered.bind(this)),this.$actions=this.$el.find(".fl-builder-button"),this.$actions.on("click",this.onActionClicked.bind(this)),i.addHook("triggerDone",this.onDoneTriggered.bind(this));var t=this.hide.bind(this);i.addHook("cancelPublishActions",t),i.addHook("endEditingSession",t),this.$clickAwayMask.on("click",t)},onDoneTriggered:function(){i.SaveManager.layoutNeedsPublish()?this.show():FLBuilderConfig.shouldRefreshOnPublish?i._exit():i._exitWithoutRefresh()},show:function(){this.isShowing||i._triggerSettingsSave(!1,!0)&&(this.$el.removeClass("is-hidden"),this.$defaultBarButtons.css("opacity","0"),this.$clickAwayMask.show(),this.isShowing=!0,i.triggerHook("didShowPublishActions"))},hide:function(){this.isShowing&&(this.$el.addClass("is-hidden"),this.$defaultBarButtons.css("opacity","1"),this.$clickAwayMask.hide(),this.isShowing=!1)},onActionClicked:function(t){var l=e(t.currentTarget).data("action");switch(l){case"dismiss":this.hide();break;case"discard":this.hide(),s.muteToolbar(),i._discardButtonClicked();break;case"publish":this.hide(),s.muteToolbar(),i._publishButtonClicked(),i._destroyOverlayEvents();break;case"draft":this.hide(),s.muteToolbar(),i._draftButtonClicked();break;default:this.hide(),s.muteToolbar(),i._draftButtonClicked()}i.triggerHook(l+"ButtonClicked")}}),s={isPreviewing:!1,init:function(){this.$el=e("body"),this.$mainToolbar=e(".fl-builder-bar"),this.$mainToolbarContent=this.$mainToolbar.find(".fl-builder-bar-content"),this.$wpAdminBar=e("#wpadminbar"),this.$endPreviewBtn=e(".fl-builder--preview-actions .end-preview-btn"),i.addHook("endEditingSession",this.endEditingSession.bind(this)),i.addHook("previewLayout",this.togglePreview.bind(this)),this.$endPreviewBtn.on("click",this.endPreview.bind(this)),this.$deviceIcons=e(".fl-builder--preview-actions i"),this.$deviceIcons.on("click",this.onDeviceIconClick.bind(this));var t=this.$wpAdminBar.find("#wp-admin-bar-fl-builder-frontend-edit-link > a, #wp-admin-bar-fl-theme-builder-frontend-edit-link > a");t.on("click",this.onClickPageBuilderToolbarLink.bind(this)),e("#wpadminbar a").attr("tabindex","-1");var l=this.restartEditingSession.bind(this);i.addHook("restartEditingSession",l),i.addHook("didHideAllLightboxes",this.unmuteToolbar.bind(this)),i.addHook("didCancelDiscard",this.unmuteToolbar.bind(this)),i.addHook("didEnterRevisionPreview",this.hide.bind(this)),i.addHook("didExitRevisionPreview",this.show.bind(this)),i.addHook("didPublishLayout",this.onPublish.bind(this))},endEditingSession:function(){i._destroyOverlayEvents(),i._removeAllOverlays(),i._removeEmptyRowAndColHighlights(),i._removeColHighlightGuides(),i._unbindEvents(),e("html").removeClass("fl-builder-edit").addClass("fl-builder-show-admin-bar"),e("body").removeClass("fl-builder-edit"),e("#wpadminbar a").attr("tabindex",null),e(i._contentClass).removeClass("fl-builder-content-editing"),this.hideMainToolbar(),i.ContentPanel.hide(),FLBuilderLayout.init()},restartEditingSession:function(t){i._initTemplateSelector(),i._bindOverlayEvents(),i._highlightEmptyCols(),i._rebindEvents(),e("html").addClass("fl-builder-edit").removeClass("fl-builder-show-admin-bar"),e("body").addClass("fl-builder-edit"),e("#wpadminbar a").attr("tabindex","-1"),e(i._contentClass).addClass("fl-builder-content-editing"),this.showMainToolbar(),t.preventDefault()},onClickPageBuilderToolbarLink:function(e){i.triggerHook("restartEditingSession"),e.preventDefault()},onPublish:function(){var e=this.$wpAdminBar.find("#wp-admin-bar-fl-builder-frontend-edit-link > a span");e.css("color","#6bc373")},hide:function(){e("html").hasClass("fl-builder-edit")&&(i._unbindEvents(),i._destroyOverlayEvents(),i._removeAllOverlays(),e("html").removeClass("fl-builder-edit"),e("body").removeClass("admin-bar"),this.hideMainToolbar(),i.ContentPanel.hide(),FLBuilderLayout.init(),i.triggerHook("didHideEditingUI"))},show:function(){e("html").hasClass("fl-builder-edit")||(i._rebindEvents(),i._bindOverlayEvents(),this.showMainToolbar(),FLBuilderResponsiveEditing._switchTo("default"),e("html").addClass("fl-builder-edit"),e("body").addClass("admin-bar"),i.triggerHook("didShowEditingUI"))},beginPreview:function(){i._triggerSettingsSave(!1,!0)&&(this.isPreviewing=!0,this.hide(),e("html").addClass("fl-builder-preview"),e("html, body").removeClass("fl-builder-edit"),i._removeEmptyRowAndColHighlights(),i._removeColHighlightGuides(),i.triggerHook("didBeginPreview"),FLBuilderResponsivePreview.enter())},endPreview:function(){this.isPreviewing=!1,this.show(),i._highlightEmptyCols(),FLBuilderResponsivePreview.exit(),e("html").removeClass("fl-builder-preview"),e("html, body").addClass("fl-builder-edit")},togglePreview:function(){this.isPreviewing?this.endPreview():this.beginPreview()},hideMainToolbar:function(){this.$mainToolbar.addClass("is-hidden"),e("html").removeClass("fl-builder-is-showing-toolbar")},showMainToolbar:function(){this.unmuteToolbar(),this.$mainToolbar.removeClass("is-hidden"),e("html").addClass("fl-builder-is-showing-toolbar")},onDeviceIconClick:function(i){var t=e(i.target).data("mode");FLBuilderResponsivePreview.switchTo(t);
},muteToolbar:function(){this.$mainToolbarContent.addClass("is-muted"),i._hideTipTips()},unmuteToolbar:function(){this.$mainToolbarContent.removeClass("is-muted")}},o={isEditing:!0,init:function(){history.pushState&&(i.addHook("endEditingSession",this.onLeaveBuilder.bind(this)),i.addHook("restartEditingSession",this.onEnterBuilder.bind(this)))},onEnterBuilder:function(){history.replaceState({},document.title,FLBuilderConfig.editUrl),this.isEditing=!0},onLeaveBuilder:function(){history.replaceState({},document.title,FLBuilderConfig.url),this.isEditing=!1}},r={$row:null,$rowContent:null,row:null,drag:{},init:function(){if(this.userCanResize()){var t=e(i._contentClass);t.delegate(".fl-block-row-resize","mouseenter",this.onDragHandleHover.bind(this)),t.delegate(".fl-block-row-resize","mousedown",this.onDragHandleDown.bind(this))}},userCanResize:function(){return FLBuilderConfig.rowResize.userCanResizeRows},onDragHandleHover:function(i){if(!this.drag.isDragging){var t=e(i.target),l=t.closest(".fl-row"),n=l.data("node"),s=FLBuilderSettingsConfig.nodes[n],o=e(".fl-builder-row-settings[data-node="+n+"]"),r=o.find("[name=max_content_width_unit]"),a=r.length?r.val():s.max_content_width_unit;this.$row=l,this.$rowContent=this.$row.find(".fl-row-content"),this.row={node:n,form:o,unit:a,isFixedWidth:this.$row.hasClass("fl-row-fixed-width"),parentWidth:"vw"===a?e(window).width():this.$row.parent().width()},this.drag={edge:null,isDragging:!1,originalPosition:null,originalWidth:null,calculatedWidth:null,operation:null},this.row.isFixedWidth?this.drag.originalWidth=this.$row.width():this.drag.originalWidth=this.$rowContent.width(),this.dragInit()}},onDragHandleDown:function(){e("body").addClass("fl-builder-row-resizing")},dragInit:function(e){this.$row.find(".fl-block-row-resize").draggable({axis:"x",start:this.dragStart.bind(this),drag:this.dragging.bind(this),stop:this.dragStop.bind(this)})},dragStart:function(t,l){var n=e("body"),s=e(l.helper);this.drag.isDragging=!0,this.row.isFixedWidth?this.drag.originalWidth=this.$row.width():this.drag.originalWidth=this.$rowContent.width(),s.hasClass("fl-block-col-resize-e")&&(this.drag.edge="e",this.$feedback=s.find(".fl-block-col-resize-feedback-left")),s.hasClass("fl-block-col-resize-w")&&(this.drag.edge="w",this.$feedback=s.find(".fl-block-col-resize-feedback-right")),n.addClass("fl-builder-row-resizing"),i._colResizing=!0,i._destroyOverlayEvents(),i._closePanel()},dragging:function(e,i){var t=i.position.left,l=i.originalPosition.left,n=this.drag.originalWidth,s=0,o=this.drag.edge,r=FLBuilderConfig.rowResize.minAllowedWidth,a=FLBuilderConfig.rowResize.maxAllowedWidth;l!==t&&(FLBuilderConfig.isRtl&&(o="w"==o?"e":"w"),l>t?"w"===o?this.drag.operation="+":this.drag.operation="-":"e"===o?this.drag.operation="+":this.drag.operation="-",s=Math.abs(l-t),"+"===this.drag.operation?this.drag.calculatedWidth=n+2*s:this.drag.calculatedWidth=n-2*s,!1!==r&&this.drag.calculatedWidth<r&&(this.drag.calculatedWidth=r),!1!==a&&this.drag.calculatedWidth>a&&(this.drag.calculatedWidth=a),this.row.isFixedWidth&&this.$row.css("max-width",this.drag.calculatedWidth+"px"),this.$rowContent.css("max-width",this.drag.calculatedWidth+"px"),"px"!==this.row.unit&&(this.drag.calculatedWidth=Math.round(this.drag.calculatedWidth/this.row.parentWidth*100)),_.isUndefined(this.$feedback)||this.$feedback.html(this.drag.calculatedWidth+this.row.unit).show(),this.row.form.length&&this.row.form.find("[name=max_content_width]").val(this.drag.calculatedWidth))},dragStop:function(t,l){this.drag.isDragging=!1,_.isUndefined(this.$feedback)||this.$feedback.hide();var n={action:"resize_row_content",node:this.row.node,width:this.drag.calculatedWidth},s=e("body");i.ajax(n),i._bindOverlayEvents(),s.removeClass("fl-builder-row-resizing"),e(".fl-block-overlay").each(function(){i._buildOverlayOverflowMenu(e(this))}),e("body").removeClass("fl-builder-row-resizing"),setTimeout(function(){i._colResizing=!1},50),i.triggerHook("didResizeRow",{rowId:this.row.node,rowWidth:this.drag.calculatedWidth})}},a={templateName:"fl-toolbar",init:function(){this.template=wp.template(this.templateName),this.render(),this.initTipTips();var e=this.$el.find(".fl-builder-content-panel-button");e.on("click",i._togglePanel),this.$el.find(".fl-builder-buy-button").on("click",i._upgradeClicked),this.$el.find(".fl-builder-upgrade-button").on("click",i._upgradeClicked),this.$el.find("#fl-builder-toggle-notifications").on("click",this.onNotificationsButtonClicked.bind(this)),i.addHook("notificationsLoaded",this.onNotificationsLoaded.bind(this))},render:function(i){var t=e(this.template(i));this.$el=t,this.el=t.get(0),s.$mainToolbar=this.$el,e("body").prepend(t),e("html").addClass("fl-builder-is-showing-toolbar")},initTipTips:function(){e(".fl-builder--saving-indicator").tipTip({defaultPosition:"bottom",edgeOffset:14}),e(".fl-builder-publish-actions .fl-builder-button-group .fl-builder-button").tipTip({defaultPosition:"bottom",edgeOffset:6})},onNotificationsButtonClicked:function(){i.triggerHook("toggleNotifications")},onNotificationsLoaded:function(){e("body").removeClass("fl-builder-has-new-notifications");var t={action:"fl_builder_notifications",read:!0};i.ajax(t)}};e(function(){i.ContentPanel.init(),FLBuilderConfig.simpleUi||i.MainMenu.init(),FLBuilderConfig.showToolbar?(a.init(),i.ContentPanel.alignPanelArrow()):e("html").addClass("fl-builder-no-toolbar"),t.init(),l.init(),s.init(),o.init(),r.init(),n.init(),i.triggerHook("didInitUI")})}(jQuery,FLBuilder),function(e,i){var t=FLExtendableObject.create({templateName:"fl-main-menu-panel-view",name:"Untitled View",isShowing:!1,isRootView:!1,items:{},init:function(){this.template=wp.template(this.templateName)},render:function(){return this.template(this)},bindEvents:function(){this.$items=this.$el.find(".fl-builder--menu-item")},show:function(){this.$el.addClass("is-showing")},hide:function(){this.$el.removeClass("is-showing")},transitionIn:function(e){requestAnimationFrame(this.show.bind(this))},transitionOut:function(e){this.hide()}}),l=FLExtendableObject.create({templateName:"fl-main-menu-panel",template:null,menu:null,views:{},viewNavigationStack:[],isShowing:!1,shouldShowTabs:!1,init:function(){this.template=wp.template(this.templateName),e("body").prepend(this.template(this)),this.$el=e(".fl-builder--main-menu-panel"),this.$el.find(".fl-builder--main-menu-panel-views").html("");for(var t in FLBuilderConfig.mainMenu){this.renderPanel(t);var l="render"+t.charAt(0).toUpperCase()+t.slice(1)+"Panel";i.addHook(l,e.proxy(function(){this.renderPanel(t)},this))}e("body").on("click",".fl-builder--main-menu-panel .pop-view",this.goToPreviousView.bind(this)),this.$tabs=this.$el.find(".fl-builder--tabs > span"),this.$tabs.on("click",this.onItemClick.bind(this)),this.$barTitle=e(".fl-builder-bar-title"),e("body").on("click",".fl-builder-bar-title",this.toggle.bind(this));var o=this.hide.bind(this);i.addHook("didShowPublishActions",o),i.addHook("didBeginSearch",o),i.addHook("didBeginPreview",o),i.addHook("didShowContentPanel",o),i.addHook("endEditingSession",o),i.addHook("didFocusSearchBox",o),i.addHook("didEnterRevisionPreview",o),i.addHook("didFailSettingsSave",o),i.addHook("showKeyboardShortcuts",o),this.$mask=e(".fl-builder--main-menu-panel-mask"),this.$mask.on("click",o),n.init(),s.init()},renderPanel:function(i){var l,n,s;e('fl-builder--main-menu-panel-view[data-name="'+i+'"]').remove(),l=FLBuilderConfig.mainMenu[i],l.handle=i,n=t.create(l),n.init(),s=e(n.render()),n.$el=s,e(".fl-builder--main-menu-panel-views").append(s),n.bindEvents(),n.$el.find(".fl-builder--menu-item").on("click",this.onItemClick.bind(this)),n.isRootView&&(this.rootView=n,this.currentView=n),this.views[i]=n},show:function(){this.isShowing||(this.$el.addClass("is-showing"),this.$barTitle.addClass("is-showing-menu"),this.currentView.transitionIn(),this.isShowing=!0,this.$mask.show(),i.triggerHook("didOpenMainMenu"))},hide:function(){this.isShowing&&(this.$el.removeClass("is-showing"),this.$barTitle.removeClass("is-showing-menu"),this.isShowing=!1,this.resetViews(),this.$mask.hide())},toggle:function(){this.isShowing?this.hide():this.show()},onItemClick:function(t){var l=e(t.currentTarget),n=l.data("type");switch(n){case"view":var s=l.data("view");this.goToView(s);break;case"event":var o=l.data("event");i.triggerHook(o,l);break;case"link":}},goToView:function(e){var i=this.currentView,t=this.views[e];i.transitionOut(),t.transitionIn(),this.currentView=t,this.viewNavigationStack.push(i)},goToPreviousView:function(){var i=this.currentView,t=this.viewNavigationStack.pop();i.transitionOut(!0),t.transitionIn(!0),this.currentView=t,e(".fl-builder-bar-title-caret").focus()},resetViews:function(){this.currentView!=this.rootView&&(this.currentView.hide(),this.rootView.show(),this.currentView=this.rootView,this.viewNavigationStack=[])}});i.MainMenu=l;var n={init:function(){i.addHook("saveTemplate",this.saveTemplate.bind(this)),i.addHook("saveCoreTemplate",this.saveCoreTemplate.bind(this)),i.addHook("duplicateLayout",this.duplicateLayout.bind(this)),i.addHook("showLayoutSettings",this.showLayoutSettings.bind(this)),i.addHook("showGlobalSettings",this.showGlobalSettings.bind(this)),i.addHook("toggleUISkin",this.toggleUISkin.bind(this)),i.addHook("clearLayoutCache",this.clearLayoutCache.bind(this))},saveTemplate:function(){i._saveUserTemplateClicked(),l.hide()},saveCoreTemplate:function(){FLBuilderCoreTemplatesAdmin._saveClicked(),l.hide()},duplicateLayout:function(){i._duplicateLayoutClicked(),l.hide()},showGlobalSettings:function(){i._globalSettingsClicked(),l.hide()},showLayoutSettings:function(){i._layoutSettingsClicked(),l.hide()},clearLayoutCache:function(){i.ajax({action:"clear_cache"},function(){location.href=FLBuilderConfig.editUrl}),i.showAjaxLoader(),l.hide()},toggleUISkin:function(t){e('a[data-event="toggleUISkin"]');if(e("body").hasClass("fl-builder-ui-skin--light"))var l="light",n="dark";if(e("body").hasClass("fl-builder-ui-skin--dark"))var l="dark",n="light";e("body").removeClass("fl-builder-ui-skin--"+l).addClass("fl-builder-ui-skin--"+n),i.ajax({action:"save_ui_skin",skin_name:n})}},s={init:function(){i.addHook("beginTour",this.onStartTourClicked.bind(this))},onStartTourClicked:function(){FLBuilderTour.start(),l.hide()}}}(jQuery,FLBuilder),function(e,i){var t=FLExtendableObject.create({handle:"",name:"",panel:null,shouldShowTabItem:!0,isShowing:!1,views:{},activeView:null,defaultView:null,categorySelector:null,init:function(t){this.categorySelector=a.create({handle:"selector-"+this.handle,tab:this,items:[]}),this.categorySelector.init(),e(this.categorySelector).on("categorySelected",this.onViewSelected.bind(this));t.views;if(this.initViews(t.views),0===Object.keys(this.views).length){var l={handle:"noViews",name:"No Views",templateName:"fl-content-panel-no-view"};this.addView(l)}if(!this.activeView){var n=Object.keys(this.views)[0],l=this.views[n];this.activeView=l}this.defaultView=this.activeView,e(this.panel).on("afterRender",this.renderView.bind(this,this.activeView)),e(this.panel).on("onShow onShowTab",this.initScroller.bind(this)),i.addHook("contentItemsChanged",this.onLibraryDataChanged.bind(this))},initViews:function(e){for(var i in e){var t=e[i];this.categorySelector.addItem(t),"separator"!==t.type&&this.addView(t)}},addView:function(e){var i=l;switch(this.handle){case"modules":i=n;break;case"rows":i=s;break;case"templates":i=o;break;case"saved":i=r;break;default:i=l}_.isNull(this.viewController)||_.isUndefined(this.viewController)||(i=window[this.viewController]);var t=i.create(e),a=t.handle;t.init(),this.views[a]=t,t.isShowing&&(this.activeView=t)},renderView:function(e){if(this.$el=this.panel.$el.find('.fl-builder--panel-view[data-tab="'+this.handle+'"]'),_.isObject(e))var t=e;else var t=this.views[e];if(_.isObject(t)&&_.isFunction(t.render)){var l=t.render();this.$el.find(".fl-nanoscroller-content").html(l),this.activeView=t,i._initSortables(),this===this.panel.activeTab&&this.renderGroupSelector(),this.initScroller(),this.$el.find(".fl-nanoscroller-content").scrollTop(0)}},initScroller:function(){this.$el.nanoScroller({alwaysVisible:!0,preventPageScrolling:!0,paneClass:"fl-nanoscroller-pane",sliderClass:"fl-nanoscroller-slider",contentClass:"fl-nanoscroller-content"})},show:function(){e(this.activeView).trigger("onBeforeShow"),this.renderGroupSelector(),this.isShowing=!0,this.$el.addClass("is-showing"),this.$el.find(".fl-nanoscroller-content").scrollTop(0)},hide:function(){this.isShowing=!1,this.$el.removeClass("is-showing"),this.activeView!==this.defaultView&&this.renderView(this.defaultView),_.isObject(this.categorySelector)&&this.categorySelector.close()},renderGroupSelector:function(){var e=this.panel.$groupSelect,i=this.panel.$el.find(".fl-builder-panel-search");if(this.isSearchEnabled?i.show():i.hide(),Object.keys(this.views).length>1&&!_.isUndefined(this.categorySelector)){var t=this.categorySelector.render();this.panel.$el.find(".fl-builder-content-group-select");e.html(t),e.show(),this.panel.$el.removeClass("single-view")}else e.hide(),i.hide(),this.panel.$el.addClass("single-view")},onViewSelected:function(e,i){this.renderView(i),this.categorySelector.close()},onLibraryDataChanged:function(){this.renderView(this.activeView)}}),l=FLExtendableObject.create({templateName:"",name:"",handle:"",query:null,init:function(){this.template=wp.template(this.templateName),e(this).on("afterRender",this.bindEvents.bind(this)),e(this).trigger("afterInit")},filterTemplateData:function(e){return _.isNull(this.query)||_.isUndefined(this.query)||(e.queryResults=i.Search.byQuery(this.query)),e},render:function(){e(this).trigger("beforeRender");var i=this;i=this.filterTemplateData(i);var t=e(this.template(i));return this.$el=t,e(this).trigger("afterRender"),t},bindEvents:function(){},transitionIn:function(){},transitionOut:function(){}}),n=l.create({templateName:"fl-content-panel-modules-view",bindEvents:function(){this.$sections=this.$el,this.$items=this.$el.find(".fl-builder-block, .fl-builder-blocks-section-title")}}),s=l.create({templateName:"fl-content-panel-row-templates-view",bindEvents:function(){this.$items=this.$el.find(".fl-builder-block, .fl-builder-blocks-section-title")}}),o=l.create({templateName:"fl-content-panel-templates-view",bindEvents:function(){this.$items=this.$el.find(".fl-builder--template-collection-item"),this.$items.on("click",this.onTemplateClick.bind(this)),this.$userTemplateSections=e(".fl-user-templates"),this.$userTemplates=this.$el.find(".fl-user-template, .fl-builder--save-new-user-template"),this.$saveNewTemplateInput=this.$el.find('.fl-save-control input[name="template-name"]'),this.$saveNewTemplateCat=this.$el.find('.fl-save-control input[name="template-category"]'),this.$saveNewTemplateBtn=this.$el.find(".fl-save-control button"),this.$saveNewMask=this.$el.find(".fl-save-control-mask"),this.$saveNewTemplateInput.on("focus",this.onSaveInputFocus.bind(this)),this.$saveNewTemplateInput.on("keyup",this.onSaveInputKeyup.bind(this)),this.$saveNewTemplateBtn.on("click",this.onSaveButtonClick.bind(this)),this.$saveNewMask.on("click",this.resetSaveInput.bind(this))},onSaveInputFocus:function(){this.resetSaveInput(),this.$saveNewMask.show()},resetSaveInput:function(){this.$saveNewTemplateInput.val(""),this.$saveNewTemplateBtn.hide(),this.$saveNewMask.hide()},onSaveInputKeyup:function(i){var t=e(i.currentTarget),l=t.val(),n=t.siblings("button");""!==l?n.show():n.hide()},onSaveButtonClick:function(t){var l=e(t.currentTarget),n=l.siblings('input[name="template-name"]').val(),s=l.siblings('input[name="template-category"]').val(),o={name:n,category:s};""!==n&&i.ajax({action:"save_user_template",settings:o},i._saveUserTemplateSettingsComplete)},onTemplateClick:function(t){var l=e(t.currentTarget),n=l.data("id"),s=l.data("type");i._requestTemplateInsert(n,s)}}),r=l.create({templateName:"fl-content-panel-saved-view",filterTemplateData:function(e){return e.queryResults=i.Search.byQuery({kind:"template",type:"user",content:["module","column","row"]}),e}}),a=FLExtendableObject.create({templateName:"fl-content-panel-category-selector",template:null,tab:null,isOpen:!1,items:{},init:function(){this.template=wp.template(this.templateName),e(this).on("afterRender",this.bindEvents.bind(this)),e(this.tab.panel).on("didShowSearchControls",this.close.bind(this))},render:function(){this.close();var i=e(this.template(this));return this.$el=i,e(this).trigger("afterRender"),i},bindEvents:function(){this.$selectorTitle=this.$el.find(".fl-builder--selector-display"),this.$selectorTitle.on("click",this.toggleOpenClose.bind(this)),this.$categories=this.$el.find(".fl-builder--selector-menu .fl-builder--menu-item"),this.$categories.on("click",this.onCategoryClick.bind(this))},addItem:function(e){var i;i=_.isUndefined(e.handle)?_.uniqueId("sep_"):e.handle,this.items[i]=e},open:function(){this.isOpen||(this.$el.addClass("is-showing"),this.isOpen=!0)},close:function(){this.isOpen&&(this.$el.removeClass("is-showing"),this.isOpen=!1,this.$selectorTitle.find("button").focus())},toggleOpenClose:function(){this.isOpen?this.close():this.open()},onCategoryClick:function(i){var t=e(i.target),l=t.data("view");if(t.hasClass("fl-has-children")){var n=e('[data-parent="'+l+'"]');n.is(":visible")?(this.items[l].hasChildrenOpen=!1,t.removeClass("fl-has-children-showing"),n.hide()):(this.items[l].hasChildrenOpen=!0,t.addClass("fl-has-children-showing"),n.show()),t.blur()}else e(this).trigger("categorySelected",l)}});i.ContentPanel=FLExtendableObject.create({templateName:"fl-content-panel-base",template:null,tabs:{},activeTab:null,isShowing:!1,init:function(){if(FLBuilderConfig.panelData){var e=FLBuilderConfig.panelData.tabs;for(var l in e){var n=e[l];if(o=t.create(n),o.panel=this,o.views={},o.init(n),this.tabs[l]=o,o.isShowing&&(this.activeTab=o),!this.activeTab){var s=Object.keys(this.tabs)[0],o=this.tabs[s];o.isShowing=!0,this.activeTab=o}}this.template=wp.template(this.templateName),this.render(),this.renderSearchResults=wp.template("fl-search-results-panel"),this.renderNoResults=wp.template("fl-search-no-results"),i.triggerHook("contentPanelDidInit")}},render:function(){e("body").prepend(this.template(this)),this.$el=e(".fl-builder--content-library-panel"),this.bindEvents(),this.$groupSelect=this.$el.find(".fl-builder-content-group-select"),e(this).trigger("afterRender")},bindEvents:function(){this.$tabs=this.$el.find(".fl-builder--tabs [data-tab]"),this.$tabs.on("mouseup",this.onTabItemMouseUp.bind(this)),this.$tabs.on("click",this.onTabItemClick.bind(this)),this.$search=this.$el.find(".fl-builder-panel-search"),this.$searchBtn=this.$search.find(".fl-builder-toggle-panel-search"),this.$searchInput=this.$search.find('input[name="search-term"]'),this.$searchBtn.on("click",this.onSearchButtonClicked.bind(this)),this.$search.find(".fl-builder-dismiss-panel-search").on("click",this.onDismissButtonClicked.bind(this)),this.$searchInput.on("keyup",this.onSearchTermChanged.bind(this)),this.$searchPanel=this.$el.find(".fl-builder--search-results-panel"),i.addHook("showContentPanel",this.show.bind(this)),i.addHook("showModules",this.show.bind(this,"modules")),i.addHook("showRows",this.show.bind(this,"rows")),i.addHook("showTemplates",this.show.bind(this,"templates")),i.addHook("showSaved",this.show.bind(this,"saved")),i.addHook("showSearch",this.goToSearch.bind(this));var e=this.hide.bind(this);i.addHook("hideContentPanel",e),i.addHook("didShowLightbox",e),i.addHook("didShowPublishActions",e),i.addHook("didBeginSearch",e),i.addHook("didInitDrag",e),i.addHook("didOpenMainMenu",e),i.addHook("didApplyTemplate",e);var t=this.toggleShowHide.bind(this);i.addHook("toggleContentPanel",t),i.addHook("didStopDrag",this.hideSearchControls.bind(this))},alignPanelArrow:function(){var i,t,l=this.$el,n=null,s=this.$el.find(".fl-builder--panel-arrow"),o=e(".fl-builder-content-panel-button"),r=this.$el.css("animation-duration");if(0!=o.length){this.$el.css("animation-duration","0s"),this.show(),n=l[0].getBoundingClientRect(),i=s[0].getBoundingClientRect(),this.hide(),this.$el.css("animation-duration",r);var a=o[0].getBoundingClientRect(),d=a.x+a.width/2;t=d<n.x?20:d-n.x-i.width/2,s.css({right:"auto",left:t+"px"})}},show:function(t){"module"===FLBuilderConfig.userTemplateType||FLBuilderConfig.simpleUi||(i.triggerHook("willShowContentPanel"),"undefined"!=typeof t&&this.showTab(t),this.isShowing||i._triggerSettingsSave(!1,!0)&&(e("body").addClass("fl-builder-content-panel-is-showing"),this.isShowing=!0,e(this).trigger("onShow"),i.triggerHook("didShowContentPanel")))},hide:function(){this.isShowing&&(this.$el.hasClass("fl-builder-ui-pinned")||(e("body").removeClass("fl-builder-content-panel-is-showing"),this.isShowing=!1,e(this).trigger("onHide"),i.triggerHook("didHideContentPanel")))},toggleShowHide:function(){this.isShowing?this.hide():this.show()},showTab:function(i){var t=this.tabs[i];_.isObject(t)&&(_.isObject(this.activeTab)&&(this.activeTab.hide(),this.$tabs.filter(".is-showing").removeClass("is-showing")),this.hideSearchControls(),t.show(),this.$tabs.filter('[data-tab="'+t.handle+'"]').addClass("is-showing"),this.activeTab=t,e(this).trigger("onShowTab"))},goToSearch:function(){this.show("modules"),this.$el.find(".fl-builder-toggle-panel-search").trigger("click")},onTabItemMouseUp:function(i){e(i.currentTarget).blur()},onTabItemClick:function(i){var t=e(i.target),l=t.data("tab");this.showTab(l)},onSearchButtonClicked:function(){this.showSearchControls()},onDismissButtonClicked:function(){this.hideSearchControls(),this.$searchBtn.focus()},showSearchControls:function(){this.$search.addClass("is-showing-input"),this.$search.find('input[name="search-term"]').focus(),e(".fl-builder--selector-display-label").attr("tabindex",-1),this.$searchBtn.attr("tabindex",-1),e(this).trigger("didShowSearchControls")},hideSearchControls:function(){this.$search.removeClass("is-showing-input"),this.clearSearchInput(),this.hideSearchResults(),e(".fl-builder--selector-display-label").attr("tabindex",null),this.$searchBtn.attr("tabindex",null)},onSearchTermChanged:function(e){var t=this.$searchInput.val();if(""!==t){var l=i.Search.byTerm(t);""!=l.term?this.showSearchResults(l):this.hideSearchResults()}else this.hideSearchResults()},clearSearchInput:function(){this.$searchInput.val(""),this.hideSearchResults()},showSearchResults:function(t){if(t.total>0){var l=e(this.renderSearchResults(t));this.$searchPanel.html(l),i._initSortables()}else{var l=e(this.renderNoResults(t));this.$searchPanel.html(l)}e("body").addClass("fl-builder-search-results-panel-is-showing")},hideSearchResults:function(){e("body").removeClass("fl-builder-search-results-panel-is-showing")}})}(jQuery,FLBuilder),function(e){FLBuilderSettingsForms={config:null,settings:null,legacyXhr:null,init:function(){this.bind()},bind:function(){FLBuilder.addHook("didDeleteRow",this.closeOnDeleteNode),FLBuilder.addHook("didDeleteColumn",this.closeOnDeleteNode),FLBuilder.addHook("didDeleteModule",this.closeOnDeleteNode)},render:function(i,t){var l=FLBuilderSettingsConfig.forms,n=FLBuilderSettingsConfig.modules,s={type:"general",id:null,nodeId:null,className:"",attrs:"",title:"",badges:[],tabs:[],buttons:[],settings:{},legacy:null,rules:null,preview:null,helper:null,messages:null};if(i.nodeId&&!i.settings)return void this.loadNodeSettings(i,t);if(i=e.extend(s,i),t=void 0===t?function(){}:t,i.id){if("general"===i.type&&void 0!==l[i.id])i=e.extend(!0,i,l[i.id]);else{if("module"!==i.type||void 0===n[i.id])return;i=e.extend(!0,i,n[i.id])}this.config=i,this.renderLightbox(i)&&(i.legacy||!this.renderLegacySettings(i,t)?this.renderComplete(i,t):this.showLightboxLoader())}},loadNodeSettings:function(e,i){FLBuilder.showAjaxLoader(),FLBuilder.ajax({action:"get_node_settings",node_id:e.nodeId},function(t){e.settings=FLBuilder._jsonParse(t),FLBuilderSettingsConfig.nodes[e.nodeId]=e.settings,FLBuilderSettingsForms.render(e,i),FLBuilder.hideAjaxLoader()})},renderLightbox:function(i){var t=wp.template("fl-builder-settings"),l=FLBuilder._lightbox._node.find("form.fl-builder-settings");e(".fl-lightbox-wrap[data-parent]");if(i.nodeId&&i.nodeId===l.data("node")&&!i.lightbox)return FLBuilder._focusFirstSettingsControl(),!1;if(i.hide)return!0;if(i.lightbox)i.lightbox.setContent(t(i));else{if(!FLBuilder._triggerSettingsSave(!0,!0))return!1;FLBuilder.preview&&FLBuilder.preview.cancel(),FLBuilder._closePanel(),FLBuilder._showLightbox(t(i))}return!0},renderComplete:function(i,t){var l=e(".fl-builder-settings:visible");setTimeout(function(){i.legacy&&this.renderLegacySettingsComplete(i.legacy),t(),FLBuilder._initSettingsForms(),i.rules&&FLBuilder._initSettingsValidation(i.rules,i.messages),i.preview&&(FLBuilder.preview=new FLBuilderPreview(i.preview)),i.helper&&i.helper.init(),l.closest(".fl-lightbox-wrap[data-parent]").length||(this.settings=FLBuilder._getSettingsForChangedCheck(this.config.nodeId,l))}.bind(this),1)},renderFields:function(i,t){var l=wp.template("fl-builder-settings-row"),n="",s=null,o=null,r=null,a=!1,d=null,u=["align","border","dimension","unit","photo","select","typography"],t=t?t:this.config.settings,c=FLBuilderConfig.global;for(o in i)s=i[o],a=!!s.multiple,supportsResponsive=e.inArray(s.type,u)>-1,r=_.isUndefined(t[o])?"":t[o],s.type&&(_.isUndefined(t[o])&&s["default"]&&(r=s["default"]),d=s.responsive&&c.responsive_enabled&&!a&&supportsResponsive?s.responsive:null,n+=l({field:s,name:o,rootName:o,value:r,preview:JSON.stringify(s.preview?s.preview:{type:"refresh"}),responsive:d,rowClass:s.row_class?" "+s.row_class:"",isMultiple:a,supportsMultiple:"editor"!==s.type&&"service"!==s.type,settings:t,globalSettings:c,template:e("#tmpl-fl-builder-field-"+s.type)}));return n},renderField:function(e){var i=wp.template("fl-builder-field");return i(e)},renderSectionTemplate:function(e,i){var t=wp.template(e.template.id);return t({section:e,settings:i})},renderTabTemplate:function(e,i){var t=wp.template(e.template.id);return t({tab:e,settings:i})},renderLegacySettings:function(i,t){var l=e(".fl-builder-settings:visible"),n=null,s=!1,o={tabs:[],sections:[],fields:[],settings:null,node_id:null};return l.find(".fl-legacy-field").each(function(){n=e(this),o.fields.push(n.attr("data-field")),FLBuilderSettingsForms.showFieldLoader(n),s=!0}),l.find(".fl-legacy-settings-section").each(function(){n=e(this),o.sections.push({tab:n.attr("data-tab"),section:n.attr("data-section")}),s=!0}),l.find(".fl-legacy-settings-tab").each(function(){n=e(this),o.tabs.push(n.attr("data-tab")),s=!0}),l.attr("data-node")?o.node_id=l.attr("data-node"):o.settings=FLBuilder._getOriginalSettings(l,!0),this.legacyXhr&&(this.legacyXhr.abort(),this.legacyXhr=null),this.legacyXhr=FLBuilder.ajax(e.extend(this.getLegacyVars(),{action:"render_legacy_settings",data:o,form:l.attr("data-form-id"),group:l.attr("data-form-group"),lightbox:l.closest(".fl-builder-lightbox").attr("data-instance-id")}),function(e){FLBuilderSettingsForms.renderLegacySettingsComplete(e),s&&FLBuilderSettingsForms.renderComplete(i,t),FLBuilderSettingsForms.hideLightboxLoader()}),s},renderLegacySettingsComplete:function(i){var t="object"==typeof i?i:FLBuilder._jsonParse(i),l=null,n=null,s="",o=null,r=null,a=null;if(t.lightbox?(l=e(".fl-builder-lightbox[data-instance-id="+t.lightbox+"]"),n=l.length?l.find(".fl-builder-settings"):null):(n=e(".fl-builder-settings:visible"),l=n.closest(".fl-builder-lightbox")),n&&n.length){for(s in t.fields)o=e("#fl-field-"+s).attr("id",""),o.after(t.fields[s]).remove();for(s in t.extras)o=e("#fl-field-"+s).find(".fl-field-control-wrapper"),t.extras[s].multiple?o.each(function(i,l){i in t.extras[s].before&&""!=t.extras[s].before[i]&&e(this).prepend('<div class="fl-form-field-before">'+t.extras[s].before[i]+"</div>"),i in t.extras[s].after&&""!=t.extras[s].after[i]&&e(this).append('<div class="fl-form-field-after">'+t.extras[s].after[i]+"</div>")}):(""!=t.extras[s].before&&o.prepend('<div class="fl-form-field-before">'+t.extras[s].before+"</div>"),""!=t.extras[s].after&&o.append('<div class="fl-form-field-after">'+t.extras[s].after+"</div>"));for(a in t.sections)for(s in t.sections[a])r=e("#fl-builder-settings-section-"+s),r.html(t.sections[a][s]);for(s in t.tabs)a=e("#fl-builder-settings-tab-"+s),a.html(t.tabs[s]);l.data("parent")||(this.settings=FLBuilder._getSettingsForChangedCheck(this.config.nodeId,n),FLBuilder.preview&&(this.settings=e.extend(this.settings,FLBuilder.preview._savedSettings),FLBuilder.preview._savedSettings=this.settings)),_.isUndefined(window.FLThemeBuilderFieldConnections)||FLThemeBuilderFieldConnections._initSettingsForms(),this.legacyXhr=null}},getLegacyVars:function(){var i=e(".fl-builder-settings:visible"),t=i.closest(".fl-builder-lightbox"),l=t.attr("data-parent"),n=null,s=null,o={};return l&&(l=e(".fl-builder-lightbox[data-instance-id="+l+"]"),i=l.find("form.fl-builder-settings"),n=FLBuilder._getSettings(i),s=i.attr("data-node"),s&&(o.node_id=s,o.node_settings=n)),o},settingsHaveChanged:function(){var e=FLBuilder._lightbox._node.find("form.fl-builder-settings"),i=FLBuilder._getSettings(e),t=!!this.settings&&JSON.stringify(this.settings)!=JSON.stringify(i);return t},closeOnDeleteNode:function(i,t){var l=e(".fl-builder-settings[data-node]"),n=FLBuilder._contentClass+" .fl-node-"+l.data("node");l.length&&!e(n).length&&FLLightbox.closeAll()},showLightboxLoader:function(){e(".fl-builder-settings:visible").append('<div class="fl-builder-loading"></div>')},hideLightboxLoader:function(i){e(".fl-builder-settings:visible .fl-builder-loading").remove()},showFieldLoader:function(e){var i=e.closest(".fl-field-control").find(".fl-field-control-wrapper");i.hide().after('<div class="fl-field-loader">'+FLBuilderStrings.fieldLoading+"</div>")},hideFieldLoader:function(e){var i=e.closest(".fl-field"),t=e.closest(".fl-field-control").find(".fl-field-control-wrapper");t.show(),i.find(".fl-field-loader").remove()}},FLBuilderSettingsConfig="undefined"==typeof FLBuilderSettingsConfig?{}:FLBuilderSettingsConfig,e.extend(FLBuilderSettingsConfig,{init:function(){FLBuilder.addHook("didSaveNodeSettings",this.updateOnNodeEvent.bind(this)),FLBuilder.addHook("didSaveNodeSettingsComplete",this.updateOnNodeEvent.bind(this)),FLBuilder.addHook("didSaveLayoutSettingsComplete",this.updateOnSaveLayoutSettings.bind(this)),FLBuilder.addHook("didSaveGlobalSettingsComplete",this.updateOnSaveGlobalSettings.bind(this)),FLBuilder.addHook("didSaveGlobalSettingsComplete",this.reload),FLBuilder.addHook("didAddRow",this.updateOnNodeEvent.bind(this)),FLBuilder.addHook("didAddColumnGroup",this.updateOnNodeEvent.bind(this)),FLBuilder.addHook("didAddColumn",this.updateOnNodeEvent.bind(this)),FLBuilder.addHook("didAddModule",this.updateOnNodeEvent.bind(this)),FLBuilder.addHook("didDeleteRow",this.updateOnNodeEvent.bind(this)),FLBuilder.addHook("didDeleteColumn",this.updateOnNodeEvent.bind(this)),FLBuilder.addHook("didDeleteModule",this.updateOnNodeEvent.bind(this)),FLBuilder.addHook("didDuplicateRow",this.updateOnNodeEvent.bind(this)),FLBuilder.addHook("didDuplicateColumn",this.updateOnNodeEvent.bind(this)),FLBuilder.addHook("didDuplicateModule",this.updateOnNodeEvent.bind(this)),FLBuilder.addHook("didResizeRow",this.updateOnRowResize.bind(this)),FLBuilder.addHook("didResizeColumn",this.updateOnColumnResize.bind(this)),FLBuilder.addHook("didResetRowWidth",this.updateOnResetRowWidth.bind(this)),FLBuilder.addHook("didResetColumnWidths",this.updateOnResetColumnWidths.bind(this)),FLBuilder.addHook("didApplyTemplateComplete",this.updateOnApplyTemplate.bind(this)),FLBuilder.addHook("didApplyRowTemplateComplete",this.updateOnApplyTemplate.bind(this)),FLBuilder.addHook("didApplyColTemplateComplete",this.updateOnApplyTemplate.bind(this)),FLBuilder.addHook("didSaveGlobalNodeTemplate",this.updateOnApplyTemplate.bind(this)),FLBuilder.addHook("didRestoreRevisionComplete",this.updateOnApplyTemplate.bind(this))},reload:function(){var i=FLBuilderConfig.editUrl+"&fl_builder_load_settings_config=core";e('script[src*="fl_builder_load_settings_config=core"]').remove(),
e("head").append('<script src="'+i+'"></script>')},updateOnSaveGlobalSettings:function(e,i){this.settings.global=i},updateOnSaveLayoutSettings:function(e,i){this.settings.layout=i},updateOnNodeEvent:function(){var e=arguments[0];e.namespace.indexOf("didAdd")>-1?this.addNode(arguments[1]):e.namespace.indexOf("didSaveNodeSettings")>-1?this.updateNode(arguments[1].nodeId,arguments[1].settings):e.namespace.indexOf("didDelete")>-1?this.deleteNodes():e.namespace.indexOf("didDuplicate")>-1&&this.duplicateNode(arguments[1].oldNodeId,arguments[1].newNodeId)},updateOnRowResize:function(e,i){this.nodes[i.rowId].max_content_width=i.rowWidth},updateOnResetRowWidth:function(e,i){this.nodes[i].max_content_width=""},updateOnColumnResize:function(e,i){this.nodes[i.colId].size=i.colWidth,this.nodes[i.siblingId].size=i.siblingWidth},updateOnResetColumnWidths:function(i,t){var l=this;t.cols.each(function(){var i=e(this),t=i.attr("data-node");l.nodes[t]&&(l.nodes[t].size=parseFloat(i[0].style.width))})},updateOnApplyTemplate:function(e,i){this.nodes=i.nodes,this.attachments=i.attachments},addNode:function(i,t){var l=e(".fl-node-"+i),n=l.hasClass("fl-row"),s=l.hasClass("fl-col"),o=l.hasClass("fl-col-group"),r=l.hasClass("fl-module"),a=this;this.nodes[i]||(t||(n?t=e.extend({},this.defaults.row):s?t=e.extend({},this.defaults.column):r&&(t=e.extend({},this.defaults.modules[l.attr("data-type")])),n||o?l.find(".fl-col").each(function(){var i=e(this),t=e.extend({},a.defaults.column);t.size=parseFloat(i[0].style.width),a.addNode(i.attr("data-node"),t)}):r&&(a.addNode(l.closest(".fl-row").attr("data-node")),a.addNode(l.closest(".fl-col").attr("data-node")),a.updateOnResetColumnWidths(null,{cols:l.closest(".fl-col-group").find("> .fl-col")}))),t&&(this.nodes[i]=t))},updateNode:function(i,t){var l=e(".fl-node-"+i),n=this;l.hasClass("fl-col")&&l.closest(".fl-col-group").find("> .fl-col").each(function(){var i=e(this),l=i.attr("data-node");n.nodes[l].size=parseFloat(i[0].style.width),n.nodes[l].equal_height=t.equal_height,n.nodes[l].content_alignment=t.content_alignment,n.nodes[l].responsive_order=t.responsive_order}),this.nodes[i]=t},duplicateNode:function(i,t){var l=e(".fl-node-"+t),n=l.find("[data-node]"),s=e(".fl-node-"+i),o=s.find("[data-node]"),r=this;this.nodes[t]=this.nodes[i],n.each(function(l){i=o.eq(l).attr("data-node"),t=e(this).attr("data-node"),r.nodes[i]&&(r.nodes[t]=r.nodes[i])})},deleteNodes:function(){var i="",t=e(FLBuilder._contentClass).html();for(i in this.nodes)t.indexOf(i)===-1&&(this.nodes[i]=null,delete this.nodes[i])}}),e(function(){FLBuilderSettingsConfig.init(),FLBuilderSettingsForms.init()})}(jQuery),function(e){var i={minWidth:320,maxWidth:600,minHeight:400,init:function(){this.initPanel(),this.pinOrUnpin(),this.bind()},bind:function(){var i=e(window),t=e("body");i.on("resize",_.throttle(this.windowResize.bind(this),250)),t.delegate(".fl-builder-ui-pinned-collapse","click",this.collapse),t.delegate(".fl-builder--content-library-panel .fl-builder--tabs","click",this.closeLightboxOnPanelClick),FLBuilder.addHook("didShowLightbox",this.pinLightboxOnOpen.bind(this)),FLBuilder.addHook("didHideAllLightboxes",this.pinnedLightboxClosed.bind(this)),FLBuilder.addHook("endEditingSession",this.hide.bind(this)),FLBuilder.addHook("didHideEditingUI",this.hide.bind(this)),FLBuilder.addHook("publishButtonClicked",this.hide.bind(this)),FLBuilder.addHook("restartEditingSession",this.show.bind(this)),FLBuilder.addHook("didShowEditingUI",this.show.bind(this)),FLBuilder.addHook("didShowLightbox",this.uncollapse.bind(this)),FLBuilder.addHook("willShowContentPanel",this.uncollapse.bind(this)),FLBuilder.addHook("willShowContentPanel",this.closeLightboxOnPanelClick.bind(this))},isPinned:function(){return e(".fl-builder--content-library-panel").hasClass("fl-builder-ui-pinned")},pin:function(e,i){this.pinPanel(e),this.pinLightboxes(),i&&this.savePosition(),FLBuilder._resizeLayout(),FLBuilder.triggerHook("didPinContentPanel")},unpin:function(e){this.unpinLightboxes(),this.unpinPanel(),e&&this.savePosition(),FLBuilder._resizeLayout(),FLBuilder.triggerHook("didUnpinContentPanel")},pinOrUnpin:function(){var i=e(".fl-builder--content-library-panel"),t=this.isPinned();i.hasClass("fl-builder-ui-pinned-hidden")||(window.innerWidth<=this.maxWidth?(t&&this.unpin(!1),this.disableDragAndResize()):(t||this.restorePosition(),this.enableDragAndResize()))},show:function(){var i=e(".fl-builder--content-library-panel");i.hasClass("fl-builder-ui-pinned-hidden")&&(i.removeClass("fl-builder-ui-pinned-hidden"),i.show(),this.restorePosition())},hide:function(){var i=e("body"),t=e(".fl-builder--content-library-panel");this.isPinned()&&(this.uncollapse(),t.addClass("fl-builder-ui-pinned-hidden"),t.hide(),i.css("margin",""),FLBuilder._resizeLayout())},collapse:function(){var i=e(this).find("i:visible"),t=e("body"),l=i.data("toggle"),n=i.data("position"),s=e(".fl-builder--content-library-panel"),o=s.outerWidth();"hide"===l?(s.css(n,"-"+o+"px"),t.css("margin-"+n,""),t.addClass("fl-builder-ui-pinned-is-collapsed")):(s.css(n,"0px"),t.css("margin-"+n,o+"px"),t.removeClass("fl-builder-ui-pinned-is-collapsed"))},uncollapse:function(){this.isCollapsed()&&e(".fl-builder-ui-pinned-collapse:visible").trigger("click")},isCollapsed:function(){return e("body").hasClass("fl-builder-ui-pinned-is-collapsed")},initPanel:function(){var i=e(".fl-builder--content-library-panel");i.draggable({cursor:"move",handle:".fl-builder--tabs",cancel:".fl-builder--tabs button",scroll:!1,drag:this.drag.bind(this),stop:this.dragStop.bind(this),start:this.dragStart.bind(this)}).resizable({handles:"e, w",minHeight:this.minHeight,minWidth:this.minWidth,maxWidth:this.maxWidth,start:this.resizeStart.bind(this),stop:this.resizeStop.bind(this)}),i.addClass("fl-builder-ui-pinned-container"),i.find(".ui-resizable-e, .ui-resizable-w").hide()},pinPanel:function(i){var t=e(".fl-builder--content-library-panel"),l=t.outerWidth(),n=e("body"),s=e(".fl-responsive-preview, .fl-responsive-preview-mask"),o=e(FLBuilder._contentClass).parentsUntil("body").last();n.addClass("fl-builder-ui-is-pinned fl-builder-ui-is-pinned-"+i),n.addClass("fl-builder-content-panel-is-showing"),n.css("margin-"+i,l+"px"),s.css("margin-"+i,l+"px"),o.addClass("fl-builder-ui-pinned-content-transform"),t.addClass("fl-builder-ui-pinned fl-builder-ui-pinned-"+i),t.find(".ui-resizable-"+("left"===i?"e":"w")).show(),t.on("resize",_.throttle(this.resize.bind(this),250)),t.attr("style",""),FLBuilder.ContentPanel.isShowing=!0},unpinPanel:function(){var i=e(".fl-builder--content-library-panel"),t=i.find(".fl-builder--panel-content .is-showing").data("tab"),l=e("body"),n=e(".fl-responsive-preview, .fl-responsive-preview-mask"),s=e(FLBuilder._contentClass).parentsUntil("body").last();l.css("margin-left",""),l.css("margin-right",""),l.removeClass("fl-builder-ui-is-pinned"),l.removeClass("fl-builder-ui-is-pinned-left"),l.removeClass("fl-builder-ui-is-pinned-right"),n.css("margin-left",""),n.css("margin-right",""),s.removeClass("fl-lightbox-content-transform"),i.removeClass("fl-builder-ui-pinned"),i.removeClass("fl-builder-ui-pinned-left"),i.removeClass("fl-builder-ui-pinned-right"),i.find(".ui-resizable-handle").hide(),i.off("resize"),i.attr("style",""),i.find(".fl-builder--tabs [data-tab="+t+"]").addClass("is-showing")},pinLightboxes:function(){var i=this;e(".fl-lightbox-resizable").each(function(){i.pinLightbox(e(this))}),FLBuilder._reinitEditorFields()},pinLightbox:function(i){var t=e(".fl-builder--content-library-panel"),l=i.closest(".fl-lightbox-wrap");l.closest(".fl-builder-ui-pinned").length||(t.append(l),i.attr("style",""),i.draggable("disable"),i.resizable("disable")),i.is(":visible")&&t.find(".fl-builder--tabs .is-showing").removeClass("is-showing")},pinLightboxOnOpen:function(e,i){var t=i._node.find(".fl-lightbox-resizable");t.length&&(t.hasClass("fl-builder-ui-pinning-initialized")||(t.draggable("option","start",this.dragStart.bind(this)),t.draggable("option","drag",this.drag.bind(this)),t.draggable("option","stop",this.dragStop.bind(this)),t.addClass("fl-builder-ui-pinning-initialized")),this.isPinned()&&this.pinLightbox(t),FLBuilder.addHook("responsive-editing-switched",this.resize))},pinnedLightboxClosed:function(){var i=e(".fl-builder--content-library-panel");tab=null,this.isPinned()&&(tab=i.find(".fl-builder--panel-content .is-showing").data("tab"),i.find(".fl-builder--tabs [data-tab="+tab+"]").addClass("is-showing")),e(".fl-lightbox").removeClass("fl-lightbox-prevent-animation")},unpinLightboxes:function(){var i=e("body"),t=e(".fl-builder--content-library-panel");t.find(".fl-lightbox-wrap").each(function(){var l=e(this),n=l.find(".fl-lightbox"),s=0,o=0,r=0;n.draggable("enable"),n.resizable("enable"),n.find(".ui-resizable-handle").show(),i.append(l),n.is(":visible")?(s=parseInt(t.css("top"))-parseInt(l.css("top"))-parseInt(l.css("padding-top")),o=parseInt(t.css("left"))-parseInt(l.css("padding-left")),r=parseInt(t.css("right"))-parseInt(l.css("padding-right")),n.css("top",(s<0?0:s)+"px"),n.css(FLBuilderConfig.isRtl?"right":"left",(FLBuilderConfig.isRtl?r:o)+"px"),n.addClass("fl-lightbox-prevent-animation"),i.removeClass("fl-builder-content-panel-is-showing"),FLBuilder.ContentPanel.isShowing=!1):n.css({top:"25px",left:"25px"})}),FLBuilder._reinitEditorFields()},closeLightboxOnPanelClick:function(){FLBuilder._triggerSettingsSave(!1,!0)},windowResize:function(){this.pinOrUnpin()},resizeStart:function(){e("body").addClass("fl-builder-resizable-is-resizing"),FLBuilder._destroyOverlayEvents(),FLBuilder._removeAllOverlays()},resize:function(){var i=e("body"),t=e(".fl-responsive-preview, .fl-responsive-preview-mask"),l=e(".fl-builder--content-library-panel"),n=l.outerWidth();l.hasClass("fl-builder-ui-pinned-left")?(i.css("margin-left",n+"px"),t.css("margin-left",n+"px")):l.hasClass("fl-builder-ui-pinned-right")&&(i.css("margin-right",n+"px"),t.css("margin-right",n+"px"))},resizeStop:function(){e("body").removeClass("fl-builder-resizable-is-resizing"),FLBuilder._bindOverlayEvents(),FLBuilder._resizeLayout(),this.savePosition()},dragStart:function(i,t){var l=e("body"),n=(e(i.target),e(".fl-builder-bar-actions"));e(".fl-lightbox-resizable:visible").length||n.addClass("fl-builder-content-panel-pin-zone"),l.addClass("fl-builder-draggable-is-dragging"),l.append('<div class="fl-builder-ui-pin-zone fl-builder-ui-pin-zone-left"></div>'),l.append('<div class="fl-builder-ui-pin-zone fl-builder-ui-pin-zone-right"></div>'),FLBuilder._destroyOverlayEvents()},drag:function(i,t){var l=e("body"),n=e(".fl-responsive-preview"),s=e(window),o=n.length?n.width():s.width(),r=s.scrollTop(),a=e(".fl-builder--content-library-panel"),d=a.offset().top,u=e(".fl-builder-bar-actions"),c=e(i.target);c.hasClass("fl-builder--content-library-panel")&&(i.clientX<o-75&&d-r<46?u.addClass("fl-builder-content-panel-pin-zone-hover"):u.removeClass("fl-builder-content-panel-pin-zone-hover")),c.hasClass("fl-builder-ui-pinned")?this.unpinPanel():i.clientX<75?l.addClass("fl-builder-ui-show-pin-zone fl-builder-ui-show-pin-zone-left"):i.clientX>o-75?l.addClass("fl-builder-ui-show-pin-zone fl-builder-ui-show-pin-zone-right"):(l.removeClass("fl-builder-ui-show-pin-zone"),l.removeClass("fl-builder-ui-show-pin-zone-left"),l.removeClass("fl-builder-ui-show-pin-zone-right"))},dragStop:function(i,t){var l=(e(window),e("body")),n=e(".fl-builder-bar-actions"),s=e(".fl-builder-ui-pin-zone"),o=e(".fl-builder--content-library-panel"),r=e(".fl-lightbox-resizable:visible");e(i.target);l.removeClass("fl-builder-draggable-is-dragging"),n.removeClass("fl-builder-content-panel-pin-zone"),n.removeClass("fl-builder-content-panel-pin-zone-hover"),s.remove(),r.length&&parseInt(r.css("top"))<0&&r.css("top","0"),l.hasClass("fl-builder-ui-show-pin-zone")?(l.hasClass("fl-builder-ui-show-pin-zone-left")?this.pin("left",!0):this.pin("right",!0),l.removeClass("fl-builder-ui-show-pin-zone"),l.removeClass("fl-builder-ui-show-pin-zone-left"),l.removeClass("fl-builder-ui-show-pin-zone-right")):o.find(".fl-lightbox").length?(this.unpin(!0),("module"===FLBuilderConfig.userTemplateType||FLBuilderConfig.simpleUi)&&o.hide()):(o.attr("style",""),this.savePosition()),FLBuilder._bindOverlayEvents()},disableDragAndResize:function(){var i=e(".fl-builder--content-library-panel"),t=e(".fl-lightbox-resizable");i.draggable("disable"),i.resizable("disable"),t.draggable("disable"),t.resizable("disable")},enableDragAndResize:function(){var i=e(".fl-builder--content-library-panel"),t=e(".fl-lightbox-resizable:not(.fl-lightbox-width-full)");i.draggable("enable"),i.resizable("enable"),this.isPinned()||(t.draggable("enable"),t.resizable("enable"))},savePosition:function(){var i=e(".fl-builder--content-library-panel"),t=e(".fl-lightbox-resizable:visible"),l={pinned:{width:i.outerWidth(),position:null}};i.hasClass("fl-builder-ui-pinned-left")?l.pinned.position="left":i.hasClass("fl-builder-ui-pinned-right")?l.pinned.position="right":t.length&&(l.lightbox={width:t.width(),height:t.height(),top:parseInt(t.css("top"))<0?"0px":t.css("top"),left:t.css("left")}),FLBuilderConfig.userSettings.pinned=l.pinned,l.lightbox&&(FLBuilderConfig.userSettings.lightbox=l.lightbox),FLBuilder.ajax({action:"save_pinned_ui_position",data:l})},restorePosition:function(){var i=e(".fl-builder--content-library-panel"),t=FLBuilderConfig.userSettings.pinned;t&&t.position&&(i.css("width",t.width+"px"),this.pin(t.position,!1),i.css("width",t.width+"px"))}};e(function(){i.init()})}(jQuery),function(e){var i={init:function(){this.setupMainMenuData(),e(".fl-builder--revision-actions select").on("change",this.selectChanged),e(".fl-cancel-revision-preview").on("click",this.exitPreview.bind(this)),e(".fl-apply-revision-preview").on("click",this.applyClicked.bind(this)),FLBuilder.addHook("revisionItemClicked",this.itemClicked.bind(this)),FLBuilder.addHook("didPublishLayout",this.refreshItems.bind(this))},setupMainMenuData:function(){var i=FLBuilderConfig.revisions.posts,t=FLBuilderConfig.revisions.authors,l=wp.template("fl-revision-list-item"),n=e(".fl-builder--revision-actions select"),s="",o="",r=0;if(FLBuilderConfig.mainMenu.revisions.items=[],n.html(""),0===i.length)FLBuilderConfig.mainMenu.revisions.items.push({eventName:"noRevisionsMessage",type:"event",label:wp.template("fl-no-revisions-message")()});else for(;r<i.length;r++)s=FLBuilderStrings.revisionDate.replace("%s",i[r].date.diff),s+=" ("+i[r].date.published+")",o=FLBuilderStrings.revisionAuthor.replace("%s",t[i[r].author].name),FLBuilderConfig.mainMenu.revisions.items.push({eventName:"revisionItemClicked",type:"event",label:l({id:i[r].id,date:s,author:o,avatar:t[i[r].author].avatar})}),n.append('<option value="'+i[r].id+'">'+s+"</option>");FLBuilder.triggerHook("renderRevisionsPanel")},refreshItems:function(){FLBuilder.ajax({action:"refresh_revision_items"},this.refreshItemsComplete.bind(this))},refreshItemsComplete:function(e){FLBuilderConfig.revisions=FLBuilder._jsonParse(e),this.setupMainMenuData()},itemClicked:function(i,t){var l=e(t).find(".fl-revision-list-item").attr("data-revision-id");FLBuilder._triggerSettingsSave(!1,!0)&&(e(".fl-builder--revision-actions select").val(l),this.preview(l))},selectChanged:function(t){i.preview(e(this).val())},applyClicked:function(t){var l=e(".fl-builder--revision-actions select").val();i.restore(l)},preview:function(i){e(".fl-builder--revision-actions").css("display","flex"),FLBuilder.triggerHook("didEnterRevisionPreview"),FLBuilder.showAjaxLoader(),FLBuilder.ajax({action:"render_revision_preview",revision_id:i},this.previewRenderComplete.bind(this))},previewRenderComplete:function(e){FLBuilder._renderLayout(e,function(){FLBuilder._destroyOverlayEvents(),FLBuilder._removeAllOverlays()})},exitPreview:function(){e(".fl-builder--revision-actions").hide(),FLBuilder.triggerHook("didExitRevisionPreview"),FLBuilder._bindOverlayEvents(),FLBuilder._updateLayout()},restore:function(t){e(".fl-builder--revision-actions").hide(),FLBuilder.triggerHook("didExitRevisionPreview"),FLBuilder.showAjaxLoader(),FLBuilder._bindOverlayEvents(),FLBuilder.ajax({action:"restore_revision",revision_id:t},i.restoreComplete)},restoreComplete:function(e){var i=FLBuilder._jsonParse(e);FLBuilder._renderLayout(i.layout),FLBuilder.triggerHook("didRestoreRevisionComplete",i.config),settings=i.settings,"undefined"!=typeof settings.css&&null!==settings.css&&(FLBuilderSettingsConfig.settings.layout.css=settings.css),"undefined"!=typeof settings.js&&null!==settings.js&&(FLBuilderSettingsConfig.settings.layout.js=settings.js)}};e(function(){i.init()})}(jQuery),function(e){var i={query:function(e){var i={},t=null,l={library:{}},n=null;if(e=this.normalizeQuery(e),_.isNull(e.kind))i=FLBuilderConfig.contentItems;else for(var s in e.kind)t=e.kind[s],i[t]=FLBuilderConfig.contentItems[t];return n=this.findMatches(e,i),l.library=this.formatResults(n,e),l},normalizeQuery:function(e){var i={kind:null,type:null,category:null,group:null,enabled:!0,global:null,searchTerm:null,categorized:!1};return e=_.extend(i,e),_.isString(e.kind)&&(e.kind=[e.kind]),e},findMatches:function(e,i){var t={},l=null,n=null,s=null,o=null,r=null,a=null;for(l in i){n=i[l],t[l]={items:[]};for(a in n)if(s=n[a],_.isUndefined(e.category)||_.isNull(e.category)||this.matchesCategory(s.category,e.category)){switch(l){case"template":if(!(_.isUndefined(e.content)||_.isNull(e.content)||(o=_.includes(e.content,s.content),r=e.content===s.content,o||r)))continue;if(!_.isUndefined(e.type)&&!_.isNull(e.type)&&e.type!==s.type)continue;if(!_.isNull(e.group)){var d=e.group,u=s.group;if(_.isString(d)&&(d=[d]),_.isString(u)&&(u=[u]),_.isEmpty(d)||_.isEmpty(u))continue;var c=!1;for(a in d){var f=d[a];_.includes(u,f)&&(c=!0)}if(!c)continue}break;case"module":if(!_.isNull(e.group)){if(e.group===!1&&s.group.length>0)continue;if(e.group!==!1&&!_.includes(s.group,e.group))continue}}(_.isUndefined(e.searchTerm)||_.isNull(e.searchTerm)||this.matchesSearchTerm(s,e.searchTerm))&&t[l].items.push(s)}}return t},matchesCategory:function(e,i){var t,l,n,s,o,r;if(e===i)return!0;_.isString(i)&&(i=[i]);for(l in i){if(t=i[l],_.isString(e)&&e===t)return!0;if(_.isArray(e))for(n in e)if(s=e[n],s===t)return!0;if(_.isObject(e))for(o in e)if(r=e[o],r===t||o===t)return!0}return!1},matchesSearchTerm:function(e,i){var t,l,n=i.toLowerCase();return!(_.isUndefined(e.slug)||!e.slug.toLowerCase().includes(n))||(!(_.isUndefined(e.name)||!e.name.toLowerCase().includes(n))||(!(!_.isString(e.category)||!e.category.toLowerCase().includes(n))||(!(_.isUndefined(e.description)||!e.description.toLowerCase().includes(n))||(!(_.isUndefined(e.id_base)||!e.id_base.includes(i))||(!(!e.isWidget||(t="widget",!t.includes(n)))||!(_.isUndefined(e.editor_export)||(l="module",!l.includes(n))))))))},formatResults:function(e,i){if(i.categorized)for(type in e){var t=e[type].items;e[type].categorized=this.groupBy(t,"category")}return e},groupBy:function(e,i){var t,l,n={};return _.forEach(e,function(e,s,o){t=e[i],_.isNull(t)||_.isUndefined(t)||_.isString(t)&&""===e[t]||(_.isString(t)&&(n[t]=n[t]||[],n[t].push(e)),_.isArray(t)&&(l=t,_.forEach(l,function(i,t,l){n[i]=n[i]||[],n[i].push(e)})),_.isObject(t)&&(l=t,_.forEach(l,function(i,t,l){n[i]=n[i]||[],n[i].push(e)})))}),n},search:function(e){var i={searchTerm:e},t=this.query(i),l={total:0,term:e,sections:{}};if(!_.isUndefined(t.library.module.items)){var n={};for(var s in t.library.module.items){var o=t.library.module.items[s],r=o.group[0],a=o.category;o.name;_.isUndefined(n[r])&&(n[r]={}),_.isUndefined(n[r][a])&&(n[r][a]=[]),n[r][a].push(o)}l.grouped=n}for(var s in t.library){var d=t.library[s];!_.isUndefined(d.items)&&d.items.length>0&&(l.sections[s]={name:FLBuilderStrings.typeLabels[s],handle:s,type:"",items:d.items},l.total+=d.items.length)}return l}};FLBuilder.Search={byQuery:function(e){return i.query(e)},byTerm:function(e){var t=i.search(e);return t}}}(jQuery),function(e,i){var t={layoutNeedsPublish:!1,defaultIndicatorMessage:"",defaultTooltipMessage:"",messages:null,init:function(){this.messages=FLBuilderStrings.savedStatus,this.$savingIndicator=e(".fl-builder--saving-indicator"),i.addHook("didBeginAJAX",this.onLayoutSaving.bind(this)),i.addHook("didCompleteAJAX",this.onLayoutSaved.bind(this)),i.addHook("didPublishLayout",this.onLayoutPublished.bind(this)),i.addHook("publishAndRemain",this.onPublishAndRemain.bind(this)),i.addHook("didShowLightbox",this.setLayoutNeedsPublish.bind(this)),!FLBuilderConfig.layoutHasDraftedChanges&&FLBuilderConfig.builderEnabledd||(this.setLayoutNeedsPublish(),this.resetStatusMessage())},setLayoutNeedsPublish:function(){this.layoutNeedsPublish||(this.layoutNeedsPublish=!0,e("body").addClass("fl-builder--layout-has-drafted-changes"))},onLayoutSaving:function(e,i){this.isPublishingLayout(i.action)?this.showStatusMessage(this.messages.publishing,this.messages.publishingTooltip):this.isUpdatingLayout(i.action)&&(this.setLayoutNeedsPublish(),this.showStatusMessage(this.messages.saving,this.messages.savingTooltip))},isPublishingLayout:function(e){return"save_layout"==e},isUpdatingLayout:function(e){return!this.isPublishingLayout()&&(e.startsWith("render")?!!e.startsWith("render_new"):!e.startsWith("duplicate")&&(!e.startsWith("refresh")&&("save_ui_skin"!=e&&("save_lightbox_position"!=e&&("save_pinned_ui_position"!=e&&"fl_builder_notifications"!=e)))))},onLayoutSaved:function(e,i){if(this.isUpdatingLayout(i.fl_builder_data.action)){this.showStatusMessage(this.messages.saved,this.messages.savedTooltip);var t=this;setTimeout(function(){t.resetStatusMessage()},2e3)}},onLayoutPublished:function(){this.layoutNeedsPublish=!1,e("body").removeClass("fl-builder--layout-has-drafted-changes"),this.resetStatusMessage()},showStatusMessage:function(t,l){this.$savingIndicator.html(t),i.isUndefined(l)||(this.$savingIndicator.attr("title",l),e(".fl-builder--saving-indicator").tipTip({defaultPosition:"bottom",edgeOffset:14}))},resetStatusMessage:function(){this.layoutNeedsPublish?(this.defaultIndicatorMessage=this.messages.edited+'<i class="fas fa-question-circle"></i>',this.defaultTooltipMessage=this.messages.editedTooltip):(this.defaultIndicatorMessage="",this.defaultTooltipMessage=""),this.showStatusMessage(this.defaultIndicatorMessage,this.defaultTooltipMessage)},onPublishAndRemain:function(){if(i.MainMenu.hide(),this.layoutNeedsPublish)i._publishLayout(!1);else{this.showStatusMessage(this.messages.noChanges);var e=this;setTimeout(function(){e.resetStatusMessage()},2e3)}}};i.SaveManager={layoutNeedsPublish:function(){return t.layoutNeedsPublish},showStatusMessage:function(e,i){t.showStatusMessage(e,i)},resetStatusMessage:function(){t.resetStatusMessage()}},e(function(){t.init()})}(jQuery,FLBuilder),function(exports){"use strict";exports.stringify=function(e){return JSON.stringify(e,function(e,i){var t;return i instanceof Function||"function"==typeof i?(t=i.toString(),t.length<8||"function"!==t.substring(0,8)?"_NuFrRa_"+t:t):i instanceof RegExp?"_PxEgEr_"+i:i})},exports.parse=function(str,date2obj){var iso8061=!!date2obj&&/^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2}(?:\.\d*)?)Z$/;return JSON.parse(str,function(key,value){var prefix;return"string"!=typeof value?value:value.length<8?value:(prefix=value.substring(0,8),iso8061&&value.match(iso8061)?new Date(value):"function"===prefix?eval("("+value+")"):"_PxEgEr_"===prefix?eval(value.slice(8)):"_NuFrRa_"===prefix?eval(value.slice(8)):value)})},exports.clone=function(e,i){return exports.parse(exports.stringify(e),i)}}("undefined"==typeof exports?window.JSONfn={}:exports);