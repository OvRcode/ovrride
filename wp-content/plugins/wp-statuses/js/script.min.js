window.wp=window.wp||{},function(r){if("undefined"!=typeof wpStatuses){if("undefined"!=typeof postL10n&&void 0===wp.deprecateL10nObject)wpStatuses.L10n=postL10n;else{if(void 0===wp.i18n.__)return;wpStatuses.L10n={publishOnFuture:wp.i18n.__("Schedule for:"),schedule:wp.i18n._x("Schedule","post action/button label"),publishOn:wp.i18n.__("Publish on:"),publish:wp.i18n.__("Publish"),publishOnPast:wp.i18n.__("Published on:"),update:wp.i18n.__("Update"),dateFormat:wp.i18n.__("%1$s %2$s, %3$s at %4$s:%5$s"),savePending:wp.i18n.__("Save as Pending"),saveDraft:wp.i18n.__("Save Draft")}}var t={init:function(){this.publishingBox=r("#wp-statuses-publish-box"),this.timeStampDiv=r("#timestampdiv"),this.majorSubmitName=r("#publish").prop("name"),this.setListeners()},setListeners:function(){this.publishingBox.on("change","#wp-statuses-dropdown",this.updateStatus.bind(this)),this.publishingBox.on("click",".edit-timestamp, .cancel-timestamp, .save-timestamp",this.editTimestamp.bind(this)),r("#post").on("submit",this.submitForm.bind(this))},updateStatus:function(t){var s=r(t.currentTarget).find(":selected").data("dashicon"),e=r(t.currentTarget).parent().find(".dashicons"),t=r(t.currentTarget).find(":selected").data("status"),s=s||"dashicons-post-status";e.prop("class","").addClass("dashicons"),e.addClass(s),this.setStatusAttributes(t),"password"===t&&(t="publish",r("#wp-statuses-dropdown :selected").prop("value",t)),r("#wp-statuses-status").val(t),this.updateText()},setStatusAttributes:function(t){r.each(r("#wp-statuses-attibutes input"),function(t,s){"checkbox"===s.type||"radio"===s.type?r(s).prop("checked",!1):"text"===s.type&&r(s).val(""),r(s).parent(".wp-statuses-attribute-container").addClass("hide-if-js")}),"password"===t||t===wpStatuses.status&&wpStatuses.attributes.password?(r("#password-span").removeClass("hide-if-js"),wpStatuses.attributes.password&&r("#post_password").val(wpStatuses.attributes.password)):-1!==r.inArray(t,wpStatuses.public_statuses)&&(r("#sticky-span").removeClass("hide-if-js"),wpStatuses.attributes.sticky&&r("#sticky").prop("checked",wpStatuses.attributes.sticky))},updateText:function(){var t,s,e,a,i={aa:parseInt(r("#aa").val(),10),mm:parseInt(r("#mm").val(),10)-1,jj:parseInt(r("#jj").val(),10),hh:parseInt(r("#hh").val(),10),mn:parseInt(r("#mn").val(),10)},p=r("#wp-statuses-dropdown").val(),n=r("#wp-statuses-dropdown :selected").data("status"),u=r("#original_post_status").val();return!this.timeStampDiv.length||(t=new Date(i.aa,i.mm,i.jj,i.hh,i.mn),a=new Date(r("#cur_aa").val(),r("#cur_mm").val()-1,r("#cur_jj").val(),r("#cur_hh").val(),r("#cur_mn").val()),s=new Date(r("#hidden_aa").val(),r("#hidden_mm").val()-1,r("#hidden_jj").val(),r("#hidden_hh").val(),r("#hidden_mn").val()),t.getFullYear()!==i.aa||t.getMonth()!==i.mm||t.getDate()!==i.jj||t.getMinutes()!==i.mn?(this.timeStampDiv.find(".timestamp-wrap").addClass("form-invalid"),!1):(this.timeStampDiv.find(".timestamp-wrap").removeClass("form-invalid"),r("#publish").prop("name",this.majorSubmitName),0<(a=t-a)&&-1!==r.inArray(p,["draft","pending","publish"])?(e=wpStatuses.L10n.publishOnFuture,r("#publish").val(wpStatuses.L10n.schedule),r("#publish").prop("name","publish"),"password"===n&&r("#wp-statuses-dropdown :selected").prop("value","future")):a<=0&&-1!==r.inArray(p,["draft","pending","publish","future"])&&("publish"!==u||"publish"===u&&-1!==r.inArray(p,["draft","pending"]))?(e=wpStatuses.L10n.publishOn,r("#publish").val(wpStatuses.L10n.publish),r("#publish").prop("name","publish"),"password"===n&&r("#wp-statuses-dropdown :selected").prop("value","publish")):(e=wpStatuses.L10n.publishOnPast,r("#publish").val(wpStatuses.L10n.update),-1===r.inArray(p,["draft","pending","publish","future"])&&(r("#publish").prop("name","save"),e=wpStatuses.strings.labels[n].metabox_save_on,r("#publish").val(wpStatuses.strings.labels[n].metabox_submit))),s.toUTCString()===t.toUTCString()&&(e=wpStatuses.strings.labels[n].metabox_save_on,(a<=0||u===p)&&(e=wpStatuses.strings.labels[n].metabox_saved_on),-1!==r.inArray(u,["draft","auto-draft"])&&(r("#timestamp").html("\n"+wpStatuses.strings.labels[n].metabox_save_now),e=!1)),e&&(a=i.mm+1,n=i.jj,1===a.toString().length&&(a="0"+a),1===n.toString().length&&(n="0"+n),r("#timestamp").html("\n"+e+" <b>"+wpStatuses.L10n.dateFormat.replace("%1$s",r('option[value="'+a+'"]',"#mm").data("text")).replace("%2$s",n).replace("%3$s",i.aa).replace("%4$s",("00"+i.hh.toString()).slice(-2)).replace("%5$s",("00"+i.mn.toString()).slice(-2))+"</b> ")),"pending"===p||"draft"===p?(p="pending"===p?wpStatuses.L10n.savePending:wpStatuses.L10n.saveDraft,r("#save-post").length?r("#save-post").show().val(p):r("#save-action").prepend(r("<input></input>").val(p).prop({type:"submit",name:"save",id:"save-post"}).addClass("button")),r("#post-preview").html(wpStatuses.strings.preview)):(r("#save-post").hide(),"publish"===u&&r("#post-preview").html(wpStatuses.strings.previewChanges)),!0))},editTimestamp:function(t){var s=r(t.currentTarget),e=this.timeStampDiv;t.preventDefault(),e.hasClass("hide-if-js")?(e.slideDown("fast",function(){r("input, select",e.find(".timestamp-wrap")).first().focus()}).removeClass("hide-if-js"),s.hide()):(s.hasClass("cancel-timestamp")&&r.each(e.find('[type="hidden"]'),function(t,s){var e=r(s).prop("id").replace("hidden_","#");0===e.indexOf("#")&&r(e).val(r(s).val())}),!0!==this.updateText()&&s.hasClass("save-timestamp")||(e.slideUp("fast").siblings("a.edit-timestamp").show().focus(),e.addClass("hide-if-js")))},submitForm:function(t){if(!0===this.updateText())return t;t.preventDefault(),this.timeStampDiv.show(),wp.autosave&&wp.autosave.enableButtons(),r("#publishing-action .spinner").removeClass("is-active")}};r(document).ready(function(){t.init()})}}(jQuery);