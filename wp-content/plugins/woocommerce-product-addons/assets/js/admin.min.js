jQuery(function(s){"use strict";var e={getAddonOptions:function(){var a={security:wc_pao_params.nonce.get_addon_options,action:"wc_pao_get_addon_options"};return s.ajax({type:"POST",data:a,url:wc_pao_params.ajax_url})},getAddonField:function(){var a={security:wc_pao_params.nonce.get_addon_field,action:"wc_pao_get_addon_field"};return s.ajax({type:"POST",data:a,url:wc_pao_params.ajax_url})},refresh:function(){0<s(".wc-pao-addon").length?(s(".wc-pao-toolbar").addClass("wc-pao-has-addons"),s(".wc-pao-addons").addClass("wc-pao-has-addons")):(s(".wc-pao-toolbar").removeClass("wc-pao-has-addons"),s(".wc-pao-addons").removeClass("wc-pao-has-addons")),s(document.body).trigger("init_tooltips")},expandAllFields:function(){s("#product_addons_data .wc-pao-addon").removeClass("closed").addClass("open")},closeAllFields:function(){s("#product_addons_data .wc-pao-addon").removeClass("open").addClass("closed")},addonRowIndexes:function(){s(".wc-pao-addons .wc-pao-addon").each(function(a,o){s(".wc-pao-addon-position",o).val(parseInt(s(o).index(".wc-pao-addons .wc-pao-addon")))})},runFieldSortable:function(){s(".wc-pao-addons").sortable({items:".wc-pao-addon",cursor:"move",axis:"y",handle:".wc-pao-addon-header",scrollSensitivity:40,helper:function(a,o){return o},start:function(a,o){o.item.css("border-style","dashed").css("border-color","orange")},stop:function(a,o){o.item.removeAttr("style"),e.addonRowIndexes()}})},runOptionSortable:function(){s(".wc-pao-addon-content-options-container").sortable({items:".wc-pao-addon-option-row",cursor:"move",axis:"y",handle:".wc-pao-addon-sort-handle",scrollSensitivity:40,helper:function(a,o){return o},start:function(a,o){o.item.css("border-style","dashed").css("border-width","1px").css("border-color","orange")},stop:function(a,o){o.item.removeAttr("style"),e.addonRowIndexes()}})},validateSettings:function(a){s(".wc-pao-error-message").remove(),s(".updated").remove();var d=!0,e=!0;if(s(".wc-pao-addons").find(".wc-pao-addon").each(function(a){0===s(this).find(".wc-pao-addon-content-name").val().length?(s(this).addClass("wc-pao-error").find(".wc-pao-addon-content-name").addClass("wc-pao-error"),e=d=!1):s(this).find(".wc-pao-addon-content-name").removeClass("wc-pao-error");var o=s(this).find(".wc-pao-addon-type-select").val();s(this).find(".wc-pao-addon-option-row").each(function(){"multiple_choice"!==o&&"checkbox"!==o||0!==s(this).find(".wc-pao-addon-content-label input").val().length?s(this).find(".wc-pao-addon-content-label input").removeClass("wc-pao-error"):(s(this).find(".wc-pao-addon-content-label input").addClass("wc-pao-error"),s(this).parents(".wc-pao-addon").eq(0).addClass("wc-pao-error"),e=d=!1)}),e&&s(this).removeClass("wc-pao-error")}),!1===d){var o=s('<div class="notice notice-error wc-pao-error-message"><p>'+wc_pao_params.i18n.required_fields+"</p></div>");"product"===a?s(".wc-pao-addons").before(o):"global"===a&&s(".global-addons-form").before(o),s("html, body").animate({scrollTop:s(".wc-pao-error-message").offset().top-200},600)}return d},init:function(){s(".post-type-product").on("click",'#publishing-action input[name="save"]',function(){return e.validateSettings("product")}),s(".product_page_addons").on("click",'input[type="submit"]',function(){return e.validateSettings("global")}),s("#product_addons_data").on("change",".wc-pao-addon-content-name",function(){s(this).val()?s(this).closest(".wc-pao-addon").find(".wc-pao-addon-name").text(s(this).val()):s(this).closest(".wc-pao-addon").find(".wc-pao-addon-name").text("")}).on("keyup",".wc-pao-addon-content-name, .wc-pao-addon-content-label input",function(){s(this).removeClass("wc-pao-error"),s(".wc-pao-error-message").remove()}).on("change","select.wc-pao-addon-type-select",function(){var a,o=s(this).val(),d=s(this).parents(".wc-pao-addon"),e=s(this).context.selectedOptions[0].innerHTML;switch(d.find(".wc-pao-addon-header .wc-pao-addon-type").html(e),d.find(".wc-pao-addon-main-settings-2 .wc-pao-col1").removeClass("full"),d.find(".wc-pao-addon-main-settings-2 .wc-pao-col2").removeClass("hide").addClass("show"),d.find(".wc-pao-addon-content-image").removeClass("show").addClass("hide"),d.find(".wc-pao-addon-content-label").addClass("full"),d.find(".wc-pao-addon-restrictions-select").removeClass("show").addClass("hide"),d.find(".wc-pao-addon-main-settings-1 .wc-pao-col2-1").removeClass("show").addClass("hide"),d.find(".wc-pao-addon-main-settings-1 .wc-pao-col2-2").removeClass("show").addClass("hide"),d.find(".wc-pao-addon-main-settings-1 .wc-pao-col1").addClass("full"),d.find(".wc-pao-addon-content-option-rows").removeClass("show").addClass("hide"),d.find(".wc-pao-addon-content-non-option-rows").removeClass("hide").addClass("show"),d.find(".wc-pao-addon-required-setting").removeClass("hide").addClass("show"),o){case"multiple_choice":d.find(".wc-pao-addon-main-settings-1 .wc-pao-col2-1").removeClass("hide").addClass("show"),d.find(".wc-pao-addon-main-settings-1 .wc-pao-col1").removeClass("full"),d.find(".wc-pao-addon-content-option-rows").removeClass("hide").addClass("show"),d.find(".wc-pao-addon-content-non-option-rows").removeClass("show").addClass("hide"),"images"===d.find(".wc-pao-addon-display-select").val()&&(d.find(".wc-pao-addon-content-image").removeClass("hide").addClass("show"),d.find(".wc-pao-addon-content-label").removeClass("full"));break;case"checkbox":d.find(".wc-pao-addon-main-settings-1 .wc-pao-col2-1").removeClass("show").addClass("hide"),d.find(".wc-pao-addon-main-settings-1 .wc-pao-col1").addClass("full"),d.find(".wc-pao-addon-content-option-rows").removeClass("hide").addClass("show"),d.find(".wc-pao-addon-content-non-option-rows").removeClass("show").addClass("hide"),d.find(".wc-pao-addon-content-image").removeClass("show").addClass("hide"),d.find(".wc-pao-addon-content-label").addClass("full"),d.find(".wc-pao-addon-adjust-price-container").removeClass("show").addClass("hide"),d.find(".wc-pao-addon-restrictions-container").removeClass("show").addClass("hide");break;case"custom_price":a=wc_pao_params.i18n.limit_price_range,d.find(".wc-pao-addon-adjust-price-container").removeClass("show").addClass("hide"),d.find(".wc-pao-addon-min-max").removeClass("hide").addClass("show"),d.find(".wc-pao-addon-main-settings-1 .wc-pao-col2-1").removeClass("show").addClass("hide"),d.find(".wc-pao-addon-main-settings-1 .wc-pao-col1").addClass("full"),d.find(".wc-pao-addon-content-option-rows").removeClass("show").addClass("hide"),d.find(".wc-pao-addon-content-non-option-rows").removeClass("hide").addClass("show"),d.find(".wc-pao-addon-restrictions-select").removeClass("show").addClass("hide"),d.find(".wc-pao-addon-adjust-price-container").removeClass("show").addClass("hide"),d.find(".wc-pao-addon-restrictions-container").removeClass("hide").addClass("show");break;case"input_multiplier":d.find(".wc-pao-addon-adjust-price-container").removeClass("hide").addClass("show"),d.find(".wc-pao-addon-restrictions-container").removeClass("hide").addClass("show"),a=wc_pao_params.i18n.limit_quantity_range;break;case"custom_text":a=wc_pao_params.i18n.limit_character_length,d.find(".wc-pao-addon-main-settings-1 .wc-pao-col2-2").removeClass("hide").addClass("show"),d.find(".wc-pao-addon-restrictions-select").removeClass("hide").addClass("show"),d.find(".wc-pao-addon-content-option-rows").removeClass("show").addClass("hide"),d.find(".wc-pao-addon-content-non-option-rows").removeClass("hide").addClass("show"),d.find(".wc-pao-addon-adjust-price-container").removeClass("hide").addClass("show"),d.find(".wc-pao-addon-restrictions-container").removeClass("hide").addClass("show"),d.find(".wc-pao-addon-min-max").removeClass("hide").addClass("show"),"email"===d.find(".wc-pao-addon-restrictions-select").val()&&d.find(".wc-pao-addon-min-max").removeClass("show").addClass("hide");break;case"custom_textarea":a=wc_pao_params.i18n.limit_character_length,d.find(".wc-pao-addon-min-max").removeClass("hide").addClass("show"),d.find(".wc-pao-addon-adjust-price-container").removeClass("hide").addClass("show"),d.find(".wc-pao-addon-restrictions-container").removeClass("hide").addClass("show");break;case"file_upload":d.find(".wc-pao-addon-adjust-price-container").removeClass("hide").addClass("show"),d.find(".wc-pao-addon-restrictions-container").removeClass("show").addClass("hide");break;case"heading":d.find(".wc-pao-addon-required-setting").removeClass("show").addClass("hide"),d.find(".wc-pao-addon-adjust-price-container").removeClass("show").addClass("hide"),d.find(".wc-pao-addon-restrictions-container").removeClass("show").addClass("hide"),d.find(".wc-pao-addon-main-settings-2 .wc-pao-col1").addClass("full"),d.find(".wc-pao-addon-main-settings-2 .wc-pao-col2").removeClass("show").addClass("hide");break;default:d.find(".wc-pao-addon-main-settings-1 .wc-pao-col2-1").removeClass("show").addClass("hide"),d.find(".wc-pao-addon-main-settings-1 .wc-pao-col2-2").removeClass("show").addClass("hide"),d.find(".wc-pao-addon-main-settings-1 .wc-pao-col1").addClass("full"),d.find(".wc-pao-addon-content-option-rows").removeClass("show").addClass("hide"),d.find(".wc-pao-addon-content-non-option-rows").removeClass("hide").addClass("show"),a=wc_pao_params.i18n.restrictions,d.find(".wc-pao-addon-restrictions-container").removeClass("show").addClass("hide")}d.find(".wc-pao-addon-restriction-name").html(a);var n=s(this).closest(".wc-pao-addon").find(".wc-pao-remove-option");n.length<2?n.attr("disabled","disabled"):n.removeAttr("disabled")}).on("change",".wc-pao-addon-display-select",function(){var a=s(this).val(),o=s(this).parents(".wc-pao-addon");"images"===a?(o.find(".wc-pao-addon-content-image").removeClass("hide").addClass("show"),o.find(".wc-pao-addon-content-label").removeClass("full")):(o.find(".wc-pao-addon-content-image").removeClass("show").addClass("hide"),o.find(".wc-pao-addon-content-label").addClass("full"))}).on("click","button.wc-pao-add-option",function(){var o=s(this).closest(".wc-pao-addon").index(".wc-pao-addon"),d=s(this).parents(".wc-pao-addon-content-option-rows").find(".wc-pao-addon-content-options-container");return s.when(e.getAddonOptions()).then(function(a){a=(a=a.html).replace(/{loop}/g,o),"images"===s(this).parents(".wc-pao-addon").find(".wc-pao-addon-display-select").val()&&(a=(a=a.replace(/wc-pao-addon-content-image hide/g,"wc-pao-addon-content-image show")).replace(/wc-pao-addon-content-label full/g,"wc-pao-addon-content-label")),s(a).appendTo(d),s("select.wc-pao-addon-type-select").change()}),!1}).on("click",".wc-pao-add-field",function(){var o=s(".wc-pao-addons .wc-pao-addon").length;return s.when(e.getAddonField()).then(function(a){a=(a=(a=a.html).replace(/{loop}/g,o)).replace(/closed/g,"open"),s(".wc-pao-addons").append(a),s("select.wc-pao-addon-type-select").change(),e.refresh(),e.runOptionSortable()}),!1}).on("click",".wc-pao-remove-addon",function(){if(s(".wc-pao-error-message").remove(),confirm(wc_pao_params.i18n.confirm_remove_addon)){var a=s(this).closest(".wc-pao-addon");s(a).find("input").val(""),s(a).remove()}return s(".wc-pao-addons .wc-pao-addon").each(function(a,o){var d=a;s(this).find(".product_addon_position").val(d),s(this).find("select, input, textarea").prop("name",function(a,o){return o.replace(/\[[0-9]+\]/g,"["+d+"]")})}),e.refresh(),!1}).on("click",".wc-pao-remove-option",function(){if(confirm(wc_pao_params.i18n.confirm_remove_option)){var a=s(this).parents(".wc-pao-addon-content").find("select.wc-pao-addon-type-select");s(this).parents(".wc-pao-addon-option-row").remove(),a.change()}return!1}).on("click",".wc-pao-expand-all",function(a){a.preventDefault(),e.expandAllFields()}).on("click",".wc-pao-close-all",function(a){a.preventDefault(),e.closeAllFields()}).on("click",".wc-pao-addon-header",function(a){a.preventDefault();var o=s(this).parents(".wc-pao-addon");o.hasClass("open")?o.removeClass("open").addClass("closed"):o.removeClass("closed").addClass("open")}).on("click",".wc-pao-addon-description-enable",function(){s(this).is(":checked")?s(this).parents(".wc-pao-addons-secondary-settings").find(".wc-pao-addon-description").removeClass("hide").addClass("show"):s(this).parents(".wc-pao-addons-secondary-settings").find(".wc-pao-addon-description").removeClass("show").addClass("hide")}).on("change",".wc-pao-addon-option-price-type",function(){switch(s(this).val()){case"flat_fee":case"quantity_based":s(this).parents(".wc-pao-addon-content-price-type").removeClass("full").next(".wc-pao-addon-content-price").eq(0).removeClass("hide").addClass("show")}}).on("click",".wc-pao-addon-add-image",function(){var a,d=s(this).parent();(a=wp.media.frames.mediaFrame=wp.media({title:wc_pao_params.i18n.add_image_swatch,button:{text:wc_pao_params.i18n.add_image},library:{type:"image"},multiple:!1})).on("select",function(){a.state().get("selection").map(function(a){if((a=a.toJSON()).id){var o=a.sizes.thumbnail?a.sizes.thumbnail.url:a.url;d.find(".wc-pao-addon-option-image-id").val(a.id),d.find(".wc-pao-addon-image-swatch img").prop("src",o),d.find(".wc-pao-addon-image-swatch").removeClass("hide").addClass("show"),d.find(".wc-pao-addon-add-image").removeClass("show").addClass("hide"),d.find(".dashicons-plus").removeClass("show").addClass("hide")}})}),a.open()}).on("click",".wc-pao-addon-image-swatch",function(a){a.preventDefault();var o=s(this).parent();o.find(".wc-pao-addon-option-image-id").val(""),o.find(".wc-pao-addon-image-swatch img").prop("src",""),o.find(".wc-pao-addon-image-swatch").removeClass("show").addClass("hide"),o.find(".wc-pao-addon-add-image").removeClass("hide").addClass("show"),o.find(".dashicons-plus").removeClass("hide").addClass("show")}).on("click",".wc-pao-addon-restrictions",function(){s(this).is(":checked")?s(this).parents(".wc-pao-addon-restrictions-container").find(".wc-pao-addon-restrictions-settings").removeClass("hide").addClass("show"):s(this).parents(".wc-pao-addon-restrictions-container").find(".wc-pao-addon-restrictions-settings").removeClass("show").addClass("hide")}).on("change",".wc-pao-addon-restrictions-select",function(){var a=s(this).val(),o=s(this).parents(".wc-pao-addon-restrictions-settings");"email"===a?o.find(".wc-pao-addon-min-max").removeClass("show").addClass("hide"):o.find(".wc-pao-addon-min-max").removeClass("hide").addClass("show")}).on("click",".wc-pao-addon-adjust-price",function(){s(this).is(":checked")?s(this).parents(".wc-pao-addon-adjust-price-container").find(".wc-pao-addon-adjust-price-settings").removeClass("hide").addClass("show"):s(this).parents(".wc-pao-addon-adjust-price-container").find(".wc-pao-addon-adjust-price-settings").removeClass("show").addClass("hide")}).find("select.wc-pao-addon-type-select").change(),s("#product_addons_data").on("click",".wc-pao-export-addons",function(){return s("#product_addons_data textarea.wc-pao-import-field").hide(),s("#product_addons_data textarea.wc-pao-export-field").slideToggle("300",function(){s(this).select()}),!1}),s("#product_addons_data").on("click",".wc-pao-import-addons",function(){return s("#product_addons_data textarea.wc-pao-export-field").hide(),s("#product_addons_data textarea.wc-pao-import-field").slideToggle("300",function(){s(this).val("")}),!1}),e.runFieldSortable(),e.runOptionSortable(),1<s(".wc-pao-addons .wc-pao-addon").length&&s(".wc-pao-toolbar").show()}};e.init()});
