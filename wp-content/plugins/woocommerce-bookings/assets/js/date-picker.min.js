jQuery(document).ready(function(a){function b(b){var c=a(this).data("availability"),d=a(this).data("default-availability"),e=a(this).data("fully-booked-days"),f=wc_bookings_booking_form.check_availability_against;if(a("select#wc_bookings_field_resource").val()>0)var g=a("select#wc_bookings_field_resource").val();else var g=0;var h=wc_bookings_booking_form.booking_duration,i=new Date(b),j=i.getFullYear(),k=i.getMonth()+1,l=i.getDate();if(e[j+"-"+k+"-"+l]&&(e[j+"-"+k+"-"+l][0]||e[j+"-"+k+"-"+l][g]))return[!1,"fully_booked",booking_form_params.i18n_date_unavailable];if(""+j+k+l<wc_bookings_booking_form.current_time)return[!1,"not_bookable",""];if(a("#wc_bookings_field_duration").size()>0&&"minute"!=wc_bookings_booking_form.duration_unit&&"hour"!=wc_bookings_booking_form.duration_unit)var m=a("#wc_bookings_field_duration").val(),n=h*m;else var n=h;(1>n||"start"==f)&&(n=1);for(var o=d,p=0;n>p;p++){var i=new Date(b);i.setDate(i.getDate()+p);var j=i.getFullYear(),k=i.getMonth()+1,l=i.getDate(),q=i.getDay(),r=a.datepicker.iso8601Week(i);if(o=d,0==q&&(q=7),a.each(c[g],function(a,b){var c=b[0],d=b[1];try{switch(c){case"months":if("undefined"!=typeof d[k])return o=d[k],!1;break;case"weeks":if("undefined"!=typeof d[r])return o=d[r],!1;break;case"days":if("undefined"!=typeof d[q])return o=d[q],!1;break;case"custom":if("undefined"!=typeof d[j][k][l])return o=d[j][k][l],!1}}catch(e){}return!0}),e[j+"-"+k+"-"+l]&&(e[j+"-"+k+"-"+l][0]||e[j+"-"+k+"-"+l][g])&&(o=!1),!o)break}return o?[o,"bookable",""]:[o,"not_bookable",""]}function c(b){var c=a(this).closest("fieldset"),d=c.find(".picker");"always_visible"!==d.data("display")&&a(this).hide(),b=b.split("-"),c.find("input.booking_date_year").val(b[0]),c.find("input.booking_date_month").val(b[1]),c.find("input.booking_date_day").val(b[2]).change(),a("#wc-bookings-booking-form").trigger("date-selected",b)}function d(d){a(d).empty().removeClass("hasDatepicker").datepicker({dateFormat:a.datepicker.ISO_8601,showWeek:!1,showOn:"both",beforeShowDay:b,onSelect:c,minDate:a(d).data("min_date"),maxDate:a(d).data("max_date"),numberOfMonths:1,showButtonPanel:!1,showOtherMonths:!0,selectOtherMonths:!0,closeText:wc_bookings_booking_form.closeText,currentText:wc_bookings_booking_form.currentText,monthNames:wc_bookings_booking_form.monthNames,monthNamesShort:wc_bookings_booking_form.monthNamesShort,dayNames:wc_bookings_booking_form.dayNames,dayNamesShort:wc_bookings_booking_form.dayNamesShort,dayNamesMin:wc_bookings_booking_form.dayNamesMin,firstDay:wc_bookings_booking_form.firstDay,gotoCurrent:!0}),a(".ui-datepicker-current-day").removeClass("ui-datepicker-current-day")}a(".wc-bookings-date-picker legend small.wc-bookings-date-picker-choose-date").show().click(function(){a(this).closest("fieldset").find(".picker").slideToggle()}),a(".wc-bookings-date-picker").each(function(){var b=a(this).find(".picker"),c=a(this).closest("fieldset");d(b),"always_visible"==b.data("display")?(a(".wc-bookings-date-picker-date-fields",c).hide(),a(".wc-bookings-date-picker-choose-date",c).hide()):a(b).hide()}),a(".booking_date_year, .booking_date_month, .booking_date_day").bind("input",function(){var b=a(this).closest("fieldset"),c=b.find(".picker"),d=parseInt(b.find("input.booking_date_year").val()),e=parseInt(b.find("input.booking_date_month").val()),f=parseInt(b.find("input.booking_date_day").val());if(d&&e&&f){var g=new Date(d,e,f);c.datepicker("setDate",g),a("#wc-bookings-booking-form").trigger("date-selected",g)}}),a("#wc_bookings_field_duration, #wc_bookings_field_resource").change(function(){var b=a(this).closest("form").find(".picker");d(b)})});